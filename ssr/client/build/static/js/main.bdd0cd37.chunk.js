(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{173:function(e){e.exports=JSON.parse('{"\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443":"\u0429\u043e\u0431 \u043f\u0440\u0438\u0454\u0434\u043d\u0430\u0454\u0442\u044c\u0441\u044f \u043d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443","\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f, \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443":"\u0429\u043e\u0431 \u043f\u0440\u0438\u0454\u0434\u043d\u0430\u0454\u0442\u044c\u0441\u044f, \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c i \u043d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443","\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443":"\u0421\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0433\u0440\u0443","\u0413\u043e\u0440\u043e\u0434":"\u041c\u0456\u0441\u0442\u043e","\u0410\u0434\u0440\u0435\u0441":"\u0410\u0434\u0440\u0435\u0441\u0430","\u0430\u0434\u0440\u0435\u0441":"\u0430\u0434\u0440\u0435\u0441\u0430","\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432":"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u0433\u0440\u0430\u0432\u0446\u0456\u0432","\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e":"\u0414\u043e\u0434\u0430\u0442\u043a\u043e\u0432\u043e","\u0421\u043e\u0437\u0434\u0430\u0442\u044c":"C\u0442\u0432\u043e\u0440\u0438\u0442\u0438","\u0417\u0430\u0431\u044b\u043b\u0438":"\u0417\u0430\u0431\u0443\u043b\u0438","\u0412\u043e\u0439\u0442\u0438":"\u0423\u0432\u0456\u0439\u0442\u0438","\u0413\u043b\u0430\u0432\u043d\u0430\u044f":"\u0413\u043e\u043b\u043e\u0432\u043d\u0430","\u041e \u0441\u0435\u0440\u0432\u0438\u0441\u0435":"\u041f\u0440\u043e \u0441\u0435\u0440\u0432\u0456\u0441","\u0412\u0440\u0435\u043c\u044f":"\u0427\u0430\u0441","\u0441":"\u0437","\u0411\u0443\u0434\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u0441\u044f \u0432 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435":"\u0411\u0443\u0434\u0435 \u0432\u0456\u0434\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u0438\u0441\u044f \u0432 \u0456\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0456","\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c":"\u041f\u043e\u0432\u0442\u043e\u0440\u0456\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c","\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442":"\u041f\u0430\u0440\u043e\u043b\u0456 \u043d\u0435 \u0441\u043f\u0456\u0432\u043f\u0430\u0434\u0430\u044e\u0442\u044c","\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c":"\u041d\u0435 \u043c\u043e\u0436\u0435 \u0431\u0443\u0442\u0438 \u043f\u043e\u0440\u043e\u0436\u043d\u0456\u043c","\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b":"\u041d\u0435 \u0432\u0430\u043b\u0456\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b","\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442":"\u0422\u0430\u043a\u0438\u0439 \u043a\u043e\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447 \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u0454","\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0442\u0441\u044f":"\u0417\u0430\u0440\u0435\u0435\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044c","\u0418\u0433\u0440\u043e\u043a\u043e\u0432":"\u0413\u0440\u0430\u0432\u0446\u0456\u0432","\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c, \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u043b\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0447\u0430\u0442":"\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c, \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0449\u043e\u0431 \u043f\u043e\u0441\u043b\u0430\u0442\u0438 \u043f\u043e\u0432\u0456\u0434\u043e\u043c\u043b\u0435\u043d\u043d\u044f \u0432 \u0447\u0430\u0442","\u041f\u043e\u0441\u043b\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435":"\u041f\u043e\u0441\u043b\u0430\u0442\u0438 \u043f\u043e\u0432\u0456\u0434\u043e\u043c\u043b\u0435\u043d\u043d\u044f","\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u044f","\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443":"\u0423\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0449\u043e\u0431 \u0441\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0433\u0440\u0443","\u0415\u0441\u043b\u0438 \u0442\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u0448\u044c, \u0433\u0434\u0435 \u043d\u0430\u0439\u0442\u0438 \u043b\u044e\u0434\u0435\u0439 \u0434\u043b\u044f \u0438\u0433\u0440\u044b \u0432 \u0444\u0443\u0442\u0431\u043e\u043b - \u044d\u0442\u043e \u0441\u0430\u0439\u0442 \u043a\u0430\u043a \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u0435\u0431\u044f! \u0422\u0443\u0442 \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0434\u043b\u044f \u0438\u0433\u0440\u044b \u0432 \u0444\u0443\u0442\u0431\u043e\u043b. \u0422\u0443\u0442 \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443 \u043b\u0438\u0431\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043a \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439.":"\u042f\u043a\u0449\u043e \u0442\u0438 \u043d\u0435 \u0437\u043d\u0430\u0454\u0448, \u0434\u0435 \u0437\u043d\u0430\u0439\u0442\u0438 \u043b\u044e\u0434\u0435\u0439 \u0434\u043b\u044f \u0433\u0440\u0438 \u0432 \u0444\u0443\u0442\u0431\u043e\u043b - \u0446\u0435 \u0441\u0430\u0439\u0442 \u044f\u043a \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u0435\u0431\u0435! \u0422\u0443\u0442 \u0442\u0438 \u043c\u043e\u0436\u0435\u0448 \u0437\u0456\u0431\u0440\u0430\u0442\u0438 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0434\u043b\u044f \u0433\u0440\u0438 \u0432 \u0444\u0443\u0442\u0431\u043e\u043b. \u0422\u0443\u0442 \u0442\u0438 \u043c\u043e\u0436\u0435\u0448 \u0441\u0442\u0432\u043e\u0440\u0438\u0442\u0438 \u0433\u0440\u0443 \u0430\u0431\u043e \u043f\u0440\u0438\u0454\u0434\u043d\u0430\u0454\u0442\u044c\u0441\u044f \u0434\u043e \u0432\u0436\u0435 \u0456\u0441\u043d\u0443\u044e\u0447\u043e\u0457."}')},189:function(e,t,a){e.exports=a(350)},198:function(e,t,a){},231:function(e,t,a){},232:function(e,t,a){},233:function(e,t,a){},234:function(e,t,a){},235:function(e,t,a){},236:function(e,t,a){},238:function(e,t,a){},239:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){},307:function(e,t,a){},308:function(e,t,a){},309:function(e,t,a){},310:function(e,t,a){},311:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){},314:function(e,t,a){},316:function(e,t,a){},317:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){},346:function(e,t){},350:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(18),s=a(402),l=a(10),c=(a(198),a(383)),o=a(7),i=a(8),m=a.n(i),u=a(16);var d=a(102),p=a.n(d),h=a(48),g=a(162),E=a(41),b=a.n(E);let v;v=null;const f={user:null,isAuthenticated:!E.isEmpty(null)};function y(e){return E.pick(e,["name"])}var w=a(25);const C=new w.c({name:"",country:"",id:null})();function N(e,t=w.a){return e.reduce((e,a)=>e.set(a.id,new t(a)),new w.b({}))}const O=Object(w.c)({loading:!1,entities:new w.b({})}),S=Object(w.c)({id:0,city:"",city_id:0,address:"",date:"",district:null,additional:"",players:0,activePlayers:1}),k=new O;const x=new(Object(w.c)({id:null,city:null,address:null,lat:null,district:null,long:null,players:0,city_id:0,active_players:1,date:null,additional:null,loading:!1,fieldNumbersInGame:[]}));const j=Object(w.c)({loading:!1,entities:new w.b({})}),A=Object(w.c)({id:null,text:null,username:null,date:null}),D=new j;const _=new w.c({loading:!1,loaded:!1})();var M=Object(h.combineReducers)({auth:(e=f,t)=>{switch(console.log("initial state, auth",t),t.type){case"SET_CURRENT_USER":const a=t.user;return localStorage.setItem("user",JSON.stringify(a)),{user:y(a),isAuthenticated:!E.isEmpty(a)};default:return e}},location:(e=C,t)=>{switch(t.type){case"SET_CITY":return t.payload?e.merge(t.payload):C;default:return e}},games:(e=k,t)=>{const a=t.type,n=t.payload;switch(a){case"LOAD_GAMES_SUCCESS":return n.data?e.update("entities",e=>N(n.data,S).sortBy(e=>e.get("date"))):k;case"GAME_ADDED_START":return e.set("loading",!0);case"PLAYER_JOINED":console.log("player join in list",n);const t=n.gameId,a=n.activePlayers;return e.updateIn(["entities",t],e=>{try{return e.set("activePlayers",a)}catch(t){console.log("not connected to list yet")}});case"GAME_ADDED_SUCCESS":const r=n.data,s=r.id;return r.city_id!==n.store.location.id?e:e.setIn(["entities",s],new S(n.data)).set("loading",!1).update("entities",e=>e.sortBy(e=>e.get("date")));default:return e}},game:(e=x,t)=>{const a=t.type,n=t.payload;switch(a){case"LOAD_GAME_START":return e.set("loading",!0);case"LOAD_GAME_SUCCESS":return e.merge(n.data).set("loading",!1);case"PLAYER_JOINED":const t=n.gameId,a=n.activePlayers,r=n.info;return e.get("id")===t?"joined"===r.event||"leaved"===r.event?function(e,{fieldNumbersInGame:t}){return e.set("fieldNumbersInGame",t)}(e,r):e.set("active_players",a).set("fieldNumbersInGame",r.fieldNumbersInGame):e;default:return e}},gameChat:(e=D,t)=>{const a=t.type,n=t.payload;switch(a){case"GAME_CHAT_MESSAGE_HISTORY":return e.update("entities",e=>N(n,A));case"GAME_CHAT_MESSAGE_ADDED":const t=e.setIn(["entities",n.id],new A(n));return t.update("entities",e=>t.entities.sortBy(e=>e.get("date")).reverse());default:return e}},loader:(e=_,t)=>{switch(console.log("TYPE ----",t.type),t.type){case"LOADING":return console.log("loading !!!!"),e.set("loading",!0).set("loaded",!1);case"LOADED":return e.set("loading",!1).set("loaded",!0);default:return e}}}),I=a(163),P=a(175);var G=Object(h.createStore)(M,Object(I.composeWithDevTools)(Object(h.applyMiddleware)(g.a,e=>t=>a=>{const n=a.callApi,r=a.type,s=Object(P.a)(a,["callApi","type"]);return n?(t(Object(o.a)(Object(o.a)({},s),{},{type:r+"_START"})),T.get(n).then(a=>{t(Object(o.a)(Object(o.a)({},s),{},{type:r+"_SUCCESS",payload:Object(o.a)(Object(o.a)({},a),{},{store:e.getState()})}))},e=>{t(Object(o.a)(Object(o.a)({},s),{},{type:r+"_FAIL",error:e}))})):t(a)})));p.a.defaults.baseURL="/api",p.a.interceptors.response.use(e=>e,e=>(403===e.response.status&&G.dispatch(L({})),Promise.reject(e)));var T=p.a;function L(e){return{type:"SET_CURRENT_USER",user:e}}var R=a(77),U=a(78),H=a(14);class J extends n.Component{componentDidMount(){let e;if(console.log("componentDidMount LOGIN WIDGET"),window&&window.location.hash)return e=JSON.parse(Base64.decode(window.location.hash)),localStorage.setItem("user",JSON.stringify(e)),e;try{e=JSON.parse(localStorage.user)}catch(a){e=null}const t=this.props.setCurUsr;console.log(e),t(e)}render(){const e=this.props,t=e.auth,a=e.logout,r=e.t;return n.createElement("div",{className:"absolute-login-widget"},n.createElement("div",null,t.isAuthenticated?t.user.name:"",t.isAuthenticated?n.createElement("a",{onClick:a,href:"#",className:"sign-out"},n.createElement(R.a,{icon:U.b})):n.createElement(c.a,{to:"/login",className:"sign-out"},r("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f")," ",n.createElement(R.a,{icon:U.b}))))}}var Y=Object(l.b)(e=>({auth:e.auth}),{logout:function(){return function(){var e=Object(u.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/auth/logout",{});case 2:localStorage.removeItem("user"),t(L({}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setCurUsr:function(e){return t=>{console.log("usr",e),t(L(e))}}})(Object(H.b)()(J));a(231);class B extends n.Component{constructor(...e){super(...e),this.state={mobileMenuShowed:!1}}componentDidMount(){console.log("HEADER MOUNT")}toggleMenu(){this.setState({mobileMenuShowed:!this.state.mobileMenuShowed})}hideMenu(){this.setState({mobileMenuShowed:!1})}render(){const e=this.props.t;return n.createElement("nav",{className:"main-menu"},n.createElement("div",{className:"container"},n.createElement("div",{className:"mobile-only"},n.createElement("div",{className:"mobile-menu"},n.createElement(R.a,{onClick:this.toggleMenu.bind(this),icon:U.a,size:"2x"}),this.state.mobileMenuShowed&&n.createElement("div",{className:"mobile-menu-items"},n.createElement("ul",{className:"shadow-2"},n.createElement("li",{onClick:this.hideMenu.bind(this)},n.createElement(c.a,{to:"/"},e("\u0413\u043b\u0430\u0432\u043d\u0430\u044f"))),n.createElement("li",{onClick:this.hideMenu.bind(this)},n.createElement(c.a,{to:"/about"},e("\u041e \u0441\u0435\u0440\u0432\u0438\u0441\u0435"))),n.createElement("li",{onClick:this.hideMenu.bind(this)},n.createElement(c.a,{to:"/create-game"},e("\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"))))))),n.createElement("ul",{id:"main-menu-ul",className:"desktop-only"},n.createElement("li",{className:"/"===window.location.pathname?"active":""},n.createElement(c.a,{to:"/"},e("\u0413\u043b\u0430\u0432\u043d\u0430\u044f"))),n.createElement("li",{onClick:this.hideMenu.bind(this),className:"/about"===window.location.pathname?"active":""},n.createElement(c.a,{to:"/about"},e("\u041e \u0441\u0435\u0440\u0432\u0438\u0441\u0435"))),n.createElement("li",{className:"/create-game"===window.location.pathname?"active":""},n.createElement(c.a,{to:"/create-game"},e("\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443")))),n.createElement(Y,null)))}}var F=Object(H.b)()(B);a(232),a(233);class W extends n.Component{render(){const e=this.props,t=e.name,a=e.country,r=e.id,s=e.doChoice;return n.createElement("div",{className:"city-item",onClick:()=>{s({name:t,country:a,id:r})}},this.composeAddress(this.props.name),n.createElement("small",null,this.composeAddress(this.props.region,", ")),n.createElement("small",null,this.composeAddress(this.props.country,", ")))}composeAddress(e,t=""){return e?n.createElement("span",null,t+e):""}}var q=Object(l.b)(e=>({location:e.location}),null)(W);a(234);const z=n.createContext(null),K=z.Provider,V=z.Consumer;var Q=e=>function(t){return n.createElement(V,null,a=>n.createElement(e,Object.assign({},t,{cityService:a})))};const X=n.createContext(null),Z=X.Provider,$=X.Consumer;var ee=e=>function(t){return n.createElement($,null,a=>n.createElement(e,Object.assign({},t,{gameService:a})))},te=e=>{class t extends n.Component{checkAuth(){this.props.isAuthenticated||this.props.history.push("/")}componentDidMount(){this.checkAuth()}componentDidUpdate(){this.checkAuth()}render(){return n.createElement(e,this.props)}}return Object(l.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}))(t)};class ae extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={cities:[],city:"",loading:null},this.handleChange=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.target.value,t.setState({city:n}),r=t.props.cityService,!(n.length>2)){e.next=11;break}return t.setState({loading:!0}),e.next=7,r.getCities(n);case 7:s=e.sent,console.log(s),t.setState({loading:!1}),t.setState({cities:s});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.pickerDoChoice=e=>(this.setState({cities:[],city:e.name}),this.props.doChoice(e))}render(){return n.createElement("div",{className:"city-auto-complete"},n.createElement("input",{type:"text",className:"form-control",autoComplete:"off",placeholder:"\u0413\u043e\u0440\u043e\u0434",onChange:this.handleChange}),this.state.loading&&n.createElement("div",{className:"lds-hourglass"}),this.state.cities.length?n.createElement("div",{className:"list"},this.state.cities.map(e=>n.createElement(q,Object.assign({key:e.id},e,{doChoice:this.pickerDoChoice})))):null)}}var ne=Q(ae);a(235);var re=function(e){return e.message?n.createElement("div",{className:"common-error-message"},e.message):null},se=a(386),le=(a(236),a(21)),ce=a(389),oe=a(404),ie=a(166),me=(a(237),a(238),a(170)),ue=a.n(me),de=a(174),pe=a(385);const he=Object(de.a)({palette:{primary:ue.a}});class ge extends n.Component{constructor(...e){super(...e),this.handleDateChange=e=>{(0,this.props.onChange)(e)}}render(){const e=this.props.t;return n.createElement("div",{className:"date"},n.createElement(pe.a,{theme:he},n.createElement(le.a,{locale:"ru",utils:ie.a},n.createElement(se.a,{container:!0,justify:"space-around"},n.createElement("div",{className:"customDatePickerWidth"},n.createElement(ce.a,{disableToolbar:!0,variant:"inline",margin:"normal",id:"date-picker-inline",label:e("\u0414\u0430\u0442\u0430"),value:this.props.value,onChange:this.handleDateChange,KeyboardButtonProps:{"aria-label":"change date"}})),n.createElement("div",{className:"customDatePickerWidth"},n.createElement(oe.a,{disableToolbar:!0,margin:"normal",id:"time-picker",label:e("\u0412\u0440\u0435\u043c\u044f"),ampm:!1,cancelLabel:"\u041e\u0442\u043c\u0435\u043d\u0430",okLabel:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c",value:this.props.value,onChange:this.handleDateChange,KeyboardButtonProps:{"aria-label":"change time"}}))))))}}var Ee=Object(H.b)()(ge);function be(e){return e?t=>{localStorage.setItem("location",JSON.stringify(e)),t(function(e){return{type:"LOAD_GAMES",callApi:"/game/city/".concat(e.id)}}(e)),t({type:"SET_CITY",payload:e})}:t=>{localStorage.setItem("location",""),t({type:"LOAD_GAMES_SUCCESS",payload:{data:null}}),t({type:"SET_CITY",payload:e})}}var ve=a(69);function fe(){return console.log("ac loading"),{type:"LOADING"}}function ye(){return console.log("ac loaded"),{type:"LOADED"}}ve.locale("ru");const we={data:{city:"",city_id:"",address:"",additional:"",players:6,date:ve.now(),district:""},errors:{}};class Ce extends n.Component{constructor(e){var t;super(e),t=this,this.state=void 0,this.setCity=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{city:e.name,city_id:e.id})})},this.resetCity=()=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{city:""})})},this.onChange=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{[e.target.name]:e.target.value})})},this.validate=e=>{const t={};for(const a in e)-1===["players","lat","long","additional"].indexOf(a)&&(e[a]||(t[a]="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"));return t},this.changeDate=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{date:e})})},this.onSubmit=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s,l,c,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n=t.state.data,t.checkIfAllowedCreate()){e.next=4;break}return e.abrupt("return");case 4:if(t.initCity(n),r=t.validate(n),t.setState({errors:r}),!b.a.isEmpty(r)){e.next=18;break}return s=t.props,l=s.gameService,c=s.loading,o=s.loaded,e.prev=9,c(),e.next=13,l.add(n);case 13:201===e.sent.status&&(t.setState(we),console.log("red"),t.props.history.push("/"));case 15:return e.prev=15,o(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[9,,15,18]])})));return function(t){return e.apply(this,arguments)}}(),Ce.setMeta(),this.state=we}static setMeta(){document.title="Football for everyone"}checkIfAllowedCreate(){const e=this.props,t=e.auth,a=e.t;return t.isAuthenticated||alert(a("\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443")),t.isAuthenticated}initCity(e){(0,this.props.setCity)({name:e.city,id:e.city_id})}static printFieldPlayersOptionList(){const e=[];for(let t=6;t<23;t++)e.push(t);return e.map(e=>n.createElement("option",{key:e},e))}render(){const e=this.state,t=e.data,a=e.errors,r=this.props.t;return n.createElement("div",{className:"row main-content"},n.createElement("div",{className:"left-col create-game-left-col"},n.createElement("form",{className:"game-form",onSubmit:this.onSubmit},n.createElement("fieldset",null,n.createElement("legend",null,r("\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443")),n.createElement("div",{className:"form-group",id:"gameCitySection"},n.createElement("label",null,r("\u0413\u043e\u0440\u043e\u0434")),!this.state.data.city&&n.createElement(ne,{doChoice:this.setCity,city:this.state.data.city}),this.state.data.city&&n.createElement("div",{className:"success-panel"},this.state.data.city,n.createElement("span",{onClick:this.resetCity},"\u2715")),a.city&&n.createElement(re,{message:a.city})),n.createElement("div",{className:"form-group"},n.createElement("label",null,r("\u0420\u0430\u0439\u043e\u043d")),n.createElement("input",{type:"text",className:"form-control",name:"district",value:t.district,onChange:this.onChange}),a.district&&n.createElement(re,{message:a.district})),n.createElement("div",{className:"form-group"},n.createElement("label",null,r("\u0410\u0434\u0440\u0435\u0441")),n.createElement("input",{type:"text",className:"form-control",name:"address",value:t.address,onChange:this.onChange}),a.address&&n.createElement(re,{message:a.address})),n.createElement("div",{className:"form-group date"},n.createElement(Ee,{onChange:this.changeDate,value:t.date}),a.date&&n.createElement(re,{message:a.date})),n.createElement("div",{className:"form-group"},n.createElement("label",null,r("\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432")),n.createElement("select",{className:"form-control col-2",onChange:this.onChange,value:t.players,name:"players"},Ce.printFieldPlayersOptionList()),a.players&&n.createElement(re,{message:a.players}))),n.createElement("div",{className:"form-group"},n.createElement("label",null,r("\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e")),n.createElement("textarea",{className:"form-control",name:"additional",value:t.additional,onChange:this.onChange}),a.additional&&n.createElement(re,{message:a.additional})),n.createElement("div",{className:"form-group"},n.createElement("button",{type:"submit",className:"btn submit-btn shadow-0"},r("\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))))))}}var Ne=Object(l.b)(e=>({location:e.location,games:e.game,auth:e.auth}),{setCity:be,setUser:function(e){return console.log("set user"),t=>{t(L(e))}},loading:fe,loaded:ye})(ee(Object(H.b)()(Ce))),Oe=(a(239),a(72)),Se=a.n(Oe);class ke extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={data:{email:""},loading:!1,backendErrors:[],errors:{email:null}},this.onChange=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{[e.target.name]:e.target.value})})},this.submit=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props.forgotPassword,a.preventDefault(),r=ke.validate(t.state.data),b.a.isEmpty(r.email)){e.next=6;break}return t.setState({errors:r}),e.abrupt("return");case 6:return e.next=8,n(t.state.data.email);case 8:window.location.href="/";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}static validate(e){const t={email:""};return e.email&&!Se.a.isEmail(e.email)&&(t.email="\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b"),e.email||(t.email="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),t}render(){const e=this.state.data.email;return n.createElement("div",null,n.createElement("form",{className:"col-12 col-md-6 col-lg-6 col-xl-6 login-form",onSubmit:this.submit},n.createElement("div",{className:"form-group"},this.state.errors.email&&n.createElement(re,{message:this.state.errors.email}),n.createElement("label",null,"Email"),n.createElement("input",{value:e,name:"email",onChange:this.onChange,className:"form-control",type:"text"})),n.createElement("p",null,n.createElement("button",{type:"submit",className:"btn submit-btn mb-2"},"\u0412\u043e\u0439\u0442\u0438"))))}}var xe=Object(l.b)(null,{forgotPassword:function(e){return function(){var t=Object(u.a)(m.a.mark((function t(a){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.post("/auth/forgot-password",{email:e});case 3:return n=t.sent,t.abrupt("return",Object(o.a)(Object(o.a)({},n.data),{},{status:n.status}));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0.response);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}})(ke);a(300),a(301);var je=Object(H.b)()((function({t:e}){return n.createElement("a",{href:"/api/auth/google"},n.createElement("div",{className:"loginWithGoogle"},n.createElement("img",{width:"20px",alt:"Google sign-in",src:"/img/Google__G__Logo.svg.webp"}),e("\u0412\u043e\u0439\u0442\u0438")," ",e("\u0441")," google"))}));class Ae extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={data:{email:"",password:""},loading:!1,backendErrors:[],errors:{email:null,password:null}},this.goToRegister=e=>{e.preventDefault(),window.location.href="/registration"},this.onChange=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{[e.target.name]:e.target.value})})},this.submit=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s,l,c,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.props,r=n.login,s=n.loading,l=n.loaded,c=t.state.data,a.preventDefault(),o=t.validate(c),t.setState({errors:o}),o.email||o.password){e.next=15;break}return e.prev=6,s(),e.next=10,r(c);case 10:i=e.sent,t.handleErrors(i.status);case 12:return e.prev=12,l(),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[6,,12,15]])})));return function(t){return e.apply(this,arguments)}}(),this.validate=e=>{const t={password:null,email:null};return e.password||(t.password="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),e.email||(t.email="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),Se.a.isEmail(e.email)||(t.email="\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b"),t}}handleErrors(e){if(e<300)this.props.history.push("/");else switch(e){case 401:this.setState({backendErrors:["\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0430\u0434\u0440\u0435\u0441\u0441"]});break;case 403:this.setState({backendErrors:["\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"]});break;default:this.setState({backendErrors:["\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u043e\u0449\u0438\u0431\u043a\u0430, \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u043a \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0443"]})}}render(){const e=this.props.t,t=this.state.data;return n.createElement("div",null,n.createElement("form",{className:"col-md-6 login-form",onSubmit:this.submit},this.state.backendErrors.map(e=>n.createElement(re,{key:e,message:e})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"E-mail ",e("\u0430\u0434\u0440\u0435\u0441")),n.createElement("input",{type:"email",id:"email",name:"email",placeholder:"example@gmail.com",value:t.email,onChange:this.onChange,className:"form-control"}),this.state.errors.email&&n.createElement(re,{message:this.state.errors.email})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),n.createElement("input",{type:"password",id:"password",name:"password",value:t.password,onChange:this.onChange,className:"form-control",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.password&&n.createElement(re,{message:this.state.errors.password})),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"forgot-password"},n.createElement(c.a,{to:"/forgot-password"},e("\u0417\u0430\u0431\u044b\u043b\u0438")," \u043f\u0430\u0440\u043e\u043b\u044c ?")),n.createElement("button",{type:"submit",className:"btn submit-btn mb-2"},e("\u0412\u043e\u0439\u0442\u0438")),"\xa0",n.createElement("button",{onClick:this.goToRegister,className:"btn submit-btn mb-2"},e("\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0442\u0441\u044f")),n.createElement("br",null),n.createElement(je,null))))}}var De=Object(l.b)(e=>({auth:e.auth}),{login:function(e){return function(){var t=Object(u.a)(m.a.mark((function t(a){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.post("/auth/login",e);case 3:return n=t.sent,a(L(n.data)),t.abrupt("return",Object(o.a)(Object(o.a)({},n.data),{},{status:n.status}));case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",t.t0.response);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},loading:fe,loaded:ye})(Object(H.b)()(Ae)),_e=(a(302),a(400));a(303),a(304);var Me=Object(H.b)()((function(e){const t=e.game,a=e.t;return n.createElement("div",{className:"game-info"},n.createElement("div",null,n.createElement("div",null,a("\u0413\u043e\u0440\u043e\u0434")),n.createElement("div",null,t.city)),n.createElement("div",null,n.createElement("div",null,"\u0420\u0430\u0439\u043e\u043d"),n.createElement("div",null,t.district)),n.createElement("div",null,n.createElement("div",null,a("\u0410\u0434\u0440\u0435\u0441")),n.createElement("div",null,t.address)),n.createElement("div",null,n.createElement("div",null,a("\u0418\u0433\u0440\u043e\u043a\u043e\u0432")),n.createElement("div",null,t.players," (",t.active_players,")")),t.additional&&n.createElement("div",null,n.createElement("div",null,a("\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e")),n.createElement("div",null,t.additional)))}));a(305);class Ie extends n.Component{render(){return n.createElement("div",{className:"teems-vs-flags"},n.createElement("div",{className:"first-teem"},n.createElement("div",null,n.createElement("img",{alt:"football-teem-first",src:"/img/orange-shirt.svg"}))),n.createElement("div",{className:"vs"},"\u2014"),n.createElement("div",{className:"second-teem"},n.createElement("div",null,n.createElement("img",{alt:"football-teem-second",src:"/img/white-shirt.svg"}))))}}var Pe=Ie;a(306),a(307);class Ge extends n.Component{render(){const e=this.props.message,t=e.text,a=e.username,r=e.date;return n.createElement("li",{className:"chatMessage"},n.createElement("div",{className:"message-data"},n.createElement("span",{className:"message-data-name"},a),n.createElement("span",{className:"message-data-time"},new Date(r).toISOString().slice(0,16).replace("T"," "))),n.createElement("div",{className:"message my-message shadow-0"},t))}}var Te=Ge;class Le extends n.Component{constructor(...e){var t;super(...e),t=this,this.maintainSocketMessages=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props,r=n.addChatMessage,s=n.loadChatHistory,a.on("*",e=>{switch(console.log(e),e.data[0]){case"GAME_CHAT_MESSAGE_HISTORY":s(e.data[1]);break;case"GAME_CHAT_MESSAGE_ADDED":r(e.data[1])}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.state={message:null},this.onChange=e=>{this.setState({[e.target.name]:e.target.value})},this.sendMessage=function(){var e=Object(u.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13===a.keyCode){e.next=2;break}return e.abrupt("return");case 2:if(""!==a.target.value.trim()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t.submit();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}componentDidMount(){var e=this;return Object(u.a)(m.a.mark((function t(){var a,n,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props,n=a.gameService,r=a.gameId,t.t0=e,t.next=4,n.initChat(r);case 4:return t.t1=t.sent,t.next=7,t.t0.maintainSocketMessages.call(t.t0,t.t1);case 7:return t.next=9,n.getChatHistory(r);case 9:case"end":return t.stop()}}),t)})))()}componentWillUnmount(){this.props.gameService.destroyChat()}submit(){var e=this;return Object(u.a)(m.a.mark((function t(){var a,n,r,s,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(document.getElementById("message").value=null,a=e.props,n=a.gameService,r=a.gameId,s=a.t,l=b.a.pick(e.state,["message"]),l.message){t.next=6;break}return alert("\u041d\u0435\u0442 \u0441\u043c\u044b\u0441\u043b\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0443\u0441\u0442\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"),t.abrupt("return");case 6:return t.prev=6,t.next=9,n.addChatMessage(Object(o.a)(Object(o.a)({},b.a.pick(e.state,["message"])),{},{gameId:r}));case 9:e.setState({message:null}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),t.t0.response.status>400&&t.t0.response.status<500&&alert(s("\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c, \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u043b\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u0447\u0430\u0442"));case 15:case"end":return t.stop()}}),t,null,[[6,12]])})))()}render(){const e=this.props,t=e.gameChat,a=e.t;return n.createElement("div",{className:"chat"},n.createElement("hr",null),n.createElement("div",{className:"form-group"},n.createElement("textarea",{onChange:this.onChange,className:"form-control",name:"message",id:"message",onKeyUp:this.sendMessage}),n.createElement("br",null),n.createElement("button",{className:"btn submit-btn mb-2 shadow-0",onClick:this.submit.bind(this)},a("\u041f\u043e\u0441\u043b\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"))),n.createElement("form",null,n.createElement("ul",null,t.entities.valueSeq().map(e=>n.createElement(Te,{key:e.id,message:e})))))}}var Re=Object(l.b)(e=>({gameChat:e.gameChat}),{addChatMessage:function(e){return{type:"GAME_CHAT_MESSAGE_ADDED",payload:e}},loadChatHistory:function(e){return{type:"GAME_CHAT_MESSAGE_HISTORY",payload:e}}})(ee(Object(H.b)()(Le)));a(308),a(309),a(310);class Ue extends n.Component{constructor(...e){super(...e),this.applyGame=()=>{const e=this.props,t=e.gameService,a=e.game,n=e.index,r=e.loading,s=e.loaded;r(),t.joinGame(a.id,n).catch(e=>{e.response.status>400&&e.response.status<500&&alert("\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u0441\u043d\u0430\u0447\u0430\u043b\u0430")}).finally(s)}}render(){const e=this.props,t=e.teem,a=e.index,r=e.gameRedux,s=r.fieldNumbersInGame&&r.fieldNumbersInGame.length>0&&-1!==r.fieldNumbersInGame.indexOf(a),l="/img/"+t+"-shirt.svg";return n.createElement("div",{className:"relative player",onClick:this.applyGame},n.createElement("div",{className:"number"},a),s?n.createElement("img",{className:"shirt",alt:"active-shirt",src:l}):n.createElement("img",{alt:"grey-shirt",className:"t-shirt-grey shirt",src:"/img/gray-shirt.svg"}))}}var He=ee(Object(l.b)(e=>({gameRedux:e.game}),{loading:fe,loaded:ye})(Ue));var Je=class{constructor(e){if(this.players=void 0,this.randomInt=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),this.tacticOrders={2:[1,1],3:[1,2],4:[1,2,1],5:[1,3,1],6:[1,3,2],7:[1,3,2,1],8:[1,3,3,1],9:[1,3,1,3,1],10:[1,3,2,3,1],11:[[1,4,4,2],[1,4,3,3]]},isNaN(e)||e<0)throw Error("Invalid parameter, should be number and > 0");this.players=e}splitOnTeems(){if(this.players%2){const e=(this.players-1)/2;return[e+1,e]}{const e=this.players/2;return[e,e]}}formGameOrder(){const e=this.splitOnTeems(),t=[];return e.forEach((e,a)=>{const n=Array.isArray(this.tacticOrders[e][0])?this.tacticOrders[e][this.randomInt(0,this.tacticOrders[e].length-1)]:this.tacticOrders[e];t.push(n)}),t}};class Ye extends n.Component{constructor(...e){super(...e),this.state={gameOrder:[],players:0}}static getDerivedStateFromProps(e,t){return{gameOrder:e.game.players===t.players?t.gameOrder:new Je(e.game.players).formGameOrder(),players:e.game.players}}render(){let e=" football-field ";return e+=this.props.auth.isAuthenticated?"active":"regular",n.createElement("div",null,n.createElement("div",{className:"north-socket"}),n.createElement("div",{className:e},n.createElement("div",{className:"football-field-center"}),n.createElement("div",{className:"left-top-corner"}),n.createElement("div",{className:"right-top-corner"}),n.createElement("div",{className:"left-bottom-corner"}),n.createElement("div",{className:"right-bottom-corner"}),this.state.gameOrder.length>0&&this.generateLines()),n.createElement("div",{className:"south-socket"}))}generateLines(){const e=[],t=this.props.game;let a=t.players;const r=[[],[]];let s=[],l=1;return this.state.gameOrder.forEach((e,c)=>{e.forEach(e=>{s=[];for(let r=1;r<=e&&a>0;r++)s.push(n.createElement(He,{teem:0===c?"orange":"white",key:r,game:t,index:a,isActive:!1})),a--;r[c].push(n.createElement("div",{key:l++,className:"tactic-line "},s))})}),e.push(n.createElement("div",{key:"north-side",className:"half-field north-side lines-".concat(r[0].length)},r[0])),e.push(n.createElement("div",{key:"south-side",className:"half-field south-side lines-".concat(r[1].length)},r[1])),e}}var Be=Object(l.b)(e=>({auth:e.auth}))(Ye);class Fe extends n.Component{constructor(...e){super(...e),this.state={gameOrder:[],players:0}}componentDidMount(){document.title="Football for everyone";const e=this.props,t=e.match.params;(0,e.loadGame)(t.id)}render(){const e=this.props,t=e.game,a=e.auth,r=e.t,s=this.props.match.params.id;return n.createElement("div",null,n.createElement("div",{className:"row game"},n.createElement("div",{className:"left-col"},n.createElement("div",null,n.createElement("p",null,a.isAuthenticated?r("\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443"):r("\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f, \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443"))),n.createElement("div",{className:"football-field-wrapper shadow-1"},n.createElement("div",null,"// @ts-ignore",n.createElement(Be,{game:t})))),n.createElement("div",{className:"right-col"},n.createElement("div",{className:"flags-info"},n.createElement(Me,{game:t}),n.createElement(Pe,null)),n.createElement(Re,{gameId:s}))))}}var We=Object(l.b)(e=>({game:e.game,auth:e.auth}),{loadGame:function(e){return{type:"LOAD_GAME",callApi:"/game/".concat(e)}}})(ee(Object(H.b)()(Fe)));a(311);class qe extends n.Component{componentDidMount(){qe.setMeta()}render(){const e=this.props.t;return n.createElement("h3",null,n.createElement("article",null,n.createElement("i",null,e("\u0415\u0441\u043b\u0438 \u0442\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u0448\u044c, \u0433\u0434\u0435 \u043d\u0430\u0439\u0442\u0438 \u043b\u044e\u0434\u0435\u0439 \u0434\u043b\u044f \u0438\u0433\u0440\u044b \u0432 \u0444\u0443\u0442\u0431\u043e\u043b - \u044d\u0442\u043e \u0441\u0430\u0439\u0442 \u043a\u0430\u043a \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u0435\u0431\u044f! \u0422\u0443\u0442 \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443 \u0434\u043b\u044f \u0438\u0433\u0440\u044b \u0432 \u0444\u0443\u0442\u0431\u043e\u043b. \u0422\u0443\u0442 \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443 \u043b\u0438\u0431\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043a \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439."))))}static setMeta(){document.title="About"}}var ze=Object(H.b)()(qe);a(312);class Ke extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={data:{email:"",password:"",name:"",repeatPassword:""},loading:!1,errors:{email:null,repeatPassword:null,password:null,name:null},backendErrors:[]},this.onChange=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{[e.target.name]:e.target.value})})},this.validate=e=>{const t=this.props.t,a={password:null,email:null,name:null,repeatPassword:null};return e.password||(a.password=t("\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")),e.email||(a.email=t("\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")),e.name||(a.name=t("\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")),!e.password!==!e.repeatPassword&&(a.repeatPassword=t("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442")),Se.a.isEmail(e.email)||(a.email=t("\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b")),a},this.onSubmit=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s,l,c,o,i,u,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props.t,r=t.state.data,a.preventDefault(),s=t.validate(r),t.setState({errors:s}),e.t0=m.a.keys(s);case 6:if((e.t1=e.t0()).done){e.next=12;break}if(l=e.t1.value,!s[l]){e.next=10;break}return e.abrupt("return");case 10:e.next=6;break;case 12:return c=b.a.pick(r,["name","password","email"]),o=t.props,i=o.registration,u=o.loading,d=o.loaded,e.prev=14,u(),e.next=18,i(c);case 18:t.props.history.push("/complete-registration"),e.next=29;break;case 21:e.prev=21,e.t2=e.catch(14),e.t3=e.t2.status,e.next=403===e.t3?26:28;break;case 26:return t.setState({backendErrors:[n("\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442")]}),e.abrupt("break",29);case 28:t.setState({backendErrors:e.t2.data.errors});case 29:return e.prev=29,d(),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[14,21,29,32]])})));return function(t){return e.apply(this,arguments)}}()}render(){const e=this.props.t,t=this.state.data;return n.createElement("form",{className:" col-12 col-md-12 col-sm-12 col-lg-6 col-xl-6 login-form",onSubmit:this.onSubmit},this.state.backendErrors?this.state.backendErrors.map(e=>n.createElement(re,{key:e,message:e})):null,n.createElement("div",{className:"form-group"},n.createElement("label",null,"\u041d\u0438\u043a"),n.createElement("input",{type:"name",id:"name",name:"name",value:t.name,placeholder:e("\u0411\u0443\u0434\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u0441\u044f \u0432 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435"),onChange:this.onChange,className:"form-control"}),this.state.errors.name&&n.createElement(re,{message:this.state.errors.name})),n.createElement("div",{className:"form-group"},n.createElement("label",{htmlFor:"exampleInputEmail1"},"E-mail ",e("\u0430\u0434\u0440\u0435\u0441")),n.createElement("input",{type:"email",id:"email",name:"email",placeholder:"example@gmail.com",value:t.email,onChange:this.onChange,className:"form-control"}),this.state.errors.email&&n.createElement(re,{message:this.state.errors.email})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),n.createElement("input",{type:"password",id:"password",name:"password",value:t.password,onChange:this.onChange,className:"form-control",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.password&&n.createElement(re,{message:this.state.errors.password})),n.createElement("div",{className:"form-group"},n.createElement("input",{type:"password",id:"repeatPassword",name:"repeatPassword",value:t.repeatPassword,onChange:this.onChange,className:"form-control",placeholder:e("\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")}),this.state.errors.repeatPassword&&n.createElement(re,{message:this.state.errors.repeatPassword})),n.createElement("div",{className:"form-group"},n.createElement("button",{type:"submit",className:"btn submit-btn mb-2"},e("\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0442\u0441\u044f"))))}}var Ve=Object(l.b)(null,{registration:function(e){return t=>new Promise((a,n)=>{T.post("/auth/registration",e).then(e=>{a(e)}).catch(e=>{console.log(e.response.data),t(L({})),n(e.response)})})},loading:fe,loaded:ye})(Object(H.b)()(Ke)),Qe=a(403);class Xe extends n.Component{render(){return n.createElement("div",null,"\u041d\u0430 \u0432\u0430\u0448\u0443 \u043f\u043e\u0447\u0442\u0443 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u0438\u0441\u044c\u043c\u043e, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435")}}var Ze=Xe;a(313);class $e extends n.Component{constructor(...e){var t;super(...e),t=this,this.state={data:{password:"",confirmPassword:""},loading:!1,backendErrors:[],errors:{password:"",confirmPassword:""}},this.onChange=e=>{this.setState({data:Object(o.a)(Object(o.a)({},this.state.data),{},{[e.target.name]:e.target.value})})},this.onSubmit=function(){var e=Object(u.a)(m.a.mark((function e(a){var n,r,s,l,c,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props,r=n.loaded,s=n.loading,l=n.changePassword,s(),a.preventDefault(),e.prev=3,c=$e.validate(t.state.data),i=c.password,t.setState(Object(o.a)(Object(o.a)({},t.state),{},{errors:{password:"",confirmPassword:""}})),e.next=8,l(i);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.setState(Object(o.a)(Object(o.a)({},t.state),{},{errors:{password:e.t0.toString().slice(7,100),confirmPassword:e.t0.toString().slice(7,100)}}));case 13:return e.prev=13,r(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])})));return function(t){return e.apply(this,arguments)}}()}componentDidMount(){this.props.auth.isAuthenticated||(window.location.href="/")}static validate({password:e,confirmPassword:t}){if(!e||!t||e!==t)throw Error("\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435");return{password:e,confirmPassword:t}}render(){const e=this.props.auth.user;return"google"===e.type?n.createElement("div",null,n.createElement("h3",null,e.name),n.createElement("p",null,"google account")):n.createElement("form",{className:"col-12 col-md-12 col-sm-12 col-lg-6 col-xl-6 login-form",onSubmit:this.onSubmit},this.state.errors.password&&n.createElement(re,{message:this.state.errors.password}),n.createElement("h2",null,e.name),n.createElement("h3",null,"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"),n.createElement("div",null,n.createElement("label",null,"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c")),n.createElement("div",null,n.createElement("input",{onChange:this.onChange,name:"password",className:"form-control"})),this.state.errors.confirmPassword&&n.createElement(re,{message:this.state.errors.confirmPassword}),n.createElement("div",null,n.createElement("label",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c")),n.createElement("div",null,n.createElement("input",{onChange:this.onChange,name:"confirmPassword",className:"form-control"})),n.createElement("br",null),n.createElement("div",{className:"form-group"},n.createElement("button",{type:"submit",className:"btn submit-btn shadow-0"},"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c")),n.createElement("br",null))}}var et=Object(l.b)(e=>({auth:e.auth}),{loaded:ye,loading:fe,changePassword:function(e){return function(){var t=Object(u.a)(m.a.mark((function t(a){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.post("/auth/change-password",{password:e});case 3:return n=t.sent,t.abrupt("return",Object(o.a)(Object(o.a)({},n.data),{},{status:n.status}));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0.response);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}})($e),tt=a(393),at=(a(314),a(394)),nt=a(395);class rt extends n.Component{constructor(...e){super(...e),this.click=()=>{this.props.history.push("/game/".concat(this.props.item.id))}}dateToReadable(){const e=this.props.item.date;return new Date(e).toISOString().slice(0,16).replace("T"," ")}render(){const e=this.props.item,t=e.address,a=e.district,r=e.players,s=e.activePlayers,l=e.id;return this.props.item?n.createElement(at.a,{key:l,onClick:this.click},n.createElement(nt.a,null,a),n.createElement(nt.a,null,t),n.createElement(nt.a,null,this.dateToReadable()),n.createElement(nt.a,null,r," (",s,")")):null}}var st=Object(Qe.a)(rt);a(316),a(317);class lt extends n.Component{constructor(...e){super(...e),this.onChange=e=>{this.props.onChange(e)}}render(){return n.createElement("div",{className:"input-barrette-wrap"},n.createElement("div",{className:"input-barrette shadow-1"},n.createElement("div",null,n.createElement("input",{type:"text",className:"form-control",onChange:this.onChange,placeholder:"\u0440\u0430\u0439\u043e\u043d"}))))}}var ct=lt,ot=a(397),it=a(399),mt=a(398),ut=a(396),dt=a(390);a(318);class pt extends n.Component{constructor(...e){super(...e),this.resetCity=()=>{(0,this.props.setCity)(null)},this.setCity=e=>{(0,this.props.setCity)(e)}}componentDidMount(){if(!localStorage.getItem("location"))return;const e=this.props.setCity;try{e(JSON.parse(localStorage.getItem("location")))}catch(t){console.error(t)}}render(){return n.createElement("div",{className:"city-widget"},this.props.location.id?n.createElement("span",{onClick:this.resetCity,className:"city-name shadow-1"},this.props.location.name):n.createElement("div",{className:"table-city-picker shadow-1"},n.createElement(ne,{doChoice:this.setCity})))}}var ht=Object(l.b)(e=>({location:e.location}),{setCity:be})(pt);class gt extends n.Component{constructor(...e){super(...e),this.state={district:null},this.filterDistrict=e=>{this.setState({district:e.target.value})}}render(){const e=this.props,t=e.games,a=e.t;return t.entities.valueSeq().size?n.createElement("div",{className:"game-sessions-greed"},n.createElement(ht,null),n.createElement("div",{className:"head-game-list"},n.createElement("div",{className:"district"},n.createElement(ct,{onChange:this.filterDistrict}))),n.createElement(ut.a,{component:dt.a},n.createElement(ot.a,{"aria-label":"simple table"},n.createElement(mt.a,null,n.createElement(at.a,null,n.createElement(nt.a,null,"\u0420\u0430\u0439\u043e\u043d"),n.createElement(nt.a,{align:"right"},a("\u0410\u0434\u0440\u0435\u0441")),n.createElement(nt.a,{align:"right"},a("\u0412\u0440\u0435\u043c\u044f")),n.createElement(nt.a,{align:"right"},a("\u0418\u0433\u0440\u043e\u043a\u043e\u0432")))),n.createElement(it.a,null,t.entities.valueSeq().filter(e=>!this.state.district||e.district.includes(this.state.district)).map(e=>n.createElement(st,{key:e.id,item:e})))))):n.createElement(ht,null)}}var Et=Object(l.b)(e=>({location:e.location,games:e.games}),null)(ee(Object(H.b)()(gt))),bt=a(120);const vt={ua:{translation:a(173)}};bt.a.use(H.a).init({resources:vt,lng:"ru",keySeparator:!1,interpolation:{escapeValue:!1}});var ft=bt.a;a(319);class yt extends n.Component{setLocale(e){return Object(u.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft.changeLanguage(e);case 2:return t.abrupt("return",null);case 3:case"end":return t.stop()}}),t)})))()}render(){return n.createElement("div",{className:"locales"},n.createElement("a",{href:"#","data-loc":"ua",onClick:this.setLocale.bind(null,"ua")},n.createElement("img",{src:"/locales/ua-32.png"})),n.createElement("span",null,"  "),n.createElement("a",{href:"#","data-loc":"ru",onClick:this.setLocale.bind(null,"ru")},n.createElement("img",{src:"/locales/ru-32.png"})))}}var wt=yt;class Ct extends n.Component{render(){const e=this.props,t=e.location,a=e.loader.loading,r=this.props.checkIfLogged;return console.log("loading",a),r().then(console.log),n.createElement("div",{className:t.id&&"city-picked"},n.createElement(F,null),n.createElement(wt,null),a&&n.createElement(tt.a,{className:"loader-spinner",color:"primary",size:400,thickness:.3}),n.createElement("div",{className:"container main-content"},n.createElement(_e.a,{path:"/about",exact:!0,component:ze}),n.createElement(_e.a,{path:"/account",exact:!0,component:te(et)}),n.createElement(_e.a,{path:"/login",exact:!0,component:De}),n.createElement(_e.a,{path:"/game/:id",exact:!0,component:We}),n.createElement(_e.a,{path:"/forgot-password",exact:!0,component:xe}),n.createElement(_e.a,{path:"/registration",exact:!0,component:Ve}),n.createElement(_e.a,{path:"/create-game",exact:!0,component:Ne}),n.createElement(_e.a,{path:"/complete-registration",exact:!0,component:Ze}),n.createElement(_e.a,{path:"/",exact:!0,component:Et})))}}var Nt=Object(Qe.a)(Object(l.b)(e=>({location:e.location,loader:e.loader}),{checkIfLogged:function(){return function(){var e=Object(u.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.get("/auth/ping");case 3:a=e.sent,e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),-1!==e.t0.message.indexOf("code 401")&&t(L(null)),a=e.t0.message;case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}})(Ct));var Ot=class{getCities(e){return e?T.get("/cities/getByName/".concat(e)).then(e=>e.data):new Promise(e=>{e([])})}},St=a(63),kt=a.n(St);const xt=a(160)(kt.a.Manager);var jt=class{constructor(){this._gameSocket=void 0}add(e){return e.date=e.date.format().split("+")[0]+"+0000",T.post("/game",e)}initChat(e){return new Promise(t=>{this._gameSocket=kt()({path:"/chat/game"}),xt(this._gameSocket),this._gameSocket.on("connect",()=>{this._gameSocket.emit("join","game".concat(e),t(this._gameSocket))})})}destroyChat(){this._gameSocket.disconnect()}addChatMessage(e){return T.post("/game/chat",e)}getChatHistory(e){return T.get("/game/chat/history/".concat(e))}joinGame(e,t){return T.post("/game/join",{gameId:e,playerNumber:t})}};const At=a(160)(kt.a.Manager),Dt=kt()({path:"/chat/game"}),_t=kt()({path:"/chat/general"});At(_t),At(Dt),_t.on("*",e=>{switch(e.data[0]){case"GAME_ADDED":console.log("game added"),G.dispatch((t=e.data[1],{type:"GAME_ADDED",callApi:"/game/".concat(t)}));break;case"PLAYER_JOINED":console.log("pl joined");const a=e.data[1],n=a.gameId,r=a.players,s=a.info;G.dispatch(function(e,t,a){return{type:"PLAYER_JOINED",payload:{gameId:e,activePlayers:t,info:a}}}(n,r,s));break;default:console.log("unknown action")}var t}),r.hydrate(n.createElement(s.a,null,n.createElement(l.a,{store:G},n.createElement(K,{value:new Ot},n.createElement(Z,{value:new jt},n.createElement(Nt,null))))),document.getElementById("root"))}},[[189,1,2]]]);
//# sourceMappingURL=main.bdd0cd37.chunk.js.map