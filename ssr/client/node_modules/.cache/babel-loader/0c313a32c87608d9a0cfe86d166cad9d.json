{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import*as React from\"react\";import{connect}from'react-redux';import'./account.scss';import ErrorMessage from'../../components/common/messages/error-message';import{loaded,loading}from\"../../ac/loader\";import{changePassword}from\"../../ac/auth\";class Account extends React.Component{constructor(...args){var _this;super(...args);_this=this;this.state={data:{password:'',confirmPassword:''},loading:false,backendErrors:[],errors:{password:'',confirmPassword:''}};this.onChange=e=>{this.setState({data:_objectSpread(_objectSpread({},this.state.data),{},{[e.target.name]:e.target.value})});};this.onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _this$props,loaded,loading,changePassword,_Account$validate,password;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this$props=_this.props,loaded=_this$props.loaded,loading=_this$props.loading,changePassword=_this$props.changePassword;loading();e.preventDefault();_context.prev=3;_Account$validate=Account.validate(_this.state.data),password=_Account$validate.password;_this.setState(_objectSpread(_objectSpread({},_this.state),{},{errors:{password:'',confirmPassword:''}}));_context.next=8;return changePassword(password);case 8:_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);_this.setState(_objectSpread(_objectSpread({},_this.state),{},{errors:{password:_context.t0.toString().slice(7,100),confirmPassword:_context.t0.toString().slice(7,100)}}));case 13:_context.prev=13;loaded();return _context.finish(13);case 16:case\"end\":return _context.stop();}},_callee,null,[[3,10,13,16]]);}));return function(_x){return _ref.apply(this,arguments);};}();}componentDidMount(){const auth=this.props.auth;if(!auth.isAuthenticated){window.location.href='/';}}static validate({password,confirmPassword}){if(!password||!confirmPassword||password!==confirmPassword){throw Error('Не валидное значение');}return{password,confirmPassword};}render(){const user=this.props.auth.user;if(user.type==='google'){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h3\",null,user.name),/*#__PURE__*/React.createElement(\"p\",null,\"google account\"));}return/*#__PURE__*/React.createElement(\"form\",{className:\"col-12 col-md-12 col-sm-12 col-lg-6 col-xl-6 login-form\",onSubmit:this.onSubmit},this.state.errors.password&&/*#__PURE__*/React.createElement(ErrorMessage,{message:this.state.errors.password}),/*#__PURE__*/React.createElement(\"h2\",null,user.name),/*#__PURE__*/React.createElement(\"h3\",null,\"\\u0421\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",null,\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{onChange:this.onChange,name:\"password\",className:\"form-control\"})),this.state.errors.confirmPassword&&/*#__PURE__*/React.createElement(ErrorMessage,{message:this.state.errors.confirmPassword}),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",null,\"\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{onChange:this.onChange,name:\"confirmPassword\",className:\"form-control\"})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn submit-btn shadow-0\"},\"\\u0421\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\")),/*#__PURE__*/React.createElement(\"br\",null));}}export default connect(state=>{return{auth:state.auth};},{loaded,loading,changePassword})(Account);","map":{"version":3,"sources":["/Users/yaroslavudodov/Code/f4e/ssr/client/src/components/account/account.tsx"],"names":["React","connect","ErrorMessage","loaded","loading","changePassword","Account","Component","state","data","password","confirmPassword","backendErrors","errors","onChange","e","setState","target","name","value","onSubmit","props","preventDefault","validate","toString","slice","componentDidMount","auth","isAuthenticated","window","location","href","Error","render","user","type"],"mappings":"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","sourcesContent":["import * as React from \"react\"\nimport {connect} from 'react-redux'\nimport './account.scss'\nimport ErrorMessage from '../../components/common/messages/error-message'\nimport {loaded, loading} from \"../../ac/loader\";\nimport {changePassword} from \"../../ac/auth\";\ninterface InputPasswords {password: string, confirmPassword: string}\n\ninterface Props {\n    auth: any,\n    loaded: any,\n    loading: any,\n    changePassword: any\n}\nclass Account extends React.Component<Props> {\n    state = {\n        data: {\n            password: '',\n            confirmPassword: ''\n        },\n        loading: false,\n        backendErrors: [],\n        errors: {password: '', confirmPassword: ''},\n    }\n    onChange = (e: any) => {\n        this.setState({data: {...this.state.data, [e.target.name]: e.target.value}})\n    }\n    componentDidMount(): void {\n        const { auth } = this.props;\n        if (!auth.isAuthenticated) {\n            window.location.href  = '/';\n        }\n    }\n\n    static validate({password, confirmPassword}: InputPasswords): InputPasswords {\n        if((!password || !confirmPassword) || password !== confirmPassword) {\n            throw Error('Не валидное значение')\n        }\n        return {password, confirmPassword}\n    }\n\n    onSubmit = async (e: any) => {\n        const {loaded, loading, changePassword} = this.props\n        loading()\n        e.preventDefault();\n        try {\n            const {password} = Account.validate(this.state.data)\n            this.setState({\n                ...this.state,\n                errors: {password: '', confirmPassword: ''}\n            })\n            await changePassword(password)\n        } catch (e) {\n            this.setState({\n                ...this.state,\n                errors: {\n                    password: e.toString().slice(7,100),\n                    confirmPassword: e.toString().slice(7,100)\n                }\n            })\n        } finally {\n           loaded()\n        }\n    }\n    render(): React.ReactNode {\n        const {user} = this.props.auth;\n        if(user.type === 'google') {\n            return (\n              <div>\n                  <h3>{user.name}</h3>\n                  <p>google account</p>\n              </div>\n            )\n        }\n        return (\n            <form className='col-12 col-md-12 col-sm-12 col-lg-6 col-xl-6 login-form'\n                  onSubmit={this.onSubmit}>\n                {this.state.errors.password && (\n                    <ErrorMessage message={this.state.errors.password} />\n                )}\n                <h2>{user.name}</h2>\n                <h3>Сменить пароль</h3>\n                <div>\n                    <label>Новый пароль</label>\n                </div>\n                <div>\n                    <input onChange={this.onChange} name='password' className='form-control'/>\n                </div>\n                {this.state.errors.confirmPassword && (\n                    <ErrorMessage message={this.state.errors.confirmPassword} />\n                )}\n                <div>\n                    <label>Подтвердить пароль</label>\n                </div>\n                <div>\n                    <input onChange={this.onChange} name='confirmPassword' className='form-control'/>\n                </div>\n                <br/>\n                <div className='form-group'>\n                    <button type=\"submit\" className=\"btn submit-btn shadow-0\">Сменить пароль</button>\n                </div>\n                <br/>\n            </form>\n        );\n    }\n}\nexport default connect((state: any) => {\n    return {\n        auth: state.auth,\n    };\n}, {loaded, loading, changePassword})(Account)\n"]},"metadata":{},"sourceType":"module"}