{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/yaroslavudodov/Code/f4e/ssr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import*as React from'react';import'./create-game.scss';import CityPicker from'../../components/common/city-picker';import ErrorMessage from'../../components/common/messages/error-message';import _ from'lodash';import{withGameService}from'../../HOCs';import{connect}from'react-redux';import DateTimeComponent from'../../components/common/date-time';import{setCity}from'../../ac/location';import{setUser}from'../../ac/auth';import*as moment from'moment';import{loading,loaded}from\"../../ac/loader\";import{withNamespaces}from\"react-i18next\";moment.locale('ru');const initialState={data:{city:'',city_id:'',address:'',additional:'',players:6,date:moment.default(new Date().setHours(new Date().getHours()+4)),district:''},errors:{}};class CreateGame extends React.Component{constructor(props){var _this;super(props);_this=this;this.state=void 0;this.setCity=city=>{this.setState({data:_objectSpread(_objectSpread({},this.state.data),{},{city:city.name,city_id:city.id})});};this.resetCity=()=>{this.setState({data:_objectSpread(_objectSpread({},this.state.data),{},{city:''})});};this.onChange=e=>{this.setState({data:_objectSpread(_objectSpread({},this.state.data),{},{[e.target.name]:e.target.value})});};this.validate=data=>{const errors={};for(const i in data){if(['players','lat','long','additional'].indexOf(i)!==-1){continue;}if(!data[i])errors[i]=\"\\u041D\\u0435 \\u043C\\u043E\\u0436\\u0435\\u0442 \\u0431\\u044B\\u0442\\u044C \\u043F\\u0443\\u0441\\u0442\\u044B\\u043C\";}return errors;};this.changeDate=e=>{this.setState({data:_objectSpread(_objectSpread({},this.state.data),{},{date:e})});};this.onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data,errors,_this$props,gameService,loading,loaded,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();data=_this.state.data;if(_this.checkIfAllowedCreate()){_context.next=4;break;}return _context.abrupt(\"return\");case 4:_this.initCity(data);errors=_this.validate(data);_this.setState({errors});if(!_.isEmpty(errors)){_context.next=18;break;}_this$props=_this.props,gameService=_this$props.gameService,loading=_this$props.loading,loaded=_this$props.loaded;_context.prev=9;loading();_context.next=13;return gameService.add(data);case 13:res=_context.sent;if(res.status===201){_this.setState(initialState);console.log('red');_this.props.history.push(\"/\");}case 15:_context.prev=15;loaded();return _context.finish(15);case 18:case\"end\":return _context.stop();}},_callee,null,[[9,,15,18]]);}));return function(_x){return _ref.apply(this,arguments);};}();CreateGame.setMeta();this.state=initialState;}static setMeta(){document.title='Football for everyone';}checkIfAllowedCreate(){const _this$props2=this.props,auth=_this$props2.auth,t=_this$props2.t;if(!auth.isAuthenticated){alert(t('Зарегистрируйтесь чтобы создать игру'));}return auth.isAuthenticated;}initCity(data){const setCity=this.props.setCity;setCity({name:data.city,id:data.city_id});}static printFieldPlayersOptionList(){const out=[];for(let i=6;i<23;i++){out.push(i);}return out.map(it=>/*#__PURE__*/React.createElement(\"option\",{key:it},it));}render(){const _this$state=this.state,data=_this$state.data,errors=_this$state.errors;const t=this.props.t;return/*#__PURE__*/React.createElement(\"div\",{className:\"row main-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"left-col create-game-left-col\"},/*#__PURE__*/React.createElement(\"form\",{className:'game-form',onSubmit:this.onSubmit},/*#__PURE__*/React.createElement(\"fieldset\",null,/*#__PURE__*/React.createElement(\"legend\",null,t('Создать игру')),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\",id:\"gameCitySection\"},/*#__PURE__*/React.createElement(\"label\",null,t('Город')),!this.state.data.city&&/*#__PURE__*/React.createElement(CityPicker,{doChoice:this.setCity,city:this.state.data.city}),this.state.data.city&&/*#__PURE__*/React.createElement(\"div\",{className:'success-panel'},this.state.data.city,/*#__PURE__*/React.createElement(\"span\",{onClick:this.resetCity},\"\\u2715\")),errors.city&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.city})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,t('Район')),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",name:\"district\",value:data.district,onChange:this.onChange}),errors.district&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.district})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,t('Адрес')),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",name:\"address\",value:data.address,onChange:this.onChange}),errors.address&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.address})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group date\"},/*#__PURE__*/React.createElement(DateTimeComponent// @ts-ignore\n,{onChange:this.changeDate,value:data.date}),errors.date&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.date})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,t('Количество игроков')),/*#__PURE__*/React.createElement(\"select\",{className:\"form-control col-2\",onChange:this.onChange,value:data.players,name:\"players\"},CreateGame.printFieldPlayersOptionList()),errors.players&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.players}))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,t('Дополнительно')),/*#__PURE__*/React.createElement(\"textarea\",{className:\"form-control\",name:\"additional\",value:data.additional,onChange:this.onChange}),errors.additional&&/*#__PURE__*/React.createElement(ErrorMessage,{message:errors.additional})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn submit-btn shadow-0\"},t('Создать'))))));}}export default connect(state=>{return{location:state.location,games:state.game,auth:state.auth};},{setCity,setUser,loading,loaded}// @ts-ignore\n)(withGameService(withNamespaces()(CreateGame)));","map":{"version":3,"sources":["/Users/yaroslavudodov/Code/f4e/ssr/client/src/components/create-game/create-game.tsx"],"names":["React","CityPicker","ErrorMessage","_","withGameService","connect","DateTimeComponent","setCity","setUser","moment","loading","loaded","withNamespaces","locale","initialState","data","city","city_id","address","additional","players","date","default","Date","setHours","getHours","district","errors","CreateGame","Component","constructor","props","state","setState","name","id","resetCity","onChange","e","target","value","validate","i","indexOf","changeDate","onSubmit","preventDefault","checkIfAllowedCreate","initCity","isEmpty","gameService","add","res","status","console","log","history","push","setMeta","document","title","auth","t","isAuthenticated","alert","printFieldPlayersOptionList","out","map","it","render","location","games","game"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport './create-game.scss'\nimport CityPicker from '../../components/common/city-picker'\nimport ErrorMessage from '../../components/common/messages/error-message'\nimport _ from 'lodash'\nimport {withGameService} from '../../HOCs'\nimport GamesList from '../games-list'\nimport {connect} from 'react-redux'\nimport DateTimeComponent from '../../components/common/date-time'\nimport SetCityWidget from '../../components/common/set-city-widget'\nimport {setCity} from '../../ac/location'\nimport {setUser} from '../../ac/auth'\nimport * as moment from 'moment'\nimport {loading, loaded} from \"../../ac/loader\";\nimport {JSX} from \"@babel/types\";\nimport {withNamespaces} from \"react-i18next\";\nimport { Redirect } from 'react-router-dom'\n\nmoment.locale('ru')\n\nconst initialState = {\n  data: {\n    city: '',\n    city_id: '',\n    address: '',\n    additional: '',\n    players: 6,\n    date: moment.default(new Date().setHours(new Date().getHours() + 4)),\n    district: '',\n  },\n  errors: {},\n}\n\ninterface Props {\n  gameService: any,\n  auth: any,\n  location: any,\n  setCity: any,\n  setUser: any,\n  match: any,\n  history: any,\n  loading:any,\n  loaded: any,\n  t: any\n}\n\nclass CreateGame extends React.Component<Props> {\n  state: {data: any, errors: any}\n\n  constructor(props: any) {\n    super(props)\n    CreateGame.setMeta()\n    this.state = initialState\n  }\n  static setMeta() {\n    document.title = 'Football for everyone'\n  }\n\n  setCity = (city: {name: string, id: number, country: string}) => {\n    this.setState({\n      data: {...this.state.data, city: city.name, city_id: city.id},\n    })\n  }\n\n  resetCity = () => {\n    this.setState({data: {...this.state.data, city: ''}})\n  }\n\n  onChange = (e: any):any => {\n    this.setState({\n      data: {...this.state.data, [e.target.name]: e.target.value},\n    });\n  };\n\n  validate = (data: any) => {\n    const errors:any = {}\n    for (const i in data) {\n      if (['players', 'lat', 'long', 'additional'].indexOf(i) !== -1) {\n        continue;\n      }\n      if (!data[i]) errors[i] = `Не может быть пустым`;\n    }\n    return errors\n  };\n\n  changeDate = (e: any) => {\n    this.setState({\n      data: {\n        ...this.state.data,\n        date: e,\n      },\n    });\n  };\n\n  checkIfAllowedCreate() {\n    const {auth, t} = this.props\n    if (!auth.isAuthenticated) {\n      alert(t('Зарегистрируйтесь чтобы создать игру'))\n    }\n    return auth.isAuthenticated;\n  }\n\n  initCity(data: {city: string, city_id: number}) {\n    const {setCity} = this.props\n    setCity({name: data.city, id: data.city_id});\n  }\n\n  static printFieldPlayersOptionList(): JSX.Element[] {\n    const out = [];\n    for(let i = 6; i<23; i++) { out.push(i) }\n    return out.map((it:number) => <option key={it}>{it}</option>)\n  }\n\n  onSubmit = async (e: any) => {\n    e.preventDefault()\n\n    const {data} = this.state;\n    if (!this.checkIfAllowedCreate()) {\n      return\n    }\n    this.initCity(data)\n    const errors = this.validate(data);\n    this.setState({\n      errors,\n    });\n    if (_.isEmpty(errors)) {\n      const {gameService, loading, loaded} = this.props;\n      try {\n        loading()\n        const res = await gameService.add(data)\n        if (res.status === 201) {\n          this.setState(initialState)\n          console.log('red')\n          this.props.history.push(`/`)\n        }\n      } finally {\n        loaded()\n      }\n    }\n  };\n\n  render() {\n\n    const {data, errors} = this.state\n    const {t} = this.props\n    return (\n      <div className=\"row main-content\">\n        <div className=\"left-col create-game-left-col\">\n          <form className={'game-form' } onSubmit={this.onSubmit}>\n            <fieldset>\n              <legend>{t('Создать игру')}</legend>\n              <div className=\"form-group\" id=\"gameCitySection\">\n                <label>{t('Город')}</label>\n                {!this.state.data.city &&\n                <CityPicker\n                  doChoice={this.setCity}\n                  city={this.state.data.city}\n                />}\n                {\n                  this.state.data.city &&\n                  <div className={'success-panel'}>{this.state.data.city}\n                    <span onClick={this.resetCity}>✕</span>\n                  </div>\n                }\n                {errors.city && <ErrorMessage message={errors.city} />}\n              </div>\n              <div className=\"form-group\">\n                <label>{t('Район')}</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"district\"\n                  value={data.district}\n                  onChange={this.onChange}\n                />\n                {errors.district && <ErrorMessage message={errors.district} />}\n              </div>\n              <div className=\"form-group\">\n                <label>{t('Адрес')}</label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  name=\"address\"\n                  value={data.address}\n                  onChange={this.onChange}\n                />\n                {errors.address && <ErrorMessage message={errors.address} />}\n              </div>\n              <div className=\"form-group date\">\n                <DateTimeComponent\n                  // @ts-ignore\n                  onChange={this.changeDate}\n                  value={data.date}/>\n                {errors.date && <ErrorMessage message={errors.date} />}\n              </div>\n              <div className=\"form-group\">\n                <label>{t('Количество игроков')}</label>\n                <select\n                  className=\"form-control col-2\"\n                  onChange={this.onChange}\n                  value={data.players}\n                  name=\"players\"\n                >\n                  {CreateGame.printFieldPlayersOptionList()}\n                </select>\n                {errors.players && <ErrorMessage message={errors.players} />}\n              </div>\n            </fieldset>\n            <div className=\"form-group\">\n              <label>{t('Дополнительно')}</label>\n              <textarea\n                className=\"form-control\"\n                name=\"additional\"\n                value={data.additional}\n                onChange={this.onChange}\n              />\n              {errors.additional && (\n                <ErrorMessage message={errors.additional} />\n              )}\n            </div>\n            <div className=\"form-group\">\n              <button type=\"submit\" className=\"btn submit-btn shadow-0\">\n                {t('Создать')}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    )\n  }\n}\n\n\nexport default connect(\n    (state: {location: any, game: any, auth: any}) => {\n      return {\n        location: state.location,\n        games: state.game,\n        auth: state.auth,\n      };\n    },\n    {setCity, setUser, loading, loaded}\n    // @ts-ignore\n)(withGameService(withNamespaces()(CreateGame)))\n"]},"metadata":{},"sourceType":"module"}