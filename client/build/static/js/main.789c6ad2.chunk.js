(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{270:function(e,t,a){e.exports=a(648)},279:function(e,t,a){},300:function(e,t){},302:function(e,t){},340:function(e,t){},341:function(e,t){},397:function(e,t,a){},399:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},403:function(e,t,a){},405:function(e,t,a){},406:function(e,t,a){},407:function(e,t,a){},554:function(e,t,a){},555:function(e,t,a){},618:function(e,t,a){},619:function(e,t,a){},620:function(e,t,a){},621:function(e,t,a){},622:function(e,t,a){},623:function(e,t,a){},624:function(e,t,a){},625:function(e,t,a){},626:function(e,t,a){},645:function(e,t){},648:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),l=a.n(c),i=a(653),s=a(20),o=a(7),u=a(8),m=a(10),d=a(9),p=a(11),h=(a(279),a(651)),f="_SUCCESS",g=a(27),v=a.n(g),b=a(100),E=a.n(b);function y(e){e?v.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete v.a.defaults.headers.common.Authorization}function O(e){return{type:"SET_CURRENT_USER",user:e}}function j(e){return localStorage.setItem("jwt",e),y(e),E.a.decode(e)}v.a.defaults.baseURL="/api";var w=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.logout;return t.isAuthenticated?r.a.createElement("div",{className:"absolute-login-widget"},t.user.name," ",r.a.createElement("i",{onClick:a,className:"fas fa-sign-out-alt"})):r.a.createElement("div",{className:"absolute-login-widget"},r.a.createElement("div",null,r.a.createElement(h.a,{to:"/login"},"\u0412\u043e\u0439\u0442\u0438")),r.a.createElement("div",null,r.a.createElement(h.a,{to:"/registration"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u0441\u044f")))}}]),t}(r.a.Component),C=Object(s.b)((function(e){return{auth:e.auth}}),{logout:function(){return function(e){localStorage.removeItem("jwt"),y(!1),e(O({}))}}})(w),N=(a(397),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).toggleMenu=function(){var e=document.getElementById("main-menu-ul");e.style.visibility="hidden"!==e.style.visibility&&e.style.visibility?"hidden":"visible"},a.closeMenu=function(){document.getElementById("main-menu-ul").style.visibility="hidden"},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"main-menu shadow-1"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"switcher",onClick:this.toggleMenu},r.a.createElement("i",{className:"fas fa-bars"})),r.a.createElement("ul",{id:"main-menu-ul",onClick:this.closeMenu},r.a.createElement("li",{className:"/"===window.location.pathname?"active":""},r.a.createElement(h.a,{to:"/"},"\u0413\u043b\u0430\u0432\u043d\u0430\u044f")),r.a.createElement("li",{className:"/about"===window.location.pathname?"active":""},r.a.createElement(h.a,{to:"/about"},"\u041e \u0441\u0435\u0440\u0432\u0438\u0441\u0435"))),r.a.createElement(C,null)))}}]),t}(r.a.Component)),k=a(25),S=a.n(k),A=a(34),x=a(43),_=a(30),D=(a(399),a(400),function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.country,n=e.id,c=e.doChoice;return r.a.createElement("div",{className:"city-item",onClick:function(){c({name:t,country:a,id:n})}},this.composeAddress(this.props.name),r.a.createElement("small",null,this.composeAddress(this.props.region,", ")),r.a.createElement("small",null,this.composeAddress(this.props.country,", ")))}},{key:"composeAddress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e?r.a.createElement("span",null,t+e):""}}]),t}(r.a.Component)),M=Object(s.b)((function(e){return{location:e.location}}),null)(D),I=(a(401),r.a.createContext(null)),G=I.Provider,T=I.Consumer,P=function(e){return function(t){return r.a.createElement(T,null,(function(a){return r.a.createElement(e,Object.assign({},t,{cityService:a}))}))}},R=r.a.createContext(null),L=R.Provider,H=R.Consumer,U=function(e){return function(t){return r.a.createElement(H,null,(function(a){return r.a.createElement(e,Object.assign({},t,{gameService:a}))}))}},B=P(function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={cities:[],city:"",loading:null},a.handleChange=function(){var e=Object(A.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,a.setState({city:n}),r=a.props.cityService,!(n.length>2)){e.next=10;break}return a.setState({loading:!0}),e.next=7,r.getCities(n);case 7:c=e.sent,a.setState({loading:!1}),a.setState({cities:c});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.pickerDoChoice=function(e){return a.setState({cities:[],city:e.name}),a.props.doChoice(e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.city!==this.state.city&&this.setState({city:e.city})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"city-auto-complete"},r.a.createElement("input",{type:"text",className:"form-control",value:this.state.city,autoComplete:"off",placeholder:"\u0413\u043e\u0440\u043e\u0434",onChange:this.handleChange}),this.state.loading&&r.a.createElement("div",{className:"lds-hourglass"}),this.state.cities.length?r.a.createElement("div",{className:"list"},this.state.cities.map((function(t){return r.a.createElement(M,Object.assign({key:t.id},t,{doChoice:e.pickerDoChoice}))}))):null)}}]),t}(r.a.Component));a(402);var F=function(e){return e.message?r.a.createElement("div",{className:"common-error-message"},e.message):null},Y=a(35),J=a.n(Y),q=(a(403),a(654)),z=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).click=function(){a.props.history.push("/game/".concat(a.props.item.id))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.item,t=e.address,a=e.additional,n=e.district,c=e.date,l=e.players,i=e.activePlayers;return this.props.item?r.a.createElement("div",{onClick:this.click,className:"game-item",title:a},r.a.createElement("div",{className:"district"},r.a.createElement("div",{className:"label"},"\u0420\u0430\u0439\u043e\u043d"),r.a.createElement("div",null,n)),r.a.createElement("div",{className:"address"},r.a.createElement("div",{className:"label"},"\u0410\u0434\u0440\u0435\u0441\u0441"),r.a.createElement("div",null,t)),r.a.createElement("div",null,r.a.createElement("div",{className:"label"},"\u0412\u0440\u0435\u043c\u044f"),r.a.createElement("div",null,new Date(c).toISOString().slice(0,16).replace("T"," "))),r.a.createElement("div",null,r.a.createElement("div",{className:"label"},"\u0418\u0433\u0440\u043e\u043a\u043e\u0432"),r.a.createElement("div",null,i||0," \u0438\u0437 ",l))):null}}]),t}(n.Component),W=Object(q.a)(z),K=(a(405),a(406),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).onChange=function(e){a.props.onChange(e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"input-barrette-wrap"},r.a.createElement("div",{className:"input-barrette shadow-1"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",className:"form-control",onChange:this.onChange,placeholder:"\u0440\u0430\u0439\u043e\u043d"}))))}}]),t}(r.a.Component)),V=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={district:null},a.filterDistrict=function(e){a.setState({district:e.target.value})},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.games;return console.log(t.entities.valueSeq().size),t.entities.valueSeq().size?r.a.createElement("div",null,r.a.createElement("div",{className:"head-game-list"},r.a.createElement("div",{className:"district"},r.a.createElement(K,{onChange:this.filterDistrict})),r.a.createElement("div",{className:"address table-label"},"\u0410\u0434\u0440\u0435\u0441"),r.a.createElement("div",{className:"time table-label"},"\u0414\u0430\u0442\u0430"),r.a.createElement("div",{className:"players table-label"},"\u0418\u0433\u0440\u043e\u043a\u043e\u0432")),t.entities.valueSeq().map((function(t){return null!==e.state.district&&-1===t.district.toLowerCase().indexOf(e.state.district.toLowerCase())?null:r.a.createElement(W,Object.assign({key:t.id,item:t},t))}))):null}}]),t}(n.Component),X=Object(s.b)((function(e){return{location:e.location,games:e.games}}),null)(U(V)),Z=a(50),Q=a.n(Z),$=a(66),ee=a(255),te=a.n(ee),ae=(a(407),a(254)),ne=(a(408),a(104));Q.a.locale("ru");var re=Object($.createMuiTheme)({typography:{useNextVariants:!0},palette:{primary:te.a}}),ce=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleDateChange=function(e){(0,a.props.onChange)(e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(ne.b,{utils:ae.a},r.a.createElement($.MuiThemeProvider,{theme:re},r.a.createElement("div",{className:"pickers"},r.a.createElement(ne.a,{className:"col-6",okLabel:"\u041e\u043a",cancelLabel:"\u041d\u0435 \u043e\u043a",value:this.props.value,onChange:this.handleDateChange}),r.a.createElement(ne.c,{okLabel:"\u041e\u043a",className:"col-6",cancelLabel:"\u041d\u0435 \u043e\u043a",ampm:!1,value:this.props.value,onChange:this.handleDateChange}))))}}]),t}(r.a.Component);a(554);function le(e){return e?function(t){localStorage.setItem("location",JSON.stringify(e)),t(function(e){return{type:"LOAD_GAMES",callApi:"/game/city/".concat(e.id)}}(e)),t({type:"SET_CITY",payload:e})}:function(t){localStorage.setItem("location",""),t({type:"LOAD_GAMES_SUCCESS",payload:{data:null}}),t({type:"SET_CITY",payload:e})}}var ie=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).resetCity=function(){(0,a.props.setCity)(null)},a.setCity=function(e){(0,a.props.setCity)(e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){if(localStorage.getItem("location")){var e=this.props.setCity;try{e(JSON.parse(localStorage.getItem("location")))}catch(t){}}}},{key:"render",value:function(){return r.a.createElement("div",{className:"city-widget"},this.props.location.id?r.a.createElement("span",{onClick:this.resetCity,className:"city-name shadow-1"},this.props.location.name):r.a.createElement("div",{className:"table-city-picker shadow-1"},r.a.createElement(B,{doChoice:this.setCity})))}}]),t}(r.a.Component),se=Object(s.b)((function(e){return{location:e.location}}),{setCity:le})(ie);Q.a.locale("ru");var oe={data:{city:"",city_id:"",address:"",lat:"",long:"",additional:"",players:6,date:Q()((new Date).setHours((new Date).getHours()+4)),district:""},errors:{}},ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state=void 0,a.setCity=function(e){a.setState({data:Object(_.a)({},a.state.data,{city:e.name,city_id:e.id})})},a.onChange=function(e){a.setState({data:Object(_.a)({},a.state.data,Object(x.a)({},e.target.name,e.target.value))})},a.validate=function(e){var t={};for(var a in e)-1===["players","lat","long","additional"].indexOf(a)&&(e[a]||(t[a]="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"));return t},a.changeDate=function(e){a.setState({data:Object(_.a)({},a.state.data,{date:e})})},a.onSubmit=function(){var e=Object(A.a)(S.a.mark((function e(t){var n,r,c,l,i,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.props,r=n.auth,c=n.setCity,r.isAuthenticated){e.next=5;break}return alert("\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"),e.abrupt("return");case 5:if(l=a.state.data,c({name:l.city,id:l.city_id}),i=a.validate(l),a.setState({errors:i}),!J.a.isEmpty(i)){e.next=15;break}return s=a.props.gameService,e.next=13,s.add(l);case 13:201===e.sent.status&&a.setState(oe);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.setMeta(),a.state=oe,a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=window.location.hash.substr(1);e&&(0,this.props.setUser)(e)}},{key:"render",value:function(){var e=this.props.auth,t=this.state,a=t.data,n=t.errors;return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-6 col-md-3 left-col"},r.a.createElement("form",{className:"game-form"+(e.isAuthenticated?" active":" passive"),onSubmit:this.onSubmit},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u0433\u0440\u0443."),r.a.createElement("div",{className:"form-group",id:"gameCitySection"},r.a.createElement("label",null,"\u0413\u043e\u0440\u043e\u0434"),r.a.createElement(B,{doChoice:this.setCity,city:this.state.data.city}),n.city&&r.a.createElement(F,{message:n.city})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u0420\u0430\u0439\u043e\u043d."),r.a.createElement("input",{type:"text",className:"form-control",name:"district",value:a.district,onChange:this.onChange}),n.district&&r.a.createElement(F,{message:n.district})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u0410\u0434\u0440\u0435\u0441"),r.a.createElement("input",{type:"text",className:"form-control",name:"address",value:a.address,onChange:this.onChange}),n.address&&r.a.createElement(F,{message:n.address})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u0414\u0430\u0442\u0430"),r.a.createElement(ce,{onChange:this.changeDate,value:a.date}),n.date&&r.a.createElement(F,{message:n.date})),!1,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432"),r.a.createElement("select",{className:"form-control col-2",onChange:this.onChange,value:a.players,name:"players"},r.a.createElement("option",null,"6"),r.a.createElement("option",null,"7"),r.a.createElement("option",null,"8"),r.a.createElement("option",null,"9"),r.a.createElement("option",null,"10"),r.a.createElement("option",null,"11"),r.a.createElement("option",null,"12"),r.a.createElement("option",null,"13"),r.a.createElement("option",null,"14"),r.a.createElement("option",null,"15"),r.a.createElement("option",null,"16"),r.a.createElement("option",null,"17"),r.a.createElement("option",null,"18"),r.a.createElement("option",null,"19"),r.a.createElement("option",null,"20"),r.a.createElement("option",null,"21"),r.a.createElement("option",null,"22")),n.players&&r.a.createElement(F,{message:n.players}))),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e"),r.a.createElement("textarea",{className:"form-control",name:"additional",value:a.additional,onChange:this.onChange}),n.additional&&r.a.createElement(F,{message:n.additional})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn submit-btn"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")))),r.a.createElement("div",{className:"col-12 col-md-9 flex right-col"},r.a.createElement("div",{className:"width-100"},r.a.createElement(se,null),r.a.createElement(X,null))))}}],[{key:"setMeta",value:function(){document.title="Football for everyone"}}]),t}(r.a.Component),me=Object(s.b)((function(e){return{location:e.location,games:e.game,auth:e.auth}}),{setCity:le,setUser:function(e){return function(t){var a=j(e);console.log("decode token",j(e)),t(O(a))}}})(U(ue)),de=(a(555),a(101)),pe=a.n(de),he=a(264),fe=a.n(he),ge=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:{email:"",password:""},loading:!1,backendErrors:[],errors:{email:null,password:null}},a.onChange=function(e){a.setState({data:Object(_.a)({},a.state.data,Object(x.a)({},e.target.name,e.target.value))})},a.onSubmit=function(e){var t=a.props.login,n=a.state.data;e.preventDefault();var r=a.validate(n);a.setState({errors:r}),J.a.isEmpty(r)&&(a.setState({loading:!0}),t(n).then((function(){a.props.history.push("/")}),(function(e){switch(e.status){case 401:"Not verified"===e.data?a.setState({backendErrors:["\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0430\u0434\u0440\u0435\u0441\u0441"]}):a.setState({backendErrors:["\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c1"]});break;default:a.setState({backendErrors:["\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u043e\u0449\u0438\u0431\u043a\u0430, \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435\u0441\u044c \u043a \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0443"]})}})).then((function(){a.setState({loading:!1})})))},a.validate=function(e){var t={password:null,email:null};return e.password||(t.password="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),e.email||(t.email="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),pe.a.isEmail(e.email)||(t.email="\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b"),t},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.data;return r.a.createElement("div",null,this.state.loading&&r.a.createElement(fe.a,{className:"login-spinner",size:200,thickness:1}),r.a.createElement("form",{className:" col-12 col-md-6 col-lg-6 col-xl-6 login-form",onSubmit:this.onSubmit},this.state.backendErrors.map((function(e){return r.a.createElement(F,{key:e,message:e})})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"E-mail \u0430\u0434\u0440\u0435\u0441"),r.a.createElement("input",{type:"email",id:"email",name:"email",placeholder:"example@gmail.com",value:e.email,onChange:this.onChange,className:"form-control"}),this.state.errors.email&&r.a.createElement(F,{message:this.state.errors.email}),r.a.createElement("small",{className:"form-text text-muted"},"\u041c\u044b \u043d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0434\u0438\u043c \u0432\u0430\u0448\u0443 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0443\u044e \u043f\u043e\u0447\u0442\u0443 \u043a\u043e\u043c\u0443-\u043b\u0438\u0431\u043e \u0435\u0449\u0435.")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",id:"password",name:"password",value:e.password,onChange:this.onChange,className:"form-control",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.password&&r.a.createElement(F,{message:this.state.errors.password})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn submit-btn mb-2"},"\u0412\u043e\u0439\u0442\u0438"))))}}]),t}(r.a.Component),ve=Object(s.b)((function(e){return{auth:e.auth}}),{login:function(e){return function(t){return new Promise((function(a,n){v.a.post("/auth/login-jwt",e).then((function(e){var n=j(e.data.token);t(O(n)),a(n)})).catch((function(e){n(e.response)}))}))}}})(ge),be=(a(617),a(652)),Ee=(a(618),a(265)),ye=a(266),Oe=(a(619),function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.alignUiFlags()}},{key:"render",value:function(){return r.a.createElement("div",{className:"teems-vs-flags"},r.a.createElement("div",{className:"first-teem"},r.a.createElement("div",{className:"second-teem"})))}},{key:"alignUiFlags",value:function(){var e=document.getElementsByClassName("first-teem")[0].offsetWidth;document.getElementsByClassName("second-teem")[0].style.borderRight=e+"px solid transparent"}}]),t}(r.a.Component)),je=(a(620),a(621),function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.message,t=e.text,a=e.username,n=e.date;return r.a.createElement("li",{className:"chatMessage"},r.a.createElement("div",{className:"message-data"},r.a.createElement("span",{className:"message-data-name"},a),r.a.createElement("span",{className:"message-data-time"},new Date(n).toISOString().slice(0,16).replace("T"," "))),r.a.createElement("div",{className:"message my-message"},t))}}]),t}(n.Component)),we=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).maintainSocketMessages=function(){var e=Object(A.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props,r=n.addChatMessage,c=n.loadChatHistory,t.on("*",(function(e){switch(e.data[0]){case"GAME_CHAT_MESSAGE_HISTORY":c(e.data[1]);break;case"GAME_CHAT_MESSAGE_ADDED":r(e.data[1])}}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={message:null},a.onChange=function(e){a.setState(Object(x.a)({},e.target.name,e.target.value))},a.sendMessage=function(){var e=Object(A.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13===t.keyCode){e.next=2;break}return e.abrupt("return");case 2:if(""!==t.target.value.trim()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a.submit();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(A.a)(S.a.mark((function e(){var t,a,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.gameService,n=t.gameId,e.t0=this,e.next=4,a.initChat(n);case 4:return e.t1=e.sent,e.next=7,e.t0.maintainSocketMessages.call(e.t0,e.t1);case 7:return e.next=9,a.getChatHistory(n);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=Object(A.a)(S.a.mark((function e(){var t,a,n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.getElementById("message").value=null,t=this.props,a=t.gameService,n=t.gameId,r=J.a.pick(this.state,["message"]),r.message){e.next=6;break}return alert("\u041d\u0435\u0442 \u0441\u043c\u044b\u0441\u043b\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0443\u0441\u0442\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"),e.abrupt("return");case 6:return e.prev=6,e.next=9,a.addChatMessage(Object(_.a)({},J.a.pick(this.state,["message"]),{gameId:n}));case 9:this.setState({message:null}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),403===e.t0.response.status&&alert("\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430");case 15:case"end":return e.stop()}}),e,this,[[6,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.gameChat;return r.a.createElement("div",{className:"chat"},r.a.createElement("hr",null),r.a.createElement("div",{className:"form-group padding-0"},r.a.createElement("textarea",{onChange:this.onChange,className:"form-control",name:"message",id:"message",placeholder:"\u0427\u0430\u0442",onKeyUp:this.sendMessage}),r.a.createElement("br",null),r.a.createElement("button",{className:"btn submit-btn mb-2",onClick:this.submit.bind(this)},"\u041f\u043e\u0441\u043b\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")),r.a.createElement("form",null,r.a.createElement("ul",null,e.entities.valueSeq().map((function(e){return r.a.createElement(je,{key:e.id,message:e})})))))}}]),t}(n.Component),Ce=Object(s.b)((function(e){return{gameChat:e.gameChat}}),{addChatMessage:function(e){return{type:"GAME_CHAT_MESSAGE_ADDED",payload:e}},loadChatHistory:function(e){return{type:"GAME_CHAT_MESSAGE_HISTORY",payload:e}}})(U(we)),Ne=(a(622),a(623),a(624),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).applyGame=function(){var e=a.props,t=e.gameService,n=e.game,r=e.index;t.joinGame(n.id,r).catch((function(e){403===e.response.status&&alert("\u0417\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u0441\u043d\u0430\u0447\u0430\u043b\u0430")}))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.teem,a=e.index,n=e.gameRedux,c=n.fieldNumbersInGame&&n.fieldNumbersInGame.length>0&&-1!==n.fieldNumbersInGame.indexOf(a),l="/img/"+t+"-shirt.png";return r.a.createElement("div",{className:"relative player",onClick:this.applyGame},r.a.createElement("div",{className:"number"},a),c?r.a.createElement("img",{alt:"active-shirt",src:l}):r.a.createElement("img",{alt:"grey-shirt",className:"t-shirt-grey",src:"/img/grey-shirt.png"}))}}]),t}(n.Component)),ke=U(Object(s.b)((function(e){return{gameRedux:e.game}}),null)(Ne)),Se=function(){function e(t){if(Object(o.a)(this,e),this.players=void 0,this.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},this.tacticOrders={2:[1,1],3:[1,2],4:[1,2,1],5:[1,3,1],6:[1,3,2],7:[1,3,2,1],8:[1,3,3,1],9:[1,3,1,3,1],10:[1,3,2,3,1],11:[[1,4,4,2],[1,4,3,3]]},isNaN(t)||t<0)throw Error("Invalid parameter, should be number and > 0");this.players=t}return Object(u.a)(e,[{key:"splitOnTeems",value:function(){if(this.players%2){var e=(this.players-1)/2;return[e+1,e]}var t=this.players/2;return[t,t]}},{key:"formGameOrder",value:function(){var e=this,t=this.splitOnTeems(),a=[];return t.forEach((function(t,n){var r=Array.isArray(e.tacticOrders[t][0])?e.tacticOrders[t][e.randomInt(0,e.tacticOrders[t].length-1)]:e.tacticOrders[t];a.push(r)})),a}}]),e}(),Ae=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={gameOrder:[],players:0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.auth;return r.a.createElement("div",{className:e.isAuthenticated?" football-field  active":" football-field  regular"},r.a.createElement("div",{className:"football-field-center"}),r.a.createElement("div",{className:"left-top-corner"}),r.a.createElement("div",{className:"right-top-corner"}),r.a.createElement("div",{className:"left-bottom-corner"}),r.a.createElement("div",{className:"right-bottom-corner"}),this.state.gameOrder.length>0&&this.generateLines())}},{key:"generateLines",value:function(){var e=[],t=this.props.game,a=t.players,n=[[],[]],c=[],l=1;return this.state.gameOrder.forEach((function(e,i){e.forEach((function(e){c=[];for(var s=1;s<=e&&a>0;s++)c.push(r.a.createElement(ke,{teem:0===i?"yellow":"blue",key:s,game:t,index:a,isActive:!1})),a--;n[i].push(r.a.createElement("div",{key:l++,className:"tactic-line "},c))}))})),e.push(r.a.createElement("div",{key:"north-side",className:"half-field north-side lines-".concat(n[0].length)},n[0])),e.push(r.a.createElement("div",{key:"south-side",className:"half-field south-side lines-".concat(n[1].length)},n[1])),e}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{gameOrder:e.game.players===t.players?t.gameOrder:new Se(e.game.players).formGameOrder(),players:e.game.players}}}]),t}(n.Component),xe=Object(s.b)((function(e){return{auth:e.auth}}))(Ae);Ee.a.add(ye.a);var _e=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={gameOrder:[],players:0},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){document.title="Football for everyone";var e=this.props,t=e.match.params;(0,e.loadGame)(t.id)}},{key:"render",value:function(){var e=this.props,t=e.game,a=e.auth,n=this.props.match.params.id;return r.a.createElement("div",null,r.a.createElement("div",{className:"row game"},r.a.createElement("div",{className:"col-md-6 left-col"},r.a.createElement("div",null,r.a.createElement("p",null,"\u0427\u0442\u043e \u0431\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f",a.isAuthenticated||", \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0442\u0435\u0441\u044c \u0438"," \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0444\u0443\u0442\u0431\u043e\u043b\u043a\u0443")),r.a.createElement("div",{className:"football-field-wrapper"},r.a.createElement("div",null,r.a.createElement(xe,{game:t})))),r.a.createElement("div",{className:"col-md-6 right-col padding-0"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 game-info"},r.a.createElement("div",null,t.city),r.a.createElement("div",null,t.district+", "+t.address),r.a.createElement("div",null,"\u0438\u0433\u0440\u043e\u043a\u043e\u0432 - ",t.players),t.additional?r.a.createElement("div",null,"\u0434\u043e\u043f \u0438\u043d\u0444\u043e - ",t.additional):""),r.a.createElement("div",{className:"col-md-6 padding-0"},r.a.createElement(Oe,null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement(Ce,{gameId:n}))))))}}]),t}(n.Component),De=Object(s.b)((function(e){return{game:e.game,auth:e.auth}}),{loadGame:function(e){return{type:"LOAD_GAME",callApi:"/game/".concat(e)}}})(U(_e)),Me=(a(625),function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){t.setMeta()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("article",null,"\u0415\u0441\u043b\u0438 \u0442\u044b \u043d\u0435 \u0437\u043d\u0430\u0435\u0448\u044c, \u0433\u0434\u0435 ",r.a.createElement("strong",null,"\u043d\u0430\u0439\u0442\u0438 \u043b\u044e\u0434\u0435\u0439 \u0434\u043b\u044f \u0438\u0433\u0440\u044b \u0432 \u0444\u0443\u0442\u0431\u043e\u043b"),r.a.createElement("span",null," - \u044d\u0442\u043e \u0441\u0430\u0439\u0442 \u043a\u0430\u043a \u0440\u0430\u0437 \u0434\u043b\u044f \u0442\u0435\u0431\u044f!")),r.a.createElement("article",null,"\u0422\u0443\u0442 \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443 \u043b\u0438\u0431\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043a \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439."),r.a.createElement("hr",null),r.a.createElement("div",{className:"guide padding-top-0"},r.a.createElement("p",null,"\u041a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443:"),r.a.createElement("iframe",{title:"\u041a\u0430\u043a \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443",width:"100%",height:"500",src:"https://www.youtube.com/embed/3qZnOWd4HMw",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})),r.a.createElement("div",{className:"guide"},r.a.createElement("p",null,"\u041a\u0430\u043a \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043a \u0438\u0433\u0440\u0435:"),r.a.createElement("iframe",{title:"\u041a\u0430\u043a \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0441\u044f \u043a \u0438\u0433\u0440\u0435",width:"100%",height:"500",src:"https://www.youtube.com/embed/X0I9aNDMaH8",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})))}}],[{key:"setMeta",value:function(){document.title="About"}}]),t}(n.Component)),Ie=(a(626),function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={data:{email:"",password:"",name:"",repeatPassword:""},loading:!1,errors:{email:null,repeatPassword:null,password:null,name:null},backendErrors:[]},a.onChange=function(e){a.setState({data:Object(_.a)({},a.state.data,Object(x.a)({},e.target.name,e.target.value))})},a.validate=function(e){var t={password:null,email:null,name:null,repeatPassword:null};return e.password||(t.password="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),e.email||(t.email="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),e.name||(t.name="\u041d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),!e.password!==!e.repeatPassword&&(t.repeatPassword="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"),pe.a.isEmail(e.email)||(t.email="\u041d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0435\u043c\u0435\u0439\u043b"),t},a.onSubmit=function(){var e=Object(A.a)(S.a.mark((function e(t){var n,r,c,l;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.data,t.preventDefault(),r=a.validate(n),a.setState({errors:r}),!J.a.isEmpty(r)){e.next=21;break}return c=J.a.pick(n,["name","password","email"]),l=a.props.registration,e.prev=7,e.next=10,l(c);case 10:a.props.history.push("/complete-registration"),e.next=21;break;case 13:e.prev=13,e.t0=e.catch(7),e.t1=e.t0.status,e.next=409===e.t1?18:20;break;case 18:return a.setState({backendErrors:["\u0422\u0430\u043a\u043e\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"]}),e.abrupt("break",21);case 20:a.setState({backendErrors:e.t0.data.errors});case 21:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.data;return r.a.createElement("form",{className:" col-12 col-md-12 col-sm-12 col-lg-6 col-xl-6 login-form",onSubmit:this.onSubmit},this.state.backendErrors?this.state.backendErrors.map((function(e){return r.a.createElement(F,{key:e,message:e})})):null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u041d\u0438\u043a"),r.a.createElement("input",{type:"name",id:"name",name:"name",value:e.name,placeholder:"\u0411\u0443\u0434\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u0441\u044f \u0432 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435",onChange:this.onChange,className:"form-control"}),this.state.errors.name&&r.a.createElement(F,{message:this.state.errors.name})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputEmail1"},"E-mail \u0430\u0434\u0440\u0435\u0441"),r.a.createElement("input",{type:"email",id:"email",name:"email",placeholder:"example@gmail.com",value:e.email,onChange:this.onChange,className:"form-control"}),this.state.errors.email&&r.a.createElement(F,{message:this.state.errors.email})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement("input",{type:"password",id:"password",name:"password",value:e.password,onChange:this.onChange,className:"form-control",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.password&&r.a.createElement(F,{message:this.state.errors.password})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",id:"repeatPassword",name:"repeatPassword",value:e.repeatPassword,onChange:this.onChange,className:"form-control",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}),this.state.errors.repeatPassword&&r.a.createElement(F,{message:this.state.errors.repeatPassword})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn submit-btn mb-2"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0442\u0441\u044f")))}}]),t}(n.Component)),Ge=Object(s.b)(null,{registration:function(e){return function(t){return new Promise((function(a,n){v.a.post("/auth/registration",e).then((function(e){a(e)})).catch((function(e){t(O({})),n(e.response)}))}))}}})(Ie),Te=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"\u041d\u0430 \u0432\u0430\u0448\u0443 \u043f\u043e\u0447\u0442\u0443 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u0438\u0441\u044c\u043c\u043e, \u0447\u0442\u043e\u0431\u044b \u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043f\u043e \u0441\u0441\u044b\u043b\u043a\u0435")}}]),t}(n.Component),Pe=function(e){function t(){return Object(o.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.location;return r.a.createElement("div",{className:e.id&&"city-picked"},r.a.createElement(N,null),r.a.createElement("div",{className:"container main-content"},r.a.createElement(be.a,{path:"/about",exact:!0,component:Me}),r.a.createElement(be.a,{path:"/login",exact:!0,component:ve}),r.a.createElement(be.a,{path:"/game/:id",exact:!0,component:De}),r.a.createElement(be.a,{path:"/registration",exact:!0,component:Ge}),r.a.createElement(be.a,{path:"/complete-registration",exact:!0,component:Te}),r.a.createElement(be.a,{path:"/",exact:!0,component:me})))}}]),t}(n.Component),Re=Object(q.a)(Object(s.b)((function(e){return{location:e.location}}),null)(Pe)),Le=a(49),He=a(267),Ue={user:Be(b.decode(localStorage.jwt)),isAuthenticated:!J.a.isEmpty(localStorage.jwt)};localStorage.jwt&&y(localStorage.jwt);function Be(e){return J.a.pick(e,["email","id","name"])}var Fe=a(31),Ye=new Fe.c({name:"",country:"",id:null})();function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fe.a;return e.reduce((function(e,a){return e.set(a.id,new t(a))}),new Fe.b({}))}var qe=Object(Fe.c)({loading:!1,entities:new Fe.b({})}),ze=Object(Fe.c)({id:0,city:"",city_id:0,address:"",date:"",district:null,additional:"",players:0,activePlayers:1}),We=new qe,Ke=new(Object(Fe.c)({id:null,city:null,address:null,lat:null,district:null,long:null,players:0,city_id:0,active_players:1,date:null,additional:null,loading:!1,fieldNumbersInGame:[]}));function Ve(e,t){var a=t.fieldNumbersInGame;return e.set("fieldNumbersInGame",a)}function Xe(e,t){var a=t.fieldNumbersInGame;return e.set("fieldNumbersInGame",a)}var Ze=Object(Fe.c)({loading:!1,entities:new Fe.b({})}),Qe=Object(Fe.c)({id:null,text:null,username:null,date:null}),$e=new Ze,et=Object(Le.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":var a=t.user;return{user:Be(a),isAuthenticated:!J.a.isEmpty(a)};default:return e}},location:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CITY":return t.payload?e.merge(t.payload):Ye;default:return e}},games:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOAD_GAMES_SUCCESS":return n.data?e.update("entities",(function(e){return Je(n.data,ze).sortBy((function(e){return e.get("date")}))})):We;case"GAME_ADDED_START":return e.set("loading",!0);case"PLAYER_JOINED":console.log("player join in list",n);var r=n.gameId,c=n.activePlayers;return e.updateIn(["entities",r],(function(e){try{return e.set("activePlayers",c)}catch(t){console.log("not connected to list yet")}}));case"GAME_ADDED_SUCCESS":var l=n.data,i=l.id,s=l.city_id;return s!==n.store.location.id?e:e.setIn(["entities",i],new ze(n.data)).set("loading",!1).update("entities",(function(e){return e.sortBy((function(e){return e.get("date")}))}));default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ke,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOAD_GAME_START":return e.set("loading",!0);case"LOAD_GAME_SUCCESS":return e.merge(n.data).set("loading",!1);case"PLAYER_JOINED":var r=n.gameId,c=n.activePlayers,l=n.info;return e.get("id")===r?"joined"===l.event?Xe(e,l):"leaved"===l.event?Ve(e,l):e.set("active_players",c).set("fieldNumbersInGame",l.fieldNumbersInGame):e;default:return e}},gameChat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GAME_CHAT_MESSAGE_HISTORY":return e.update("entities",(function(e){return Je(n,Qe)}));case"GAME_CHAT_MESSAGE_ADDED":var r=e.setIn(["entities",n.id],new Qe(n));return r.update("entities",(function(e){return r.entities.sortBy((function(e){return e.get("date")})).reverse()}));default:return e}}}),tt=a(268),at=a(269),nt=Object(Le.createStore)(et,Object(tt.composeWithDevTools)(Object(Le.applyMiddleware)(He.a,(function(e){return function(t){return function(a){var n=a.callApi,r=a.type,c=Object(at.a)(a,["callApi","type"]);return n?(t(Object(_.a)({},c,{type:r+"_START"})),v.a.get(n).then((function(a){t(Object(_.a)({},c,{type:r+f,payload:Object(_.a)({},a,{store:e.getState()})}))}),(function(e){t(Object(_.a)({},c,{type:r+"_FAIL",error:e}))}))):t(a)}}})))),rt=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,[{key:"getCities",value:function(e){return e?v.a.get("/cities/getByName/".concat(e)).then((function(e){return e.data})):new Promise((function(e){e([])}))}}]),e}(),ct=a(55),lt=a.n(ct),it=a(250)(lt.a.Manager),st=function(){function e(){Object(o.a)(this,e),this._gameSocket=null}return Object(u.a)(e,[{key:"add",value:function(){var e=Object(A.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.date=t.date.format().split("+")[0]+"+0000",e.next=3,v.a.post("/game",t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"initChat",value:function(e){var t=this;return console.log("init chat"),new Promise((function(a){t._gameSocket=lt()({path:"/chat/game"}),it(t._gameSocket),t._gameSocket.on("connect",(function(){console.log("game soket c"),t._gameSocket.emit("join","game"+e,a(t._gameSocket))}))}))}},{key:"addChatMessage",value:function(e){return v.a.post("/game/chat",e)}},{key:"getChatHistory",value:function(){var e=Object(A.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("/game/chat/history/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"joinGame",value:function(e,t){return v.a.post("/game/join",{gameId:e,playerNumber:t})}}]),e}(),ot=a(250)(lt.a.Manager),ut=lt()({path:"/chat/game"}),mt=lt()({path:"/chat/general"});ot(mt),ot(ut),mt.on("*",(function(e){switch(e.data[0]){case"GAME_ADDED":console.log("game added"),nt.dispatch((c=e.data[1],{type:"GAME_ADDED",callApi:"/game/".concat(c)}));break;case"PLAYER_JOINED":console.log("pl joined");var t=e.data[1],a=t.gameId,n=t.players,r=t.info;nt.dispatch(function(e,t,a){return{type:"PLAYER_JOINED",payload:{gameId:e,activePlayers:t,info:a}}}(a,n,r));break;default:console.log("unknown action")}var c})),l.a.render(r.a.createElement(i.a,null,r.a.createElement(s.a,{store:nt},r.a.createElement(G,{value:new rt},r.a.createElement(L,{value:new st},r.a.createElement(Re,null))))),document.getElementById("root"))}},[[270,1,2]]]);
//# sourceMappingURL=main.789c6ad2.chunk.js.map