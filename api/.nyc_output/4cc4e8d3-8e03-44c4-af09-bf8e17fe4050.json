{"/app/app/test/integrations/auth.spec.ts":{"path":"/app/app/test/integrations/auth.spec.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":15},"end":{"line":39,"column":32}},"68":{"start":{"line":40,"column":13},"end":{"line":40,"column":39}},"69":{"start":{"line":41,"column":10},"end":{"line":41,"column":30}},"70":{"start":{"line":42,"column":18},"end":{"line":42,"column":40}},"71":{"start":{"line":43,"column":11},"end":{"line":43,"column":26}},"72":{"start":{"line":44,"column":12},"end":{"line":44,"column":28}},"73":{"start":{"line":45,"column":15},"end":{"line":45,"column":35}},"74":{"start":{"line":46,"column":15},"end":{"line":46,"column":47}},"75":{"start":{"line":47,"column":11},"end":{"line":47,"column":48}},"76":{"start":{"line":48,"column":14},"end":{"line":48,"column":45}},"77":{"start":{"line":49,"column":15},"end":{"line":49,"column":47}},"78":{"start":{"line":50,"column":0},"end":{"line":50,"column":122}},"79":{"start":{"line":50,"column":43},"end":{"line":50,"column":119}},"80":{"start":{"line":50,"column":77},"end":{"line":50,"column":112}},"81":{"start":{"line":51,"column":0},"end":{"line":51,"column":120}},"82":{"start":{"line":51,"column":46},"end":{"line":51,"column":117}},"83":{"start":{"line":51,"column":80},"end":{"line":51,"column":110}},"84":{"start":{"line":52,"column":0},"end":{"line":52,"column":19}},"85":{"start":{"line":54,"column":4},"end":{"line":74,"column":7}},"86":{"start":{"line":55,"column":8},"end":{"line":73,"column":11}},"87":{"start":{"line":56,"column":12},"end":{"line":72,"column":13}},"88":{"start":{"line":58,"column":20},"end":{"line":58,"column":108}},"89":{"start":{"line":58,"column":92},"end":{"line":58,"column":104}},"90":{"start":{"line":59,"column":20},"end":{"line":62,"column":59}},"91":{"start":{"line":64,"column":20},"end":{"line":64,"column":30}},"92":{"start":{"line":65,"column":20},"end":{"line":68,"column":70}},"93":{"start":{"line":70,"column":20},"end":{"line":70,"column":30}},"94":{"start":{"line":71,"column":20},"end":{"line":71,"column":42}},"95":{"start":{"line":76,"column":0},"end":{"line":76,"column":36}},"96":{"start":{"line":78,"column":4},"end":{"line":94,"column":7}},"97":{"start":{"line":80,"column":8},"end":{"line":93,"column":11}},"98":{"start":{"line":81,"column":12},"end":{"line":92,"column":13}},"99":{"start":{"line":82,"column":24},"end":{"line":86,"column":65}},"100":{"start":{"line":88,"column":20},"end":{"line":88,"column":36}},"101":{"start":{"line":89,"column":20},"end":{"line":89,"column":79}},"102":{"start":{"line":90,"column":20},"end":{"line":90,"column":89}},"103":{"start":{"line":91,"column":20},"end":{"line":91,"column":88}},"104":{"start":{"line":96,"column":0},"end":{"line":96,"column":30}},"105":{"start":{"line":97,"column":0},"end":{"line":214,"column":3}},"106":{"start":{"line":98,"column":4},"end":{"line":107,"column":7}},"107":{"start":{"line":99,"column":8},"end":{"line":106,"column":11}},"108":{"start":{"line":102,"column":12},"end":{"line":102,"column":51}},"109":{"start":{"line":105,"column":12},"end":{"line":105,"column":45}},"110":{"start":{"line":108,"column":4},"end":{"line":111,"column":7}},"111":{"start":{"line":109,"column":8},"end":{"line":109,"column":24}},"112":{"start":{"line":110,"column":8},"end":{"line":110,"column":49}},"113":{"start":{"line":112,"column":4},"end":{"line":128,"column":11}},"114":{"start":{"line":112,"column":51},"end":{"line":128,"column":7}},"115":{"start":{"line":114,"column":8},"end":{"line":127,"column":11}},"116":{"start":{"line":115,"column":12},"end":{"line":126,"column":13}},"117":{"start":{"line":117,"column":20},"end":{"line":117,"column":108}},"118":{"start":{"line":117,"column":92},"end":{"line":117,"column":104}},"119":{"start":{"line":118,"column":20},"end":{"line":121,"column":59}},"120":{"start":{"line":123,"column":20},"end":{"line":123,"column":36}},"121":{"start":{"line":124,"column":20},"end":{"line":124,"column":65}},"122":{"start":{"line":125,"column":20},"end":{"line":125,"column":42}},"123":{"start":{"line":129,"column":4},"end":{"line":149,"column":11}},"124":{"start":{"line":129,"column":61},"end":{"line":149,"column":7}},"125":{"start":{"line":131,"column":8},"end":{"line":148,"column":11}},"126":{"start":{"line":132,"column":12},"end":{"line":147,"column":13}},"127":{"start":{"line":133,"column":24},"end":{"line":133,"column":61}},"128":{"start":{"line":135,"column":20},"end":{"line":135,"column":30}},"129":{"start":{"line":136,"column":20},"end":{"line":140,"column":69}},"130":{"start":{"line":142,"column":20},"end":{"line":142,"column":36}},"131":{"start":{"line":143,"column":20},"end":{"line":143,"column":131}},"132":{"start":{"line":144,"column":20},"end":{"line":144,"column":135}},"133":{"start":{"line":145,"column":20},"end":{"line":145,"column":69}},"134":{"start":{"line":146,"column":20},"end":{"line":146,"column":42}},"135":{"start":{"line":150,"column":4},"end":{"line":168,"column":11}},"136":{"start":{"line":150,"column":66},"end":{"line":168,"column":7}},"137":{"start":{"line":152,"column":8},"end":{"line":167,"column":11}},"138":{"start":{"line":153,"column":12},"end":{"line":166,"column":13}},"139":{"start":{"line":154,"column":24},"end":{"line":154,"column":61}},"140":{"start":{"line":156,"column":20},"end":{"line":156,"column":30}},"141":{"start":{"line":157,"column":20},"end":{"line":161,"column":70}},"142":{"start":{"line":163,"column":20},"end":{"line":163,"column":42}},"143":{"start":{"line":164,"column":20},"end":{"line":164,"column":75}},"144":{"start":{"line":165,"column":20},"end":{"line":165,"column":42}},"145":{"start":{"line":169,"column":4},"end":{"line":180,"column":11}},"146":{"start":{"line":169,"column":48},"end":{"line":180,"column":7}},"147":{"start":{"line":171,"column":8},"end":{"line":179,"column":11}},"148":{"start":{"line":172,"column":12},"end":{"line":178,"column":13}},"149":{"start":{"line":173,"column":24},"end":{"line":173,"column":113}},"150":{"start":{"line":175,"column":20},"end":{"line":175,"column":36}},"151":{"start":{"line":176,"column":20},"end":{"line":176,"column":37}},"152":{"start":{"line":177,"column":20},"end":{"line":177,"column":42}},"153":{"start":{"line":181,"column":4},"end":{"line":213,"column":11}},"154":{"start":{"line":181,"column":47},"end":{"line":213,"column":7}},"155":{"start":{"line":183,"column":8},"end":{"line":212,"column":11}},"156":{"start":{"line":184,"column":12},"end":{"line":211,"column":13}},"157":{"start":{"line":186,"column":20},"end":{"line":186,"column":113}},"158":{"start":{"line":186,"column":97},"end":{"line":186,"column":109}},"159":{"start":{"line":187,"column":20},"end":{"line":187,"column":57}},"160":{"start":{"line":189,"column":20},"end":{"line":189,"column":30}},"161":{"start":{"line":190,"column":20},"end":{"line":190,"column":54}},"162":{"start":{"line":192,"column":20},"end":{"line":192,"column":85}},"163":{"start":{"line":193,"column":20},"end":{"line":198,"column":70}},"164":{"start":{"line":200,"column":20},"end":{"line":200,"column":42}},"165":{"start":{"line":201,"column":20},"end":{"line":201,"column":75}},"166":{"start":{"line":202,"column":20},"end":{"line":206,"column":145}},"167":{"start":{"line":208,"column":20},"end":{"line":208,"column":47}},"168":{"start":{"line":209,"column":20},"end":{"line":209,"column":80}},"169":{"start":{"line":210,"column":20},"end":{"line":210,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"(anonymous_13)","decl":{"start":{"line":50,"column":26},"end":{"line":50,"column":27}},"loc":{"start":{"line":50,"column":41},"end":{"line":50,"column":121}},"line":50},"14":{"name":"(anonymous_14)","decl":{"start":{"line":50,"column":61},"end":{"line":50,"column":62}},"loc":{"start":{"line":50,"column":75},"end":{"line":50,"column":114}},"line":50},"15":{"name":"(anonymous_15)","decl":{"start":{"line":51,"column":29},"end":{"line":51,"column":30}},"loc":{"start":{"line":51,"column":44},"end":{"line":51,"column":119}},"line":51},"16":{"name":"(anonymous_16)","decl":{"start":{"line":51,"column":64},"end":{"line":51,"column":65}},"loc":{"start":{"line":51,"column":78},"end":{"line":51,"column":112}},"line":51},"17":{"name":"registerUser","decl":{"start":{"line":53,"column":9},"end":{"line":53,"column":21}},"loc":{"start":{"line":53,"column":24},"end":{"line":75,"column":1}},"line":53},"18":{"name":"(anonymous_18)","decl":{"start":{"line":54,"column":43},"end":{"line":54,"column":44}},"loc":{"start":{"line":54,"column":55},"end":{"line":74,"column":5}},"line":54},"19":{"name":"(anonymous_19)","decl":{"start":{"line":55,"column":33},"end":{"line":55,"column":34}},"loc":{"start":{"line":55,"column":47},"end":{"line":73,"column":9}},"line":55},"20":{"name":"fakeFn","decl":{"start":{"line":58,"column":81},"end":{"line":58,"column":87}},"loc":{"start":{"line":58,"column":90},"end":{"line":58,"column":106}},"line":58},"21":{"name":"testLogin","decl":{"start":{"line":77,"column":9},"end":{"line":77,"column":18}},"loc":{"start":{"line":77,"column":21},"end":{"line":95,"column":1}},"line":77},"22":{"name":"(anonymous_22)","decl":{"start":{"line":78,"column":43},"end":{"line":78,"column":44}},"loc":{"start":{"line":78,"column":55},"end":{"line":94,"column":5}},"line":78},"23":{"name":"(anonymous_23)","decl":{"start":{"line":80,"column":33},"end":{"line":80,"column":34}},"loc":{"start":{"line":80,"column":47},"end":{"line":93,"column":9}},"line":80},"24":{"name":"(anonymous_24)","decl":{"start":{"line":97,"column":26},"end":{"line":97,"column":27}},"loc":{"start":{"line":97,"column":38},"end":{"line":214,"column":1}},"line":97},"25":{"name":"(anonymous_25)","decl":{"start":{"line":98,"column":15},"end":{"line":98,"column":16}},"loc":{"start":{"line":98,"column":27},"end":{"line":107,"column":5}},"line":98},"26":{"name":"(anonymous_26)","decl":{"start":{"line":101,"column":18},"end":{"line":101,"column":19}},"loc":{"start":{"line":101,"column":30},"end":{"line":103,"column":9}},"line":101},"27":{"name":"(anonymous_27)","decl":{"start":{"line":104,"column":18},"end":{"line":104,"column":19}},"loc":{"start":{"line":104,"column":30},"end":{"line":106,"column":9}},"line":104},"28":{"name":"(anonymous_28)","decl":{"start":{"line":108,"column":14},"end":{"line":108,"column":15}},"loc":{"start":{"line":108,"column":26},"end":{"line":111,"column":5}},"line":108},"29":{"name":"(anonymous_29)","decl":{"start":{"line":112,"column":37},"end":{"line":112,"column":38}},"loc":{"start":{"line":112,"column":49},"end":{"line":128,"column":9}},"line":112},"30":{"name":"(anonymous_30)","decl":{"start":{"line":112,"column":92},"end":{"line":112,"column":93}},"loc":{"start":{"line":112,"column":104},"end":{"line":128,"column":5}},"line":112},"31":{"name":"(anonymous_31)","decl":{"start":{"line":114,"column":33},"end":{"line":114,"column":34}},"loc":{"start":{"line":114,"column":47},"end":{"line":127,"column":9}},"line":114},"32":{"name":"fakeFn","decl":{"start":{"line":117,"column":81},"end":{"line":117,"column":87}},"loc":{"start":{"line":117,"column":90},"end":{"line":117,"column":106}},"line":117},"33":{"name":"(anonymous_33)","decl":{"start":{"line":129,"column":47},"end":{"line":129,"column":48}},"loc":{"start":{"line":129,"column":59},"end":{"line":149,"column":9}},"line":129},"34":{"name":"(anonymous_34)","decl":{"start":{"line":129,"column":102},"end":{"line":129,"column":103}},"loc":{"start":{"line":129,"column":114},"end":{"line":149,"column":5}},"line":129},"35":{"name":"(anonymous_35)","decl":{"start":{"line":131,"column":33},"end":{"line":131,"column":34}},"loc":{"start":{"line":131,"column":47},"end":{"line":148,"column":9}},"line":131},"36":{"name":"(anonymous_36)","decl":{"start":{"line":150,"column":52},"end":{"line":150,"column":53}},"loc":{"start":{"line":150,"column":64},"end":{"line":168,"column":9}},"line":150},"37":{"name":"(anonymous_37)","decl":{"start":{"line":150,"column":107},"end":{"line":150,"column":108}},"loc":{"start":{"line":150,"column":119},"end":{"line":168,"column":5}},"line":150},"38":{"name":"(anonymous_38)","decl":{"start":{"line":152,"column":33},"end":{"line":152,"column":34}},"loc":{"start":{"line":152,"column":47},"end":{"line":167,"column":9}},"line":152},"39":{"name":"(anonymous_39)","decl":{"start":{"line":169,"column":34},"end":{"line":169,"column":35}},"loc":{"start":{"line":169,"column":46},"end":{"line":180,"column":9}},"line":169},"40":{"name":"(anonymous_40)","decl":{"start":{"line":169,"column":89},"end":{"line":169,"column":90}},"loc":{"start":{"line":169,"column":101},"end":{"line":180,"column":5}},"line":169},"41":{"name":"(anonymous_41)","decl":{"start":{"line":171,"column":33},"end":{"line":171,"column":34}},"loc":{"start":{"line":171,"column":47},"end":{"line":179,"column":9}},"line":171},"42":{"name":"(anonymous_42)","decl":{"start":{"line":181,"column":33},"end":{"line":181,"column":34}},"loc":{"start":{"line":181,"column":45},"end":{"line":213,"column":9}},"line":181},"43":{"name":"(anonymous_43)","decl":{"start":{"line":181,"column":88},"end":{"line":181,"column":89}},"loc":{"start":{"line":181,"column":100},"end":{"line":213,"column":5}},"line":181},"44":{"name":"(anonymous_44)","decl":{"start":{"line":183,"column":33},"end":{"line":183,"column":34}},"loc":{"start":{"line":183,"column":47},"end":{"line":212,"column":9}},"line":183},"45":{"name":"fakeFn","decl":{"start":{"line":186,"column":86},"end":{"line":186,"column":92}},"loc":{"start":{"line":186,"column":95},"end":{"line":186,"column":111}},"line":186}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":56,"column":12},"end":{"line":72,"column":13}},"type":"switch","locations":[{"start":{"line":57,"column":16},"end":{"line":62,"column":59}},{"start":{"line":63,"column":16},"end":{"line":68,"column":70}},{"start":{"line":69,"column":16},"end":{"line":71,"column":42}}],"line":56},"30":{"loc":{"start":{"line":81,"column":12},"end":{"line":92,"column":13}},"type":"switch","locations":[{"start":{"line":82,"column":16},"end":{"line":86,"column":65}},{"start":{"line":87,"column":16},"end":{"line":91,"column":88}}],"line":81},"31":{"loc":{"start":{"line":115,"column":12},"end":{"line":126,"column":13}},"type":"switch","locations":[{"start":{"line":116,"column":16},"end":{"line":121,"column":59}},{"start":{"line":122,"column":16},"end":{"line":125,"column":42}}],"line":115},"32":{"loc":{"start":{"line":132,"column":12},"end":{"line":147,"column":13}},"type":"switch","locations":[{"start":{"line":133,"column":16},"end":{"line":133,"column":61}},{"start":{"line":134,"column":16},"end":{"line":140,"column":69}},{"start":{"line":141,"column":16},"end":{"line":146,"column":42}}],"line":132},"33":{"loc":{"start":{"line":153,"column":12},"end":{"line":166,"column":13}},"type":"switch","locations":[{"start":{"line":154,"column":16},"end":{"line":154,"column":61}},{"start":{"line":155,"column":16},"end":{"line":161,"column":70}},{"start":{"line":162,"column":16},"end":{"line":165,"column":42}}],"line":153},"34":{"loc":{"start":{"line":172,"column":12},"end":{"line":178,"column":13}},"type":"switch","locations":[{"start":{"line":173,"column":16},"end":{"line":173,"column":113}},{"start":{"line":174,"column":16},"end":{"line":177,"column":42}}],"line":172},"35":{"loc":{"start":{"line":184,"column":12},"end":{"line":211,"column":13}},"type":"switch","locations":[{"start":{"line":185,"column":16},"end":{"line":187,"column":57}},{"start":{"line":188,"column":16},"end":{"line":190,"column":54}},{"start":{"line":191,"column":16},"end":{"line":198,"column":70}},{"start":{"line":199,"column":16},"end":{"line":206,"column":145}},{"start":{"line":207,"column":16},"end":{"line":210,"column":42}}],"line":184}},"s":{"0":1,"1":1,"2":0,"3":1,"4":0,"5":0,"6":0,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":1,"18":0,"19":3,"20":2,"21":2,"22":0,"23":2,"24":4,"25":4,"26":0,"27":4,"28":0,"29":4,"30":2,"31":2,"32":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":1,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":2,"60":1,"61":1,"62":4,"63":1,"64":1,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":0,"80":0,"81":1,"82":0,"83":0,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":1,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1,"112":1,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":1,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":1,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":1,"146":1,"147":1,"148":2,"149":1,"150":1,"151":0,"152":0,"153":1,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0},"f":{"0":1,"1":1,"2":0,"3":1,"4":0,"5":1,"6":1,"7":1,"8":1,"9":0,"10":3,"11":2,"12":2,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":1,"41":2,"42":0,"43":0,"44":0,"45":0},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1],"3":[0,1],"4":[1,1],"5":[1,1,1],"6":[1,0],"7":[1,1],"8":[0,2],"9":[0,4],"10":[4,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,4],"16":[1,2,1,0,0,1],"17":[1,0],"18":[1,1,0],"19":[1,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[1,0],"28":[0,0],"29":[0,0,0],"30":[0,0],"31":[0,0],"32":[0,0,0],"33":[0,0,0],"34":[1,1],"35":[0,0,0,0,0]},"inputSourceMap":{"version":3,"file":"/app/app/test/integrations/auth.spec.ts","sources":["/app/app/test/integrations/auth.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { strict as assert } from 'assert'\nimport knex from '../../libs/knex'\n\nimport app from '../../../'\nimport {MockedUser, MockedUserCredetials} from './mock.user'\nconst chai = require('chai')\nconst sinon = require('sinon')\nconst chaiHttp = require('chai-http')\nimport {encrypt} from '../../services/crypto'\nimport * as auth from '../../../app/services/auth'\nimport userService from '../../services/users'\nimport mailer from '../../services/mailer';\nexport const filterAuthToken = (arr) => arr.filter(it => it.includes('token=Bearer'))[0]\nexport const filterRefreshToken = (arr) => arr.filter(it => it.includes('refresh'))[0]\n\nchai.use(chaiHttp)\nexport async function registerUser() {\n    sinon.stub(auth, 'sendConfirmationEmail').callsFake(function fakeFn() {return true})\n\n    await chai\n        .request(app)\n        .post('/auth/registration')\n        .send(MockedUser)\n\n    await chai\n        .request(app)\n        .get(`/auth/confirm-email/${encrypt(MockedUser.email)}`)\n        .set('content-type', 'application/json')\n}\nexport async function testLogin() {\n    const res = await chai\n        .request(app)\n        .post(`/auth/login`)\n        .set('content-type', 'application/json')\n        .send(MockedUserCredetials)\n    const token = filterAuthToken(res.headers['set-cookie'])\n    const refreshToken = filterRefreshToken(res.headers['set-cookie'])\n    return {token, refreshToken}\n}\ndescribe('routes : auth', () => {\n  beforeEach(() => {\n    return knex.migrate\n        .rollback()\n        .then(() => {\n          return knex.migrate.latest()\n        })\n        .then(() => {\n          return knex.seed.run()\n        })\n  })\n  afterEach(() => {\n    sinon.restore()\n    return knex.migrate.rollback()\n  })\n\n  it('should register a new user', async () => {\n    sinon.stub(auth, 'sendConfirmationEmail').callsFake(function fakeFn() {return true})\n\n    const res = await chai\n                        .request(app)\n                        .post('/auth/registration')\n                        .send(MockedUser)\n    assert.strictEqual(res.status, 200)\n  })\n\n  it('should login user and provide tokens', async () => {\n      await registerUser()\n\n      const res = await chai\n                          .request(app)\n                          .post(`/auth/login`)\n                          .set('content-type', 'application/json')\n                          .send(MockedUserCredetials)\n\n      assert.strictEqual(filterAuthToken(res.headers['set-cookie']).includes('token=Bearer'), true)\n      assert.strictEqual(filterRefreshToken(res.headers['set-cookie']).includes('refreshToken='), true)\n      assert.strictEqual(res.statusCode, 200)\n  })\n\n  it('should update password on forgot password', async () => {\n      await registerUser()\n      const secondRes = await chai\n          .request(app)\n          .post(`/auth/forgot-password`)\n          .send({email: MockedUserCredetials.email})\n          .set('content-type', 'application/json')\n\n      assert.strictEqual(secondRes.statusCode, 200)\n  })\n\n  it.only('should send emails', async () => {\n      const res = await mailer.sendConfirmationEmail('yaroslavudodov@gmail.com');\n      console.log(res);\n  })\n\n  it('should change password', async () => {\n      sinon.stub(userService, 'sendNewPassword').callsFake(function fakeFn() {return true})\n      await registerUser()\n      const {token, refreshToken} = await testLogin();\n\n      const secondRes = await chai\n          .request(app)\n          .post(`/auth/change-password`)\n          .send({password: MockedUserCredetials.password+'1'})\n          .set('Cookie', token+';'+refreshToken)\n          .set('content-type', 'application/json')\n      assert.strictEqual(secondRes.statusCode, 200)\n\n      const newPasswordRes = await chai\n          .request(app)\n          .post(`/auth/login`)\n          .set('content-type', 'application/json')\n          .send({email: MockedUserCredetials.email, password:  MockedUserCredetials.password+'1'})\n\n      assert.strictEqual(newPasswordRes.statusCode, 200)\n  })\n})\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"14903912c8da4543b754bf00756bc42ee64a4ad5","contentHash":"ed6376564ecc395ad88132de7910e0469f3b4a6c69eeed82578173a8d43475d3"},"/app/app/libs/knex/index.ts":{"path":"/app/app/libs/knex/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":50}},"3":{"start":{"line":4,"column":68},"end":{"line":4,"column":98}},"4":{"start":{"line":4,"column":114},"end":{"line":4,"column":142}},"5":{"start":{"line":4,"column":164},"end":{"line":4,"column":198}},"6":{"start":{"line":4,"column":216},"end":{"line":4,"column":246}},"7":{"start":{"line":6,"column":11},"end":{"line":33,"column":2}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":23}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/libs/knex/index.ts","sources":["/app/app/libs/knex/index.ts"],"names":[],"mappings":";;AAAA,uCAAiC;AAG/B,IAAA,8CAAa,EACb,8CAAa,EACb,0CAAW,EACX,sDAAiB,EACjB,8CAAa,CACJ;AACX,2BAA2B;AAC3B,IAAM,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;IAC3B,MAAM,EAAE,IAAI;IACZ,OAAO,EAAE,MAAM;IACf,UAAU,EAAE;QACV,IAAI,EAAE,aAAa;QACnB,IAAI,EAAE,aAAa;QACnB,QAAQ,EAAE,iBAAiB;QAC3B,QAAQ,EAAE,WAAW;QACrB,IAAI,EAAE,aAAa;KACpB;IACD,IAAI,EAAE;QACJ,GAAG,EAAE,CAAC;QACN,GAAG,EAAE,CAAC;QACN,mBAAmB,EAAE,IAAI;QACzB,oBAAoB,EAAE,KAAK;QAC3B,iBAAiB,EAAE,KAAK;QACxB,kBAAkB,EAAE,IAAI;QACxB,yBAAyB,EAAE,GAAG;QAC9B,oBAAoB,EAAE,KAAK,CAAC,mCAAmC;KAChE;IACD,UAAU,EAAE;QACV,SAAS,EAAE,SAAS,GAAG,sBAAsB;QAC7C,SAAS,EAAE,iBAAiB;KAC7B;IACD,KAAK,EAAE;QACL,SAAS,EAAE,SAAS,GAAG,gBAAgB;KACxC;CACF,CAAC,CAAC;AACH,kBAAe,IAAI,CAAC","sourcesContent":["import config from '../../config'\n\nconst {\n  POSTGRES_HOST,\n  POSTGRES_USER,\n  POSTGRES_DB,\n  POSTGRES_PASSWORD,\n  POSTGRES_PORT,\n} = config;\n// tslint:disable-next-line\nconst knex = require('knex')({\n  client: 'pg',\n  version: '11.1',\n  connection: {\n    host: POSTGRES_HOST,\n    user: POSTGRES_USER,\n    password: POSTGRES_PASSWORD,\n    database: POSTGRES_DB,\n    port: POSTGRES_PORT,\n  },\n  pool: {\n    min: 2,\n    max: 6,\n    createTimeoutMillis: 3000,\n    acquireTimeoutMillis: 30000,\n    idleTimeoutMillis: 30000,\n    reapIntervalMillis: 1000,\n    createRetryIntervalMillis: 100,\n    propagateCreateError: false // <- default is true, set to false\n  },\n  migrations: {\n    directory: __dirname + '/../../db/migrations',\n    tableName: 'knex-migrations',\n  },\n  seeds: {\n    directory: __dirname + '/../../db/seed',\n  },\n});\nexport default knex;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"09e9e8fbfd1f5d87cd4f5946092dd18e0f3a03bc","contentHash":"9c90972717838047a61f2ab59894dd8e22fe94bba4965d08f3aa7c6eb3c216bc"},"/app/app/config/index.ts":{"path":"/app/app/config/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":30}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":1}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":20}},"4":{"start":{"line":7,"column":0},"end":{"line":26,"column":2}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":4,"column":0},"end":{"line":6,"column":1}},"type":"if","locations":[{"start":{"line":4,"column":0},"end":{"line":6,"column":1}},{"start":{"line":4,"column":0},"end":{"line":6,"column":1}}],"line":4},"1":{"loc":{"start":{"line":4,"column":4},"end":{"line":4,"column":82}},"type":"binary-expr","locations":[{"start":{"line":4,"column":4},"end":{"line":4,"column":42}},{"start":{"line":4,"column":46},"end":{"line":4,"column":77}},{"start":{"line":4,"column":81},"end":{"line":4,"column":82}}],"line":4},"2":{"loc":{"start":{"line":8,"column":9},"end":{"line":8,"column":46}},"type":"binary-expr","locations":[{"start":{"line":8,"column":9},"end":{"line":8,"column":29}},{"start":{"line":8,"column":33},"end":{"line":8,"column":46}}],"line":8},"3":{"loc":{"start":{"line":10,"column":19},"end":{"line":10,"column":58}},"type":"binary-expr","locations":[{"start":{"line":10,"column":19},"end":{"line":10,"column":44}},{"start":{"line":10,"column":48},"end":{"line":10,"column":58}}],"line":10},"4":{"loc":{"start":{"line":11,"column":19},"end":{"line":11,"column":58}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":44}},{"start":{"line":11,"column":48},"end":{"line":11,"column":58}}],"line":11},"5":{"loc":{"start":{"line":12,"column":17},"end":{"line":12,"column":54}},"type":"binary-expr","locations":[{"start":{"line":12,"column":17},"end":{"line":12,"column":40}},{"start":{"line":12,"column":44},"end":{"line":12,"column":54}}],"line":12},"6":{"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":66}},"type":"binary-expr","locations":[{"start":{"line":13,"column":23},"end":{"line":13,"column":52}},{"start":{"line":13,"column":56},"end":{"line":13,"column":66}}],"line":13},"7":{"loc":{"start":{"line":14,"column":19},"end":{"line":14,"column":52}},"type":"binary-expr","locations":[{"start":{"line":14,"column":19},"end":{"line":14,"column":44}},{"start":{"line":14,"column":48},"end":{"line":14,"column":52}}],"line":14},"8":{"loc":{"start":{"line":15,"column":10},"end":{"line":15,"column":48}},"type":"binary-expr","locations":[{"start":{"line":15,"column":10},"end":{"line":15,"column":40}},{"start":{"line":15,"column":44},"end":{"line":15,"column":48}}],"line":15},"9":{"loc":{"start":{"line":23,"column":16},"end":{"line":23,"column":63}},"type":"binary-expr","locations":[{"start":{"line":23,"column":16},"end":{"line":23,"column":38}},{"start":{"line":23,"column":42},"end":{"line":23,"column":63}}],"line":23},"10":{"loc":{"start":{"line":24,"column":10},"end":{"line":24,"column":53}},"type":"binary-expr","locations":[{"start":{"line":24,"column":10},"end":{"line":24,"column":26}},{"start":{"line":24,"column":30},"end":{"line":24,"column":53}}],"line":24},"11":{"loc":{"start":{"line":25,"column":27},"end":{"line":25,"column":70}},"type":"binary-expr","locations":[{"start":{"line":25,"column":27},"end":{"line":25,"column":60}},{"start":{"line":25,"column":64},"end":{"line":25,"column":70}}],"line":25}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{},"b":{"0":[1,0],"1":[1,1,0],"2":[1,0],"3":[1,0],"4":[1,0],"5":[1,0],"6":[1,0],"7":[1,0],"8":[1,1],"9":[1,1],"10":[1,1],"11":[1,1]},"inputSourceMap":{"version":3,"file":"/app/app/config/index.ts","sources":["/app/app/config/index.ts"],"names":[],"mappings":";;AAAA,+BAAgC;AAChC,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,EAAE;IAClF,MAAM,CAAC,MAAM,EAAE,CAAA;CAChB;AAED,kBAAe;IACb,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,aAAa;IAC1C,IAAI,EAAE,OAAO,CAAC,GAAG,EAAE;IACnB,aAAa,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI,UAAU;IACtD,aAAa,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI,UAAU;IACtD,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,UAAU;IAClD,iBAAiB,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB,IAAI,UAAU;IAC9D,aAAa,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI,IAAI;IAEhD,IAAI,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,IAAG,IAAI;IAE3C,gBAAgB,EAAE,OAAO,CAAC,GAAG,CAAC,gBAAgB;IAC9C,oBAAoB,EAAE,OAAO,CAAC,GAAG,CAAC,oBAAoB;IACtD,mBAAmB,EAAE,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAEpD,mBAAmB,EAAE,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACpD,kBAAkB,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;IAClD,eAAe,EAAE,OAAO,CAAC,GAAG,CAAC,eAAe;IAC5C,mBAAmB,EAAE,OAAO,CAAC,GAAG,CAAC,mBAAmB;IAEpD,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,qBAAqB;IAC3D,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,uBAAuB;IACjD,qBAAqB,EAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB,IAAI,MAAM;CACnE,CAAC","sourcesContent":["import * as dotEnv from 'dotenv'\nif (process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test' || 1) {\n  dotEnv.config()\n}\n\nexport default {\n  env: process.env.NODE_ENV || 'development',\n  root: process.cwd(),\n  POSTGRES_HOST: process.env.POSTGRES_HOST || 'postgres',\n  POSTGRES_USER: process.env.POSTGRES_USER || 'postgres',\n  POSTGRES_DB: process.env.POSTGRES_DB || 'postgres',\n  POSTGRES_PASSWORD: process.env.POSTGRES_PASSWORD || 'postgres',\n  POSTGRES_PORT: process.env.POSTGRES_PORT || 5432,\n\n  PORT: parseInt(process.env.PORT, 10)|| 5000,\n\n  GOOGLE_CLIENT_ID: process.env.GOOGLE_CLIENT_ID,\n  GOOGLE_CLIENT_SECRET: process.env.GOOGLE_CLIENT_SECRET,\n  GOOGLE_REDIRECT_URI: process.env.GOOGLE_REDIRECT_URI,\n\n  GMAIL_REFRESH_TOKEN: process.env.GMAIL_REFRESH_TOKEN,\n  GMAIL_ACCESS_TOKEN: process.env.GMAIL_ACCESS_TOKEN,\n  GMAIL_CLIENT_ID: process.env.GMAIL_CLIENT_ID,\n  GMAIL_CLIENT_SECRET: process.env.GMAIL_CLIENT_SECRET,\n\n  JWT_SECRET: process.env.JWT_SECRET || 'asdasdasdasdasdssss',\n  HOST: process.env.HOST || 'http://localhost:3050',\n  GAME_CHAT_ROOM_PREFIX: process.env.GAME_CHAT_ROOM_PREFIX || 'game'\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d2415f3c432cd05b5a2286fdff2675902a4968a2","contentHash":"6cf8072e451b7cb8a54a26b6c4c0612ceeda671da912630d8da1d4923bcbfcc3"},"/app/index.ts":{"path":"/app/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":10},"end":{"line":3,"column":24}},"2":{"start":{"line":4,"column":15},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":13},"end":{"line":5,"column":42}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":47}},"5":{"start":{"line":7,"column":10},"end":{"line":7,"column":19}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":41}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":32}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":36}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":32}},"10":{"start":{"line":12,"column":13},"end":{"line":12,"column":44}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":37}},"12":{"start":{"line":14,"column":0},"end":{"line":14,"column":25}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/index.ts","sources":["/app/index.ts"],"names":[],"mappings":";;AAAA,yBAA0B;AAC1B,6CAA4C;AAC5C,2CAAsD;AACtD,gDAA2C;AAC3C,IAAM,GAAG,GAAG,IAAI,GAAG,EAAE,CAAC;AACtB,GAAG,CAAC,GAAG,CAAC,kBAAQ,CAAC,UAAU,EAAE,CAAC,CAAA;AAC9B,0BAAmB,CAAC,GAAG,CAAC,CAAC;AACzB,gBAAW,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;AAC/B,gBAAW,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC3B,IAAM,MAAM,GAAG,gBAAW,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;AAC1C,gBAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAChC,kBAAe,MAAM,CAAA","sourcesContent":["import * as Koa from 'koa'\nimport ServerUtils from './app/utils/server'\nimport {addSocketsToContext} from './app/sockets/init'\nimport passport from './app/libs/passport';\nconst app = new Koa();\napp.use(passport.initialize())\naddSocketsToContext(app);\nServerUtils.addMiddleware(app);\nServerUtils.addRoutes(app);\nconst server = ServerUtils.runServer(app);\nServerUtils.wrapSockets(server);\nexport default server\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4fbded3da7e2b3f471e4d2545ff6a428c6743d14","contentHash":"dbe69f119074b325ce0da53945feed41d8ac750397bc6193e68504c689b5d932"},"/app/app/utils/server.ts":{"path":"/app/app/utils/server.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":35}},"2":{"start":{"line":4,"column":9},"end":{"line":4,"column":22}},"3":{"start":{"line":5,"column":11},"end":{"line":5,"column":26}},"4":{"start":{"line":6,"column":14},"end":{"line":6,"column":36}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":40}},"6":{"start":{"line":8,"column":13},"end":{"line":8,"column":39}},"7":{"start":{"line":9,"column":28},"end":{"line":32,"column":3}},"8":{"start":{"line":12,"column":4},"end":{"line":15,"column":6}},"9":{"start":{"line":13,"column":23},"end":{"line":13,"column":94}},"10":{"start":{"line":14,"column":8},"end":{"line":14,"column":113}},"11":{"start":{"line":14,"column":46},"end":{"line":14,"column":109}},"12":{"start":{"line":16,"column":4},"end":{"line":18,"column":6}},"13":{"start":{"line":17,"column":8},"end":{"line":17,"column":129}},"14":{"start":{"line":19,"column":4},"end":{"line":26,"column":6}},"15":{"start":{"line":20,"column":21},"end":{"line":20,"column":23}},"16":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"17":{"start":{"line":22,"column":8},"end":{"line":24,"column":11}},"18":{"start":{"line":23,"column":12},"end":{"line":23,"column":75}},"19":{"start":{"line":25,"column":8},"end":{"line":25,"column":33}},"20":{"start":{"line":27,"column":4},"end":{"line":30,"column":6}},"21":{"start":{"line":28,"column":8},"end":{"line":28,"column":68}},"22":{"start":{"line":29,"column":8},"end":{"line":29,"column":65}},"23":{"start":{"line":31,"column":4},"end":{"line":31,"column":18}},"24":{"start":{"line":33,"column":0},"end":{"line":33,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":9,"column":28},"end":{"line":9,"column":29}},"loc":{"start":{"line":9,"column":40},"end":{"line":32,"column":1}},"line":9},"1":{"name":"Server","decl":{"start":{"line":10,"column":13},"end":{"line":10,"column":19}},"loc":{"start":{"line":10,"column":22},"end":{"line":11,"column":5}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":28}},"loc":{"start":{"line":12,"column":42},"end":{"line":15,"column":5}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":25},"end":{"line":14,"column":26}},"loc":{"start":{"line":14,"column":44},"end":{"line":14,"column":111}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":16,"column":23},"end":{"line":16,"column":24}},"loc":{"start":{"line":16,"column":41},"end":{"line":18,"column":5}},"line":16},"5":{"name":"(anonymous_5)","decl":{"start":{"line":19,"column":23},"end":{"line":19,"column":24}},"loc":{"start":{"line":19,"column":38},"end":{"line":26,"column":5}},"line":19},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":68},"end":{"line":22,"column":69}},"loc":{"start":{"line":22,"column":94},"end":{"line":24,"column":9}},"line":22},"7":{"name":"(anonymous_7)","decl":{"start":{"line":27,"column":25},"end":{"line":27,"column":26}},"loc":{"start":{"line":27,"column":43},"end":{"line":30,"column":5}},"line":27}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":15},"end":{"line":17,"column":128}},"type":"cond-expr","locations":[{"start":{"line":17,"column":49},"end":{"line":17,"column":85}},{"start":{"line":17,"column":88},"end":{"line":17,"column":128}}],"line":17}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":4,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":3,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1},"f":{"0":1,"1":0,"2":1,"3":4,"4":1,"5":1,"6":3,"7":1},"b":{"0":[0,1]},"inputSourceMap":{"version":3,"file":"/app/app/utils/server.ts","sources":["/app/app/utils/server.ts"],"names":[],"mappings":";;AAAA,oCAA8B;AAC9B,uBAAwB;AACxB,2BAA4B;AAC5B,qCAAsC;AACtC,yCAA+B;AAC/B,wCAAyD;AAEzD;IAAA;IAoBA,CAAC;IAnBU,oBAAa,GAApB,UAAqB,GAAG;QACpB,IAAM,QAAQ,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,0BAA0B,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QACzF,QAAQ,CAAC,OAAO,CAAC,UAAC,OAAO,IAAK,OAAA,OAAO,CAAC,0BAA0B,GAAG,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAvD,CAAuD,CAAC,CAAC;IAC3F,CAAC;IACM,gBAAS,GAAhB,UAAiB,MAAM;QACnB,OAAO,MAAM,KAAK,gBAAM,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,gBAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,gBAAM,CAAC,IAAI,GAAC,CAAC,CAAC,CAAA;IAC5F,CAAC;IACM,gBAAS,GAAhB,UAAiB,GAAG;QAChB,IAAM,MAAM,GAAG,EAAE,CAAC;QAClB,GAAG,CAAC,GAAG,CAAC,oBAAM,EAAE,CAAC,CAAA;QACjB,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC,CAAC,OAAO,CAAC,UAAC,cAAc;YACvE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,GAAC,cAAc,CAAC,CAAC,MAAM,EAAE,CAAC,CAAA;QAChE,CAAC,CAAC,CAAC;QACH,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IAC7B,CAAC;IACM,kBAAW,GAAlB,UAAmB,MAAM;QACrB,oBAAa,CAAC,MAAM,CAAC,MAAM,EAAE,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;QACnD,iBAAU,CAAC,MAAM,CAAC,MAAM,EAAE,EAAC,WAAW,EAAE,KAAK,EAAC,CAAC,CAAC;IACpD,CAAC;IACL,aAAC;AAAD,CAAC,AApBD,IAoBC;AACD,kBAAe,MAAM,CAAA","sourcesContent":["import config from '../config'\nimport * as fs from 'fs'\nimport * as path from 'path'\nimport * as compose from 'koa-compose'\nimport cookie from 'koa-cookie'\nimport {gameSocket, generalSocket} from '../sockets/init'\n\nclass Server {\n    static addMiddleware(app): void {\n        const handlers = fs.readdirSync(path.join(__dirname, './../middleware/default/')).sort();\n        handlers.forEach((handler) => require('./../middleware/default/' + handler).init(app));\n    }\n    static runServer(koaApp) {\n        return 'test' !== config.env ? koaApp.listen(config.PORT) : koaApp.listen(config.PORT+2)\n    }\n    static addRoutes(app): void {\n        const routes = [];\n        app.use(cookie())\n        fs.readdirSync(path.join(__dirname, './../routes')).forEach((middlewarePath) => {\n            routes.push(require('./../routes/'+middlewarePath).routes())\n        });\n        app.use(compose(routes));\n    }\n    static wrapSockets(server) {\n        generalSocket.attach(server, {pingTimeout: 60000});\n        gameSocket.attach(server, {pingTimeout: 60000});\n    }\n}\nexport default Server\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ff9f5a30b9098386955ec1799264407d82bf348c","contentHash":"f7458fd4ed0a8ebfaa9625c60736f4e38606c1e1edeaed42f55d86c26ac6bdf9"},"/app/app/sockets/init.ts":{"path":"/app/app/sockets/init.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":44}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"3":{"start":{"line":5,"column":23},"end":{"line":5,"column":50}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":49}},"5":{"start":{"line":7,"column":26},"end":{"line":11,"column":5}},"6":{"start":{"line":7,"column":43},"end":{"line":11,"column":3}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":9,"column":4},"end":{"line":9,"column":45}},"9":{"start":{"line":10,"column":4},"end":{"line":10,"column":18}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":50}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":26},"end":{"line":7,"column":27}},"loc":{"start":{"line":7,"column":41},"end":{"line":11,"column":5}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":58},"end":{"line":7,"column":59}},"loc":{"start":{"line":7,"column":79},"end":{"line":11,"column":1}},"line":7}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":1},"f":{"0":1,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/sockets/init.ts","sources":["/app/app/sockets/init.ts"],"names":[],"mappings":";;AAAA,6CAAsC;AAWpC,qBAXK,qBAAU,CAWL;AAVZ,mDAA4C;AAS1C,wBATK,wBAAa,CASL;AAPf,IAAM,mBAAmB,GAAG,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,IAAI;IACrD,GAAG,CAAC,MAAM,GAAG,qBAAU,CAAA;IACvB,GAAG,CAAC,SAAS,GAAG,wBAAa,CAAA;IAC7B,OAAO,IAAI,EAAE,CAAA;AACf,CAAC,CAAC,EAJmC,CAInC,CAAA;AAKA,kDAAmB","sourcesContent":["import gameSocket from './game-socket'\nimport generalSocket from './general-socket'\n\nconst addSocketsToContext = (app) => app.use((ctx, next) => {\n  ctx.ioGame = gameSocket\n  ctx.ioGeneral = generalSocket\n  return next()\n})\n\nexport {\n  generalSocket,\n  gameSocket,\n  addSocketsToContext,\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"23e9f0324ea1f315a810f374ae9c21a756dee8e3","contentHash":"bd812808e1fc7433ecf9ead0e0cda0a274d75f2efb76b2d0be05d27b9ea5eb0b"},"/app/app/sockets/game-socket.ts":{"path":"/app/app/sockets/game-socket.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":35}},"2":{"start":{"line":4,"column":17},"end":{"line":4,"column":49}},"3":{"start":{"line":5,"column":0},"end":{"line":10,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":9,"column":7}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":60}},"6":{"start":{"line":8,"column":8},"end":{"line":8,"column":26}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":29}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":28},"end":{"line":5,"column":29}},"loc":{"start":{"line":5,"column":46},"end":{"line":10,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":22},"end":{"line":6,"column":23}},"loc":{"start":{"line":6,"column":38},"end":{"line":9,"column":5}},"line":6}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1},"f":{"0":0,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/sockets/game-socket.ts","sources":["/app/app/sockets/game-socket.ts"],"names":[],"mappings":";;AAAA,oCAAqC;AACrC,IAAM,UAAU,GAAG,QAAQ,CAAC,EAAC,IAAI,EAAE,YAAY,EAAC,CAAC,CAAC;AAClD,UAAU,CAAC,EAAE,CAAC,YAAY,EAAE,UAAC,MAAM;IACjC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAI;QACrB,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAuB,IAAM,CAAC,CAAC;QACpD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;IACnB,CAAC,CAAC,CAAA;AACJ,CAAC,CAAC,CAAC;AACH,kBAAe,UAAU,CAAA","sourcesContent":["import * as socketIo from 'socket.io'\nconst gameSocket = socketIo({path: '/chat/game'});\ngameSocket.on('connection', (socket) => {\n  socket.on('join', (room) => {\n    process.stdout.write(`connected to room - ${room}`);\n    socket.join(room)\n  })\n});\nexport default gameSocket\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ad3707ca837a80371dcd69421574f0d7def298f8","contentHash":"7abf9383e984f04a609cb0b42a24cef12cc8275cea59a4c0f6e19febfae8043e"},"/app/app/sockets/general-socket.ts":{"path":"/app/app/sockets/general-socket.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":35}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":55}},"3":{"start":{"line":5,"column":0},"end":{"line":9,"column":2}},"4":{"start":{"line":6,"column":4},"end":{"line":8,"column":5}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":59}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":25},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":50},"end":{"line":9,"column":1}},"line":5}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":4},"end":{"line":8,"column":5}},"type":"if","locations":[{"start":{"line":6,"column":4},"end":{"line":8,"column":5}},{"start":{"line":6,"column":4},"end":{"line":8,"column":5}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":1},"f":{"0":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/sockets/general-socket.ts","sources":["/app/app/sockets/general-socket.ts"],"names":[],"mappings":";;AAAA,oCAAqC;AACrC,IAAM,aAAa,GAAG,QAAQ,CAAC,EAAC,IAAI,EAAE,eAAe,EAAC,CAAC,CAAC;AACxD,aAAa,CAAC,QAAQ,GAAG,UAAC,aAAa;IACnC,IAAI,aAAa,EAAE;QACf,aAAa,CAAC,IAAI,CAAC,eAAe,EAAE,aAAa,CAAC,CAAC;KACtD;AACL,CAAC,CAAA;AACD,kBAAe,aAAa,CAAA","sourcesContent":["import * as socketIo from 'socket.io'\nconst generalSocket = socketIo({path: '/chat/general'});\ngeneralSocket.joinGame = (playersInGame) => {\n    if (playersInGame) {\n        generalSocket.emit('PLAYER_JOINED', playersInGame);\n    }\n}\nexport default generalSocket\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a47818c9d00de28340a7526aa260e2c6b1579697","contentHash":"baa895a6dca0a8e347a6b76fcb8773fd4af9d4e0af9d837a7171bd2d049ae4ed"},"/app/app/libs/passport.ts":{"path":"/app/app/libs/passport.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":15},"end":{"line":39,"column":38}},"68":{"start":{"line":40,"column":15},"end":{"line":40,"column":35}},"69":{"start":{"line":41,"column":21},"end":{"line":41,"column":47}},"70":{"start":{"line":42,"column":18},"end":{"line":42,"column":45}},"71":{"start":{"line":43,"column":21},"end":{"line":43,"column":55}},"72":{"start":{"line":44,"column":21},"end":{"line":44,"column":44}},"73":{"start":{"line":45,"column":0},"end":{"line":51,"column":4}},"74":{"start":{"line":50,"column":4},"end":{"line":50,"column":44}},"75":{"start":{"line":52,"column":0},"end":{"line":52,"column":18}},"76":{"start":{"line":54,"column":16},"end":{"line":54,"column":20}},"77":{"start":{"line":55,"column":15},"end":{"line":55,"column":17}},"78":{"start":{"line":56,"column":26},"end":{"line":63,"column":5}},"79":{"start":{"line":57,"column":8},"end":{"line":62,"column":9}},"80":{"start":{"line":58,"column":12},"end":{"line":58,"column":94}},"81":{"start":{"line":61,"column":12},"end":{"line":61,"column":25}},"82":{"start":{"line":64,"column":4},"end":{"line":64,"column":51}},"83":{"start":{"line":65,"column":4},"end":{"line":65,"column":42}},"84":{"start":{"line":66,"column":4},"end":{"line":79,"column":12}},"85":{"start":{"line":66,"column":64},"end":{"line":79,"column":7}},"86":{"start":{"line":68,"column":8},"end":{"line":78,"column":11}},"87":{"start":{"line":69,"column":12},"end":{"line":76,"column":13}},"88":{"start":{"line":70,"column":16},"end":{"line":70,"column":68}},"89":{"start":{"line":71,"column":16},"end":{"line":71,"column":54}},"90":{"start":{"line":72,"column":16},"end":{"line":72,"column":82}},"91":{"start":{"line":75,"column":16},"end":{"line":75,"column":55}},"92":{"start":{"line":77,"column":12},"end":{"line":77,"column":34}},"93":{"start":{"line":80,"column":4},"end":{"line":109,"column":12}},"94":{"start":{"line":80,"column":72},"end":{"line":109,"column":7}},"95":{"start":{"line":82,"column":8},"end":{"line":108,"column":11}},"96":{"start":{"line":83,"column":12},"end":{"line":107,"column":13}},"97":{"start":{"line":85,"column":20},"end":{"line":85,"column":46}},"98":{"start":{"line":86,"column":20},"end":{"line":86,"column":63}},"99":{"start":{"line":87,"column":20},"end":{"line":87,"column":90}},"100":{"start":{"line":89,"column":20},"end":{"line":89,"column":37}},"101":{"start":{"line":90,"column":20},"end":{"line":92,"column":21}},"102":{"start":{"line":91,"column":24},"end":{"line":91,"column":63}},"103":{"start":{"line":93,"column":20},"end":{"line":93,"column":85}},"104":{"start":{"line":95,"column":20},"end":{"line":95,"column":48}},"105":{"start":{"line":96,"column":20},"end":{"line":99,"column":22}},"106":{"start":{"line":100,"column":20},"end":{"line":100,"column":68}},"107":{"start":{"line":101,"column":20},"end":{"line":101,"column":79}},"108":{"start":{"line":102,"column":20},"end":{"line":102,"column":65}},"109":{"start":{"line":104,"column":20},"end":{"line":104,"column":36}},"110":{"start":{"line":105,"column":20},"end":{"line":105,"column":59}},"111":{"start":{"line":106,"column":24},"end":{"line":106,"column":46}},"112":{"start":{"line":111,"column":0},"end":{"line":111,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"(anonymous_13)","decl":{"start":{"line":49,"column":3},"end":{"line":49,"column":4}},"loc":{"start":{"line":49,"column":55},"end":{"line":51,"column":1}},"line":49},"14":{"name":"localStrategies","decl":{"start":{"line":53,"column":9},"end":{"line":53,"column":24}},"loc":{"start":{"line":53,"column":27},"end":{"line":110,"column":1}},"line":53},"15":{"name":"(anonymous_15)","decl":{"start":{"line":56,"column":26},"end":{"line":56,"column":27}},"loc":{"start":{"line":56,"column":41},"end":{"line":63,"column":5}},"line":56},"16":{"name":"(anonymous_16)","decl":{"start":{"line":66,"column":43},"end":{"line":66,"column":44}},"loc":{"start":{"line":66,"column":62},"end":{"line":79,"column":9}},"line":66},"17":{"name":"(anonymous_17)","decl":{"start":{"line":66,"column":104},"end":{"line":66,"column":105}},"loc":{"start":{"line":66,"column":116},"end":{"line":79,"column":5}},"line":66},"18":{"name":"(anonymous_18)","decl":{"start":{"line":68,"column":33},"end":{"line":68,"column":34}},"loc":{"start":{"line":68,"column":47},"end":{"line":78,"column":9}},"line":68},"19":{"name":"(anonymous_19)","decl":{"start":{"line":80,"column":51},"end":{"line":80,"column":52}},"loc":{"start":{"line":80,"column":70},"end":{"line":109,"column":9}},"line":80},"20":{"name":"(anonymous_20)","decl":{"start":{"line":80,"column":112},"end":{"line":80,"column":113}},"loc":{"start":{"line":80,"column":124},"end":{"line":109,"column":5}},"line":80},"21":{"name":"(anonymous_21)","decl":{"start":{"line":82,"column":33},"end":{"line":82,"column":34}},"loc":{"start":{"line":82,"column":47},"end":{"line":108,"column":9}},"line":82}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":83,"column":12},"end":{"line":107,"column":13}},"type":"switch","locations":[{"start":{"line":84,"column":16},"end":{"line":87,"column":90}},{"start":{"line":88,"column":16},"end":{"line":93,"column":85}},{"start":{"line":94,"column":16},"end":{"line":102,"column":65}},{"start":{"line":103,"column":16},"end":{"line":105,"column":59}},{"start":{"line":106,"column":16},"end":{"line":106,"column":46}}],"line":83},"30":{"loc":{"start":{"line":90,"column":20},"end":{"line":92,"column":21}},"type":"if","locations":[{"start":{"line":90,"column":20},"end":{"line":92,"column":21}},{"start":{"line":90,"column":20},"end":{"line":92,"column":21}}],"line":90}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":0,"75":1,"76":1,"77":1,"78":1,"79":0,"80":0,"81":0,"82":1,"83":1,"84":1,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0,0,0,0],"30":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/libs/passport.ts","sources":["/app/app/libs/passport.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Jwt from 'passport-jwt'\nimport * as passport from 'koa-passport'\nimport {_} from 'lodash'\nimport  * as userModel from '../db/queries/users'\nimport config from '../config'\nimport * as passportCustom from 'passport-custom';\nimport {IUser} from '../db/queries/interfaces/Iusers';\nimport * as authService from '../services/auth';\nimport authModel from '../db/queries/auth';\nimport * as GoogleStrategy from 'passport-google-oauth20'\nconst CustomStrategy = passportCustom.Strategy;\npassport.use('google', new GoogleStrategy.Strategy({\n        clientID: config.GOOGLE_CLIENT_ID,\n        clientSecret: config.GOOGLE_CLIENT_SECRET,\n        callbackURL: config.GOOGLE_REDIRECT_URI\n    },\n    (accessToken , refreshToken, profile, done) => {\n        return done(null, profile, accessToken);\n    }\n));\n\nlocalStrategies()\n\nfunction localStrategies() {\n    const opts: any = {};\n    const cookieExtractor = (ctx) => {\n        try {\n            return ctx.cookies.request.headers.cookie.split(';')[0].split('token=Bearer ')[1]\n        } catch (e) {\n            return false\n        }\n    };\n    opts.secretOrKey = config.JWT_SECRET;\n    opts.jwtFromRequest = cookieExtractor;\n\n    passport.use('jwt', new CustomStrategy(\n        async (req, cb) => {\n            try {\n                const token = req.ctx.cookie.token.replace('Bearer ', '');\n                const user = authService.verifyToken(token);\n                return cb(null, {id: user.id, name: user.name});\n            } catch (e) {\n                return cb(null, false);\n            }\n        }\n    ));\n    passport.use('jwt-refresh', new CustomStrategy(\n        async (req, cb) => {\n            try {\n                const refreshToken = req.ctx.cookie.refreshToken;\n                const user: IUser = await authService.getUserByRefreshToken(refreshToken);\n                if(!user) {\n                    return cb(null, false)\n                }\n                const newRefreshToken = await authService.createJWTRefreshToken(user.id);\n                const userPayload = {\n                    id: user.id,\n                    name: user[user.type].name\n                };\n                const token = authService.createJWTToken(userPayload);\n                authService.setAuthTokens(token, newRefreshToken, req.ctx)\n                return cb(null, userPayload);\n            } catch (e) {\n                return cb(null, false);\n            }\n        }\n    ));\n}\n\nexport default passport\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1eaaac01ade2de3f161d869287a96a3e39ba312a","contentHash":"2b69f43f32acb74a68c380c01778672729c2b455041abc964d6d048465d12b3d"},"/app/app/services/auth.ts":{"path":"/app/app/services/auth.ts","statementMap":{"0":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":10,"column":6}},"2":{"start":{"line":4,"column":8},"end":{"line":8,"column":9}},"3":{"start":{"line":4,"column":24},"end":{"line":4,"column":25}},"4":{"start":{"line":4,"column":31},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"6":{"start":{"line":6,"column":12},"end":{"line":7,"column":28}},"7":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"8":{"start":{"line":7,"column":16},"end":{"line":7,"column":28}},"9":{"start":{"line":9,"column":8},"end":{"line":9,"column":17}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":43}},"11":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"12":{"start":{"line":14,"column":28},"end":{"line":14,"column":110}},"13":{"start":{"line":14,"column":91},"end":{"line":14,"column":106}},"14":{"start":{"line":15,"column":4},"end":{"line":20,"column":7}},"15":{"start":{"line":16,"column":36},"end":{"line":16,"column":97}},"16":{"start":{"line":16,"column":42},"end":{"line":16,"column":70}},"17":{"start":{"line":16,"column":85},"end":{"line":16,"column":95}},"18":{"start":{"line":17,"column":35},"end":{"line":17,"column":100}},"19":{"start":{"line":17,"column":41},"end":{"line":17,"column":73}},"20":{"start":{"line":17,"column":88},"end":{"line":17,"column":98}},"21":{"start":{"line":18,"column":32},"end":{"line":18,"column":116}},"22":{"start":{"line":19,"column":8},"end":{"line":19,"column":78}},"23":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"24":{"start":{"line":23,"column":12},"end":{"line":23,"column":104}},"25":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"26":{"start":{"line":23,"column":57},"end":{"line":23,"column":68}},"27":{"start":{"line":23,"column":69},"end":{"line":23,"column":81}},"28":{"start":{"line":24,"column":4},"end":{"line":24,"column":157}},"29":{"start":{"line":24,"column":138},"end":{"line":24,"column":150}},"30":{"start":{"line":25,"column":23},"end":{"line":25,"column":68}},"31":{"start":{"line":25,"column":45},"end":{"line":25,"column":65}},"32":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"33":{"start":{"line":27,"column":15},"end":{"line":27,"column":70}},"34":{"start":{"line":28,"column":8},"end":{"line":45,"column":66}},"35":{"start":{"line":28,"column":18},"end":{"line":45,"column":66}},"36":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"37":{"start":{"line":29,"column":160},"end":{"line":29,"column":169}},"38":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"39":{"start":{"line":30,"column":26},"end":{"line":30,"column":52}},"40":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"41":{"start":{"line":32,"column":32},"end":{"line":32,"column":39}},"42":{"start":{"line":32,"column":40},"end":{"line":32,"column":46}},"43":{"start":{"line":33,"column":24},"end":{"line":33,"column":34}},"44":{"start":{"line":33,"column":35},"end":{"line":33,"column":72}},"45":{"start":{"line":34,"column":24},"end":{"line":34,"column":34}},"46":{"start":{"line":34,"column":35},"end":{"line":34,"column":45}},"47":{"start":{"line":34,"column":46},"end":{"line":34,"column":55}},"48":{"start":{"line":34,"column":56},"end":{"line":34,"column":65}},"49":{"start":{"line":35,"column":24},"end":{"line":35,"column":41}},"50":{"start":{"line":35,"column":42},"end":{"line":35,"column":55}},"51":{"start":{"line":35,"column":56},"end":{"line":35,"column":65}},"52":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"53":{"start":{"line":37,"column":110},"end":{"line":37,"column":116}},"54":{"start":{"line":37,"column":117},"end":{"line":37,"column":126}},"55":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"56":{"start":{"line":38,"column":81},"end":{"line":38,"column":97}},"57":{"start":{"line":38,"column":98},"end":{"line":38,"column":104}},"58":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"59":{"start":{"line":39,"column":57},"end":{"line":39,"column":72}},"60":{"start":{"line":39,"column":73},"end":{"line":39,"column":80}},"61":{"start":{"line":39,"column":81},"end":{"line":39,"column":87}},"62":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"63":{"start":{"line":40,"column":47},"end":{"line":40,"column":62}},"64":{"start":{"line":40,"column":63},"end":{"line":40,"column":78}},"65":{"start":{"line":40,"column":79},"end":{"line":40,"column":85}},"66":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"67":{"start":{"line":41,"column":30},"end":{"line":41,"column":42}},"68":{"start":{"line":42,"column":20},"end":{"line":42,"column":33}},"69":{"start":{"line":42,"column":34},"end":{"line":42,"column":43}},"70":{"start":{"line":44,"column":12},"end":{"line":44,"column":39}},"71":{"start":{"line":45,"column":22},"end":{"line":45,"column":34}},"72":{"start":{"line":45,"column":35},"end":{"line":45,"column":41}},"73":{"start":{"line":45,"column":54},"end":{"line":45,"column":64}},"74":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"75":{"start":{"line":46,"column":23},"end":{"line":46,"column":35}},"76":{"start":{"line":46,"column":36},"end":{"line":46,"column":89}},"77":{"start":{"line":49,"column":0},"end":{"line":49,"column":62}},"78":{"start":{"line":50,"column":0},"end":{"line":50,"column":23}},"79":{"start":{"line":51,"column":0},"end":{"line":51,"column":31}},"80":{"start":{"line":52,"column":15},"end":{"line":52,"column":35}},"81":{"start":{"line":53,"column":15},"end":{"line":53,"column":34}},"82":{"start":{"line":54,"column":16},"end":{"line":54,"column":46}},"83":{"start":{"line":55,"column":10},"end":{"line":55,"column":33}},"84":{"start":{"line":56,"column":13},"end":{"line":56,"column":42}},"85":{"start":{"line":57,"column":13},"end":{"line":57,"column":28}},"86":{"start":{"line":58,"column":15},"end":{"line":58,"column":44}},"87":{"start":{"line":60,"column":4},"end":{"line":60,"column":57}},"88":{"start":{"line":62,"column":0},"end":{"line":62,"column":54}},"89":{"start":{"line":64,"column":4},"end":{"line":71,"column":7}},"90":{"start":{"line":65,"column":8},"end":{"line":70,"column":11}},"91":{"start":{"line":66,"column":12},"end":{"line":69,"column":13}},"92":{"start":{"line":67,"column":24},"end":{"line":67,"column":85}},"93":{"start":{"line":68,"column":24},"end":{"line":68,"column":57}},"94":{"start":{"line":74,"column":13},"end":{"line":74,"column":18}},"95":{"start":{"line":74,"column":27},"end":{"line":74,"column":34}},"96":{"start":{"line":75,"column":4},"end":{"line":75,"column":105}},"97":{"start":{"line":77,"column":0},"end":{"line":77,"column":40}},"98":{"start":{"line":79,"column":4},"end":{"line":92,"column":7}},"99":{"start":{"line":81,"column":8},"end":{"line":91,"column":11}},"100":{"start":{"line":82,"column":12},"end":{"line":90,"column":13}},"101":{"start":{"line":84,"column":20},"end":{"line":84,"column":37}},"102":{"start":{"line":85,"column":20},"end":{"line":85,"column":135}},"103":{"start":{"line":86,"column":20},"end":{"line":86,"column":95}},"104":{"start":{"line":88,"column":20},"end":{"line":88,"column":30}},"105":{"start":{"line":89,"column":20},"end":{"line":89,"column":49}},"106":{"start":{"line":94,"column":0},"end":{"line":94,"column":54}},"107":{"start":{"line":96,"column":4},"end":{"line":106,"column":7}},"108":{"start":{"line":98,"column":8},"end":{"line":105,"column":11}},"109":{"start":{"line":99,"column":12},"end":{"line":104,"column":13}},"110":{"start":{"line":101,"column":20},"end":{"line":101,"column":51}},"111":{"start":{"line":102,"column":20},"end":{"line":102,"column":72}},"112":{"start":{"line":103,"column":24},"end":{"line":103,"column":57}},"113":{"start":{"line":108,"column":0},"end":{"line":108,"column":36}},"114":{"start":{"line":110,"column":4},"end":{"line":121,"column":7}},"115":{"start":{"line":112,"column":8},"end":{"line":120,"column":11}},"116":{"start":{"line":113,"column":12},"end":{"line":119,"column":13}},"117":{"start":{"line":114,"column":24},"end":{"line":114,"column":86}},"118":{"start":{"line":116,"column":20},"end":{"line":116,"column":50}},"119":{"start":{"line":117,"column":20},"end":{"line":117,"column":75}},"120":{"start":{"line":118,"column":24},"end":{"line":118,"column":57}},"121":{"start":{"line":123,"column":0},"end":{"line":123,"column":54}},"122":{"start":{"line":125,"column":4},"end":{"line":125,"column":40}},"123":{"start":{"line":126,"column":4},"end":{"line":126,"column":48}},"124":{"start":{"line":127,"column":4},"end":{"line":127,"column":50}},"125":{"start":{"line":129,"column":0},"end":{"line":129,"column":38}},"126":{"start":{"line":131,"column":15},"end":{"line":131,"column":60}},"127":{"start":{"line":132,"column":4},"end":{"line":132,"column":35}},"128":{"start":{"line":134,"column":0},"end":{"line":134,"column":32}},"129":{"start":{"line":136,"column":4},"end":{"line":149,"column":7}},"130":{"start":{"line":138,"column":8},"end":{"line":148,"column":11}},"131":{"start":{"line":139,"column":12},"end":{"line":147,"column":13}},"132":{"start":{"line":141,"column":20},"end":{"line":141,"column":88}},"133":{"start":{"line":142,"column":20},"end":{"line":142,"column":73}},"134":{"start":{"line":144,"column":20},"end":{"line":144,"column":45}},"135":{"start":{"line":145,"column":20},"end":{"line":145,"column":60}},"136":{"start":{"line":146,"column":20},"end":{"line":146,"column":42}},"137":{"start":{"line":151,"column":0},"end":{"line":151,"column":44}},"138":{"start":{"line":153,"column":4},"end":{"line":153,"column":57}},"139":{"start":{"line":155,"column":0},"end":{"line":155,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":42},"end":{"line":2,"column":43}},"loc":{"start":{"line":2,"column":54},"end":{"line":12,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":3,"column":32},"end":{"line":3,"column":33}},"loc":{"start":{"line":3,"column":44},"end":{"line":10,"column":5}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":44},"end":{"line":13,"column":45}},"loc":{"start":{"line":13,"column":89},"end":{"line":21,"column":1}},"line":13},"3":{"name":"adopt","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":18}},"loc":{"start":{"line":14,"column":26},"end":{"line":14,"column":112}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":70},"end":{"line":14,"column":71}},"loc":{"start":{"line":14,"column":89},"end":{"line":14,"column":108}},"line":14},"5":{"name":"(anonymous_5)","decl":{"start":{"line":15,"column":36},"end":{"line":15,"column":37}},"loc":{"start":{"line":15,"column":63},"end":{"line":20,"column":5}},"line":15},"6":{"name":"fulfilled","decl":{"start":{"line":16,"column":17},"end":{"line":16,"column":26}},"loc":{"start":{"line":16,"column":34},"end":{"line":16,"column":99}},"line":16},"7":{"name":"rejected","decl":{"start":{"line":17,"column":17},"end":{"line":17,"column":25}},"loc":{"start":{"line":17,"column":33},"end":{"line":17,"column":102}},"line":17},"8":{"name":"step","decl":{"start":{"line":18,"column":17},"end":{"line":18,"column":21}},"loc":{"start":{"line":18,"column":30},"end":{"line":18,"column":118}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":48},"end":{"line":22,"column":49}},"loc":{"start":{"line":22,"column":73},"end":{"line":48,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":30},"end":{"line":23,"column":31}},"loc":{"start":{"line":23,"column":41},"end":{"line":23,"column":83}},"line":23},"11":{"name":"(anonymous_11)","decl":{"start":{"line":24,"column":125},"end":{"line":24,"column":126}},"loc":{"start":{"line":24,"column":136},"end":{"line":24,"column":152}},"line":24},"12":{"name":"verb","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":17}},"loc":{"start":{"line":25,"column":21},"end":{"line":25,"column":70}},"line":25},"13":{"name":"(anonymous_13)","decl":{"start":{"line":25,"column":30},"end":{"line":25,"column":31}},"loc":{"start":{"line":25,"column":43},"end":{"line":25,"column":67}},"line":25},"14":{"name":"step","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":17}},"loc":{"start":{"line":26,"column":22},"end":{"line":47,"column":5}},"line":26},"15":{"name":"sendConfirmationEmail","decl":{"start":{"line":59,"column":9},"end":{"line":59,"column":30}},"loc":{"start":{"line":59,"column":38},"end":{"line":61,"column":1}},"line":59},"16":{"name":"storeJWTRefreshToken","decl":{"start":{"line":63,"column":9},"end":{"line":63,"column":29}},"loc":{"start":{"line":63,"column":36},"end":{"line":72,"column":1}},"line":63},"17":{"name":"(anonymous_17)","decl":{"start":{"line":64,"column":43},"end":{"line":64,"column":44}},"loc":{"start":{"line":64,"column":55},"end":{"line":71,"column":5}},"line":64},"18":{"name":"(anonymous_18)","decl":{"start":{"line":65,"column":33},"end":{"line":65,"column":34}},"loc":{"start":{"line":65,"column":47},"end":{"line":70,"column":9}},"line":65},"19":{"name":"createJWTToken","decl":{"start":{"line":73,"column":9},"end":{"line":73,"column":23}},"loc":{"start":{"line":73,"column":28},"end":{"line":76,"column":1}},"line":73},"20":{"name":"createJWTRefreshToken","decl":{"start":{"line":78,"column":9},"end":{"line":78,"column":30}},"loc":{"start":{"line":78,"column":39},"end":{"line":93,"column":1}},"line":78},"21":{"name":"(anonymous_21)","decl":{"start":{"line":79,"column":43},"end":{"line":79,"column":44}},"loc":{"start":{"line":79,"column":55},"end":{"line":92,"column":5}},"line":79},"22":{"name":"(anonymous_22)","decl":{"start":{"line":81,"column":33},"end":{"line":81,"column":34}},"loc":{"start":{"line":81,"column":47},"end":{"line":91,"column":9}},"line":81},"23":{"name":"confirmEmail","decl":{"start":{"line":95,"column":9},"end":{"line":95,"column":21}},"loc":{"start":{"line":95,"column":28},"end":{"line":107,"column":1}},"line":95},"24":{"name":"(anonymous_24)","decl":{"start":{"line":96,"column":43},"end":{"line":96,"column":44}},"loc":{"start":{"line":96,"column":55},"end":{"line":106,"column":5}},"line":96},"25":{"name":"(anonymous_25)","decl":{"start":{"line":98,"column":33},"end":{"line":98,"column":34}},"loc":{"start":{"line":98,"column":47},"end":{"line":105,"column":9}},"line":98},"26":{"name":"getUserByRefreshToken","decl":{"start":{"line":109,"column":9},"end":{"line":109,"column":30}},"loc":{"start":{"line":109,"column":38},"end":{"line":122,"column":1}},"line":109},"27":{"name":"(anonymous_27)","decl":{"start":{"line":110,"column":43},"end":{"line":110,"column":44}},"loc":{"start":{"line":110,"column":55},"end":{"line":121,"column":5}},"line":110},"28":{"name":"(anonymous_28)","decl":{"start":{"line":112,"column":33},"end":{"line":112,"column":34}},"loc":{"start":{"line":112,"column":47},"end":{"line":120,"column":9}},"line":112},"29":{"name":"setAuthTokens","decl":{"start":{"line":124,"column":9},"end":{"line":124,"column":22}},"loc":{"start":{"line":124,"column":49},"end":{"line":128,"column":1}},"line":124},"30":{"name":"hashObject","decl":{"start":{"line":130,"column":9},"end":{"line":130,"column":19}},"loc":{"start":{"line":130,"column":25},"end":{"line":133,"column":1}},"line":130},"31":{"name":"authenticateUser","decl":{"start":{"line":135,"column":9},"end":{"line":135,"column":25}},"loc":{"start":{"line":135,"column":37},"end":{"line":150,"column":1}},"line":135},"32":{"name":"(anonymous_32)","decl":{"start":{"line":136,"column":43},"end":{"line":136,"column":44}},"loc":{"start":{"line":136,"column":55},"end":{"line":149,"column":5}},"line":136},"33":{"name":"(anonymous_33)","decl":{"start":{"line":138,"column":33},"end":{"line":138,"column":34}},"loc":{"start":{"line":138,"column":47},"end":{"line":148,"column":9}},"line":138},"34":{"name":"verifyToken","decl":{"start":{"line":152,"column":9},"end":{"line":152,"column":20}},"loc":{"start":{"line":152,"column":27},"end":{"line":154,"column":1}},"line":152}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":16},"end":{"line":2,"column":20}},{"start":{"line":2,"column":24},"end":{"line":2,"column":37}},{"start":{"line":2,"column":42},"end":{"line":12,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":15},"end":{"line":10,"column":5}},"type":"binary-expr","locations":[{"start":{"line":3,"column":15},"end":{"line":3,"column":28}},{"start":{"line":3,"column":32},"end":{"line":10,"column":5}}],"line":3},"2":{"loc":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"type":"if","locations":[{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},{"start":{"line":6,"column":29},"end":{"line":7,"column":28}}],"line":6},"3":{"loc":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":13,"column":17},"end":{"line":13,"column":21}},{"start":{"line":13,"column":25},"end":{"line":13,"column":39}},{"start":{"line":13,"column":44},"end":{"line":21,"column":1}}],"line":13},"4":{"loc":{"start":{"line":14,"column":35},"end":{"line":14,"column":109}},"type":"cond-expr","locations":[{"start":{"line":14,"column":56},"end":{"line":14,"column":61}},{"start":{"line":14,"column":64},"end":{"line":14,"column":109}}],"line":14},"5":{"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":34}},"type":"binary-expr","locations":[{"start":{"line":15,"column":16},"end":{"line":15,"column":17}},{"start":{"line":15,"column":22},"end":{"line":15,"column":33}}],"line":15},"6":{"loc":{"start":{"line":18,"column":32},"end":{"line":18,"column":115}},"type":"cond-expr","locations":[{"start":{"line":18,"column":46},"end":{"line":18,"column":67}},{"start":{"line":18,"column":70},"end":{"line":18,"column":115}}],"line":18},"7":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":67}},"type":"binary-expr","locations":[{"start":{"line":19,"column":51},"end":{"line":19,"column":61}},{"start":{"line":19,"column":65},"end":{"line":19,"column":67}}],"line":19},"8":{"loc":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":19},"end":{"line":22,"column":23}},{"start":{"line":22,"column":27},"end":{"line":22,"column":43}},{"start":{"line":22,"column":48},"end":{"line":48,"column":1}}],"line":22},"9":{"loc":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"type":"if","locations":[{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},{"start":{"line":23,"column":43},"end":{"line":23,"column":68}}],"line":23},"10":{"loc":{"start":{"line":24,"column":71},"end":{"line":24,"column":153}},"type":"binary-expr","locations":[{"start":{"line":24,"column":71},"end":{"line":24,"column":99}},{"start":{"line":24,"column":104},"end":{"line":24,"column":152}}],"line":24},"11":{"loc":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},{"start":{"line":27,"column":8},"end":{"line":27,"column":70}}],"line":27},"12":{"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},{"start":{"line":29,"column":12},"end":{"line":29,"column":169}}],"line":29},"13":{"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":158}},"type":"binary-expr","locations":[{"start":{"line":29,"column":23},"end":{"line":29,"column":24}},{"start":{"line":29,"column":29},"end":{"line":29,"column":125}},{"start":{"line":29,"column":130},"end":{"line":29,"column":158}}],"line":29},"14":{"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":45},"end":{"line":29,"column":56}},{"start":{"line":29,"column":59},"end":{"line":29,"column":125}}],"line":29},"15":{"loc":{"start":{"line":29,"column":59},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},{"start":{"line":29,"column":119},"end":{"line":29,"column":125}}],"line":29},"16":{"loc":{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},"type":"binary-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":77}},{"start":{"line":29,"column":82},"end":{"line":29,"column":115}}],"line":29},"17":{"loc":{"start":{"line":29,"column":82},"end":{"line":29,"column":112}},"type":"binary-expr","locations":[{"start":{"line":29,"column":83},"end":{"line":29,"column":98}},{"start":{"line":29,"column":103},"end":{"line":29,"column":112}}],"line":29},"18":{"loc":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"type":"if","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},{"start":{"line":30,"column":12},"end":{"line":30,"column":52}}],"line":30},"19":{"loc":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"type":"switch","locations":[{"start":{"line":32,"column":16},"end":{"line":32,"column":23}},{"start":{"line":32,"column":24},"end":{"line":32,"column":46}},{"start":{"line":33,"column":16},"end":{"line":33,"column":72}},{"start":{"line":34,"column":16},"end":{"line":34,"column":65}},{"start":{"line":35,"column":16},"end":{"line":35,"column":65}},{"start":{"line":36,"column":16},"end":{"line":42,"column":43}}],"line":31},"20":{"loc":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"type":"if","locations":[{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},{"start":{"line":37,"column":20},"end":{"line":37,"column":128}}],"line":37},"21":{"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":106}},"type":"binary-expr","locations":[{"start":{"line":37,"column":24},"end":{"line":37,"column":74}},{"start":{"line":37,"column":79},"end":{"line":37,"column":90}},{"start":{"line":37,"column":94},"end":{"line":37,"column":105}}],"line":37},"22":{"loc":{"start":{"line":37,"column":42},"end":{"line":37,"column":73}},"type":"binary-expr","locations":[{"start":{"line":37,"column":42},"end":{"line":37,"column":54}},{"start":{"line":37,"column":58},"end":{"line":37,"column":73}}],"line":37},"23":{"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"type":"if","locations":[{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},{"start":{"line":38,"column":20},"end":{"line":38,"column":106}}],"line":38},"24":{"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":77}},"type":"binary-expr","locations":[{"start":{"line":38,"column":24},"end":{"line":38,"column":35}},{"start":{"line":38,"column":40},"end":{"line":38,"column":42}},{"start":{"line":38,"column":47},"end":{"line":38,"column":59}},{"start":{"line":38,"column":63},"end":{"line":38,"column":75}}],"line":38},"25":{"loc":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"type":"if","locations":[{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},{"start":{"line":39,"column":20},"end":{"line":39,"column":89}}],"line":39},"26":{"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":53}},"type":"binary-expr","locations":[{"start":{"line":39,"column":24},"end":{"line":39,"column":35}},{"start":{"line":39,"column":39},"end":{"line":39,"column":53}}],"line":39},"27":{"loc":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"type":"if","locations":[{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},{"start":{"line":40,"column":20},"end":{"line":40,"column":87}}],"line":40},"28":{"loc":{"start":{"line":40,"column":24},"end":{"line":40,"column":43}},"type":"binary-expr","locations":[{"start":{"line":40,"column":24},"end":{"line":40,"column":25}},{"start":{"line":40,"column":29},"end":{"line":40,"column":43}}],"line":40},"29":{"loc":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"type":"if","locations":[{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},{"start":{"line":41,"column":20},"end":{"line":41,"column":42}}],"line":41},"30":{"loc":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},{"start":{"line":46,"column":8},"end":{"line":46,"column":35}}],"line":46},"31":{"loc":{"start":{"line":46,"column":52},"end":{"line":46,"column":74}},"type":"cond-expr","locations":[{"start":{"line":46,"column":60},"end":{"line":46,"column":65}},{"start":{"line":46,"column":68},"end":{"line":46,"column":74}}],"line":46},"32":{"loc":{"start":{"line":66,"column":12},"end":{"line":69,"column":13}},"type":"switch","locations":[{"start":{"line":67,"column":16},"end":{"line":67,"column":85}},{"start":{"line":68,"column":16},"end":{"line":68,"column":57}}],"line":66},"33":{"loc":{"start":{"line":82,"column":12},"end":{"line":90,"column":13}},"type":"switch","locations":[{"start":{"line":83,"column":16},"end":{"line":86,"column":95}},{"start":{"line":87,"column":16},"end":{"line":89,"column":49}}],"line":82},"34":{"loc":{"start":{"line":99,"column":12},"end":{"line":104,"column":13}},"type":"switch","locations":[{"start":{"line":100,"column":16},"end":{"line":102,"column":72}},{"start":{"line":103,"column":16},"end":{"line":103,"column":57}}],"line":99},"35":{"loc":{"start":{"line":113,"column":12},"end":{"line":119,"column":13}},"type":"switch","locations":[{"start":{"line":114,"column":16},"end":{"line":114,"column":86}},{"start":{"line":115,"column":16},"end":{"line":117,"column":75}},{"start":{"line":118,"column":16},"end":{"line":118,"column":57}}],"line":113},"36":{"loc":{"start":{"line":139,"column":12},"end":{"line":147,"column":13}},"type":"switch","locations":[{"start":{"line":140,"column":16},"end":{"line":142,"column":73}},{"start":{"line":143,"column":16},"end":{"line":146,"column":42}}],"line":139}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":0,"88":1,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":1,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":1,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":1,"122":0,"123":0,"124":0,"125":1,"126":0,"127":0,"128":1,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":1,"138":0,"139":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[1,1,1],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0,0,0],"20":[0,0],"21":[0,0,0],"22":[0,0],"23":[0,0],"24":[0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0,0],"36":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/services/auth.ts","sources":["/app/app/services/auth.ts"],"names":[],"mappings":"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","sourcesContent":["export const JWT_TTL = '5m'\nexport const JWT_REFRESH_TTL = '7d'\nimport {_} from 'lodash'\nimport config from '../config'\nimport {decrypt} from './crypto'\nimport * as userModel from '../db/queries/users'\nimport * as jwt from 'jsonwebtoken'\nimport authModel from '../db/queries/auth'\nimport {IUser} from '../db/queries/interfaces/Iusers'\nimport { v1 as uuidv1 } from 'uuid'\nimport mailer from '../services/mailer'\n\nexport function sendConfirmationEmail(email: string) {\n  return mailer.sendConfirmationEmail(email)\n}\nasync function storeJWTRefreshToken(data) {\n  return await authModel.storeRefreshToken(data)\n}\nexport function createJWTToken({id, name}) {\n  return jwt.sign({id, name}, config.JWT_SECRET, { expiresIn: JWT_TTL })\n}\nexport async function createJWTRefreshToken(userId: number): Promise<string> {\n  const id = uuidv1();\n  const token = jwt.sign({id, user_id: userId}, config.JWT_SECRET, { expiresIn: JWT_REFRESH_TTL });\n  await storeJWTRefreshToken({id: token, user_id: userId});\n  return token\n}\nexport async function confirmEmail(hash: string): Promise<IUser> {\n  const email = decrypt(hash);\n  return await userModel.confirmEmail(email)\n}\nexport async function getUserByRefreshToken(token: string): Promise<IUser> {\n  const {user_id} = await authModel.checkRefreshToken(token);\n  return await userModel.getSingleUser(user_id)\n}\nexport function setAuthTokens(token, refreshToken, ctx) {\n  ctx.cookies.set('date', Date.now());\n  ctx.cookies.set('token', `Bearer ${token}`);\n  ctx.cookies.set('refreshToken', refreshToken);\n}\nexport function hashObject(obj: any): string {\n  const buff = new Buffer(JSON.stringify({...obj}));\n  return buff.toString('base64');\n}\nexport async function authenticateUser(user: IUser, ctx): Promise<void> {\n  const token = createJWTToken({id: user.id, name: user[user.type].name});\n  const refreshToken = await createJWTRefreshToken(user.id);\n  setAuthTokens(token, refreshToken, ctx);\n}\nexport function verifyToken(hash): {id: string, name: string} {\n  return jwt.verify(hash, config.JWT_SECRET);\n}\n\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"872c2094e9551b3eea42fa08795ea14934d40806","contentHash":"8fac0b9c465abf3ff1abfc24ee24ffb5fd7a1bd3314c7ab45321373b95986099"},"/app/app/services/crypto.ts":{"path":"/app/app/services/crypto.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":30}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":29}},"3":{"start":{"line":5,"column":15},"end":{"line":5,"column":23}},"4":{"start":{"line":11,"column":17},"end":{"line":11,"column":57}},"5":{"start":{"line":12,"column":18},"end":{"line":12,"column":52}},"6":{"start":{"line":13,"column":4},"end":{"line":13,"column":35}},"7":{"start":{"line":14,"column":4},"end":{"line":14,"column":19}},"8":{"start":{"line":16,"column":0},"end":{"line":16,"column":26}},"9":{"start":{"line":22,"column":19},"end":{"line":22,"column":61}},"10":{"start":{"line":23,"column":14},"end":{"line":23,"column":50}},"11":{"start":{"line":24,"column":4},"end":{"line":24,"column":34}},"12":{"start":{"line":25,"column":4},"end":{"line":25,"column":15}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":26}}},"fnMap":{"0":{"name":"encrypt","decl":{"start":{"line":10,"column":9},"end":{"line":10,"column":16}},"loc":{"start":{"line":10,"column":23},"end":{"line":15,"column":1}},"line":10},"1":{"name":"decrypt","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":16}},"loc":{"start":{"line":21,"column":23},"end":{"line":26,"column":1}},"line":21}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":1},"f":{"0":1,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/services/crypto.ts","sources":["/app/app/services/crypto.ts"],"names":[],"mappings":";;AAAA,IAAM,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;AACjC,IAAM,SAAS,GAAG,aAAa,CAAC;AAChC,IAAM,QAAQ,GAAG,QAAQ,CAAC;AAE1B;;;GAGG;AACH,SAAS,OAAO,CAAC,IAAI;IACnB,IAAM,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAA;IACvD,IAAI,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,MAAM,EAAE,KAAK,CAAC,CAAA;IAChD,OAAO,IAAI,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAC/B,OAAO,OAAO,CAAC;AACjB,CAAC;AAcC,0BAAO;AAZT;;;GAGG;AACH,SAAS,OAAO,CAAC,IAAI;IACnB,IAAM,QAAQ,GAAG,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAA;IAC3D,IAAI,GAAG,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE,MAAM,CAAC,CAAA;IAC9C,GAAG,IAAI,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IAC9B,OAAO,GAAG,CAAC;AACb,CAAC;AAIC,0BAAO","sourcesContent":["const crypto = require('crypto');\nconst algorithm = 'aes-256-ctr';\nconst password = 'qwewqe';\n\n/**\n * @param {string} text\n * @return {string}\n */\nfunction encrypt(text) {\n  const cipher = crypto.createCipher(algorithm, password)\n  let crypted = cipher.update(text, 'utf8', 'hex')\n  crypted += cipher.final('hex');\n  return crypted;\n}\n\n/**\n * @param {string} text\n * @return {string}\n */\nfunction decrypt(text) {\n  const decipher = crypto.createDecipher(algorithm, password)\n  let dec = decipher.update(text, 'hex', 'utf8')\n  dec += decipher.final('utf8');\n  return dec;\n}\n\nexport {\n  encrypt,\n  decrypt,\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8332792b500c73affc58e187f4cd8fb54f110092","contentHash":"f8c9e446d31d35b9a0083ab2ebad534f19bfcbbd2867c3ac05d50f0d93eabb91"},"/app/app/db/queries/users.ts":{"path":"/app/app/db/queries/users.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":13},"end":{"line":39,"column":32}},"68":{"start":{"line":40,"column":13},"end":{"line":40,"column":39}},"69":{"start":{"line":41,"column":15},"end":{"line":41,"column":48}},"70":{"start":{"line":43,"column":4},"end":{"line":46,"column":17}},"71":{"start":{"line":48,"column":0},"end":{"line":48,"column":38}},"72":{"start":{"line":50,"column":4},"end":{"line":53,"column":7}},"73":{"start":{"line":51,"column":19},"end":{"line":51,"column":26}},"74":{"start":{"line":52,"column":8},"end":{"line":52,"column":23}},"75":{"start":{"line":55,"column":0},"end":{"line":55,"column":36}},"76":{"start":{"line":57,"column":4},"end":{"line":60,"column":49}},"77":{"start":{"line":60,"column":31},"end":{"line":60,"column":45}},"78":{"start":{"line":62,"column":0},"end":{"line":62,"column":52}},"79":{"start":{"line":64,"column":4},"end":{"line":75,"column":70}},"80":{"start":{"line":75,"column":31},"end":{"line":75,"column":45}},"81":{"start":{"line":77,"column":0},"end":{"line":77,"column":42}},"82":{"start":{"line":79,"column":4},"end":{"line":82,"column":49}},"83":{"start":{"line":82,"column":31},"end":{"line":82,"column":45}},"84":{"start":{"line":84,"column":0},"end":{"line":84,"column":52}},"85":{"start":{"line":86,"column":4},"end":{"line":111,"column":7}},"86":{"start":{"line":88,"column":8},"end":{"line":110,"column":11}},"87":{"start":{"line":89,"column":12},"end":{"line":109,"column":13}},"88":{"start":{"line":90,"column":24},"end":{"line":90,"column":79}},"89":{"start":{"line":92,"column":20},"end":{"line":92,"column":34}},"90":{"start":{"line":93,"column":20},"end":{"line":95,"column":21}},"91":{"start":{"line":94,"column":24},"end":{"line":94,"column":54}},"92":{"start":{"line":96,"column":20},"end":{"line":96,"column":55}},"93":{"start":{"line":97,"column":20},"end":{"line":108,"column":70}},"94":{"start":{"line":108,"column":51},"end":{"line":108,"column":65}},"95":{"start":{"line":113,"column":0},"end":{"line":113,"column":36}},"96":{"start":{"line":115,"column":4},"end":{"line":115,"column":190}},"97":{"start":{"line":117,"column":0},"end":{"line":117,"column":50}},"98":{"start":{"line":119,"column":4},"end":{"line":119,"column":60}},"99":{"start":{"line":120,"column":4},"end":{"line":123,"column":38}},"100":{"start":{"line":125,"column":0},"end":{"line":125,"column":32}},"101":{"start":{"line":127,"column":4},"end":{"line":128,"column":20}},"102":{"start":{"line":128,"column":8},"end":{"line":128,"column":20}},"103":{"start":{"line":129,"column":15},"end":{"line":129,"column":35}},"104":{"start":{"line":130,"column":4},"end":{"line":130,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"getSingleUser","decl":{"start":{"line":42,"column":9},"end":{"line":42,"column":22}},"loc":{"start":{"line":42,"column":27},"end":{"line":47,"column":1}},"line":42},"14":{"name":"confirmEmail","decl":{"start":{"line":49,"column":9},"end":{"line":49,"column":21}},"loc":{"start":{"line":49,"column":29},"end":{"line":54,"column":1}},"line":49},"15":{"name":"(anonymous_15)","decl":{"start":{"line":50,"column":215},"end":{"line":50,"column":216}},"loc":{"start":{"line":50,"column":229},"end":{"line":53,"column":5}},"line":50},"16":{"name":"getGoogleUserByEmail","decl":{"start":{"line":56,"column":9},"end":{"line":56,"column":29}},"loc":{"start":{"line":56,"column":37},"end":{"line":61,"column":1}},"line":56},"17":{"name":"(anonymous_17)","decl":{"start":{"line":60,"column":14},"end":{"line":60,"column":15}},"loc":{"start":{"line":60,"column":29},"end":{"line":60,"column":47}},"line":60},"18":{"name":"storeGoogleUser","decl":{"start":{"line":63,"column":9},"end":{"line":63,"column":24}},"loc":{"start":{"line":63,"column":31},"end":{"line":76,"column":1}},"line":63},"19":{"name":"(anonymous_19)","decl":{"start":{"line":75,"column":14},"end":{"line":75,"column":15}},"loc":{"start":{"line":75,"column":29},"end":{"line":75,"column":47}},"line":75},"20":{"name":"getSingleUserByEmail","decl":{"start":{"line":78,"column":9},"end":{"line":78,"column":29}},"loc":{"start":{"line":78,"column":37},"end":{"line":83,"column":1}},"line":78},"21":{"name":"(anonymous_21)","decl":{"start":{"line":82,"column":14},"end":{"line":82,"column":15}},"loc":{"start":{"line":82,"column":29},"end":{"line":82,"column":47}},"line":82},"22":{"name":"addLocalUser","decl":{"start":{"line":85,"column":9},"end":{"line":85,"column":21}},"loc":{"start":{"line":85,"column":28},"end":{"line":112,"column":1}},"line":85},"23":{"name":"(anonymous_23)","decl":{"start":{"line":86,"column":43},"end":{"line":86,"column":44}},"loc":{"start":{"line":86,"column":55},"end":{"line":111,"column":5}},"line":86},"24":{"name":"(anonymous_24)","decl":{"start":{"line":88,"column":33},"end":{"line":88,"column":34}},"loc":{"start":{"line":88,"column":47},"end":{"line":110,"column":9}},"line":88},"25":{"name":"(anonymous_25)","decl":{"start":{"line":108,"column":34},"end":{"line":108,"column":35}},"loc":{"start":{"line":108,"column":49},"end":{"line":108,"column":67}},"line":108},"26":{"name":"updateLocalPassword","decl":{"start":{"line":114,"column":9},"end":{"line":114,"column":28}},"loc":{"start":{"line":114,"column":43},"end":{"line":116,"column":1}},"line":114},"27":{"name":"updateUser","decl":{"start":{"line":118,"column":9},"end":{"line":118,"column":19}},"loc":{"start":{"line":118,"column":26},"end":{"line":124,"column":1}},"line":118},"28":{"name":"hashPassword","decl":{"start":{"line":126,"column":9},"end":{"line":126,"column":21}},"loc":{"start":{"line":126,"column":32},"end":{"line":131,"column":1}},"line":126}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":89,"column":12},"end":{"line":109,"column":13}},"type":"switch","locations":[{"start":{"line":90,"column":16},"end":{"line":90,"column":79}},{"start":{"line":91,"column":16},"end":{"line":108,"column":70}}],"line":89},"30":{"loc":{"start":{"line":93,"column":20},"end":{"line":95,"column":21}},"type":"if","locations":[{"start":{"line":93,"column":20},"end":{"line":95,"column":21}},{"start":{"line":93,"column":20},"end":{"line":95,"column":21}}],"line":93},"31":{"loc":{"start":{"line":104,"column":42},"end":{"line":104,"column":63}},"type":"binary-expr","locations":[{"start":{"line":104,"column":42},"end":{"line":104,"column":55}},{"start":{"line":104,"column":59},"end":{"line":104,"column":63}}],"line":104},"32":{"loc":{"start":{"line":127,"column":4},"end":{"line":128,"column":20}},"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":128,"column":20}},{"start":{"line":127,"column":4},"end":{"line":128,"column":20}}],"line":127}},"s":{"0":1,"1":2,"2":0,"3":2,"4":2,"5":2,"6":0,"7":0,"8":0,"9":0,"10":4,"11":2,"12":1,"13":2,"14":2,"15":0,"16":2,"17":2,"18":0,"19":6,"20":4,"21":4,"22":0,"23":4,"24":8,"25":8,"26":0,"27":8,"28":0,"29":8,"30":4,"31":4,"32":2,"33":2,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":2,"42":2,"43":2,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":4,"60":0,"61":0,"62":8,"63":2,"64":0,"65":2,"66":1,"67":1,"68":1,"69":1,"70":0,"71":1,"72":0,"73":0,"74":0,"75":1,"76":0,"77":0,"78":1,"79":0,"80":0,"81":1,"82":2,"83":2,"84":1,"85":2,"86":2,"87":4,"88":2,"89":2,"90":2,"91":0,"92":2,"93":2,"94":2,"95":1,"96":0,"97":1,"98":0,"99":0,"100":1,"101":2,"102":0,"103":2,"104":2},"f":{"0":2,"1":2,"2":0,"3":2,"4":2,"5":0,"6":4,"7":2,"8":2,"9":0,"10":6,"11":4,"12":4,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":2,"21":2,"22":2,"23":2,"24":4,"25":2,"26":0,"27":0,"28":2},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2],"3":[2,2],"4":[2,2],"5":[1,1,1],"6":[0,2],"7":[2,2],"8":[0,4],"9":[0,8],"10":[8,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,8],"16":[4,4,2,0,0,2],"17":[2,0],"18":[2,2,2],"19":[2,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,2],"28":[2,0],"29":[2,2],"30":[0,2],"31":[2,0],"32":[0,2]},"inputSourceMap":{"version":3,"file":"/app/app/db/queries/users.ts","sources":["/app/app/db/queries/users.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Knex from 'knex'\nimport * as bcrypt from 'bcryptjs'\nimport knex from '../../libs/knex'\nimport {IGoogleUser, IUser} from './interfaces/Iusers'\nimport {ALREADY_EXISTS} from '../../templates/errors';\n\nfunction getSingleUser(id: string): Promise<IUser> {\n  return knex('users')\n      .select('*')\n      .where({id: parseInt(id, 10)})\n      .first()\n}\n\nfunction confirmEmail(email: string): Promise<IUser> {\n    return knex.raw(`\n        update users set\n        local = local || '{\"verified\": true}'::jsonb\n        where local->>'email'=?\n        returning id, local, type\n        ;\n    `, [email]).then(({rows})=> rows[0]);\n}\n\nfunction getGoogleUserByEmail(email: string): IUser {\n    return knex('users')\n        .select('*')\n        .whereRaw(`google->>'email'=?`, [email])\n        .then(res => res[0])\n}\nfunction storeGoogleUser(user: IGoogleUser) {\n    return knex('users')\n        .insert({\n            type: 'google',\n            // verified: true,\n            google:\n                {\n                    email: user.email,\n                    name: user.name,\n                    verified: true\n                },\n        })\n        .returning(['id', 'google', 'type'])\n        .then((res)=> res[0]).catch(console.error);\n}\nfunction getSingleUserByEmail(email: string): IUser {\n  return knex('users')\n      .select('*')\n      .whereRaw(`local->>'email'=?`, [email])\n      .then(res => res[0])\n}\n\nasync function addLocalUser(user: {name: string, email: string, password: string, verified?: boolean}): Promise<IUser> {\n    const u = await getSingleUserByEmail(user.email);\n    if (u) {\n        throw ALREADY_EXISTS\n    }\n    const hash = hashPassword(user.password)\n    return knex('users')\n      .insert({\n          type: 'local',\n          local:\n              {\n                  email: user.email,\n                  name: user.name,\n                  password: hash,\n                  verified: user.verified || null\n              },\n      })\n      .returning(['id', 'local'])\n      .then((res)=> res[0]);\n}\nfunction updateLocalPassword(id, password) {\n    return knex.raw(`\n            update users set\n            local = local || '{\"password\": \"${hashPassword(password)}\"}'::jsonb\n            where id=?\n    `, [id])\n}\nfunction updateUser(user: IUser): Knex.QueryBuilder {\n  user.local.password = hashPassword(user.local.password);\n  return knex('users')\n      .update(user)\n      .where('id', user.id)\n      .returning(['name', 'email']);\n}\n\nfunction hashPassword(password: string): string {\n  if (!password) return null;\n  const salt = bcrypt.genSaltSync();\n  return bcrypt.hashSync(password, salt);\n}\n\nexport {\n  updateUser,\n  getGoogleUserByEmail,\n  storeGoogleUser,\n  getSingleUser,\n  getSingleUserByEmail,\n  addLocalUser,\n  confirmEmail,\n  updateLocalPassword\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2dbf9c747ba4f3b93593357cb63d326386c1127f","contentHash":"c71d853262bafe2c55b41ec63c248e06cf5e73cc31d33ebef4341b251cd3c865"},"/app/app/templates/errors/index.ts":{"path":"/app/app/templates/errors/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":6,"column":2}},"2":{"start":{"line":7,"column":0},"end":{"line":10,"column":2}},"3":{"start":{"line":11,"column":0},"end":{"line":14,"column":2}},"4":{"start":{"line":15,"column":0},"end":{"line":18,"column":2}},"5":{"start":{"line":19,"column":0},"end":{"line":22,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/templates/errors/index.ts","sources":["/app/app/templates/errors/index.ts"],"names":[],"mappings":";;AAAa,QAAA,mBAAmB,GAAG;IAC/B,UAAU,EAAE,GAAG;IACf,IAAI,EAAE,sBAAsB;CAC/B,CAAA;AACY,QAAA,cAAc,GAAG;IAC1B,UAAU,EAAE,GAAG;IACf,IAAI,EAAE,gBAAgB;CACzB,CAAA;AACY,QAAA,cAAc,GAAG;IAC1B,UAAU,EAAE,GAAG;IACf,IAAI,EAAE,yBAAyB;CAClC,CAAA;AACY,QAAA,kBAAkB,GAAG;IAC9B,UAAU,EAAE,GAAG;IACf,IAAI,EAAE,oBAAoB;CAC7B,CAAA;AACY,QAAA,WAAW,GAAG;IACvB,UAAU,EAAE,GAAG;IACf,IAAI,EAAE,aAAa;CACtB,CAAA","sourcesContent":["export const CANT_PROCESS_ENTITY = {\n    httpStatus: 422,\n    body: `Can't process entity`\n}\nexport const ALREADY_EXISTS = {\n    httpStatus: 403,\n    body: `Already exists`\n}\nexport const WRONG_PASSWORD = {\n    httpStatus: 403,\n    body: `Wrong email or passwprd`\n}\nexport const EMAIL_NOT_VERIFIED = {\n    httpStatus: 401,\n    body: 'Email not verified'\n}\nexport const BAD_REQUEST = {\n    httpStatus: 400,\n    body: 'Bad request'\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f072de7333ab72861ea19acd88b3e1d31f51d0b8","contentHash":"eb7ccfe185583f062524263df2369f23099f009a7f2e4df19697860d047f6872"},"/app/app/db/queries/auth.ts":{"path":"/app/app/db/queries/auth.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":13},"end":{"line":39,"column":39}},"68":{"start":{"line":40,"column":13},"end":{"line":40,"column":43}},"69":{"start":{"line":42,"column":4},"end":{"line":71,"column":7}},"70":{"start":{"line":44,"column":8},"end":{"line":70,"column":11}},"71":{"start":{"line":45,"column":12},"end":{"line":69,"column":13}},"72":{"start":{"line":46,"column":24},"end":{"line":46,"column":75}},"73":{"start":{"line":48,"column":20},"end":{"line":48,"column":36}},"74":{"start":{"line":49,"column":20},"end":{"line":49,"column":33}},"75":{"start":{"line":51,"column":20},"end":{"line":51,"column":46}},"76":{"start":{"line":52,"column":20},"end":{"line":52,"column":106}},"77":{"start":{"line":54,"column":20},"end":{"line":54,"column":30}},"78":{"start":{"line":55,"column":20},"end":{"line":55,"column":77}},"79":{"start":{"line":57,"column":20},"end":{"line":57,"column":30}},"80":{"start":{"line":58,"column":20},"end":{"line":58,"column":55}},"81":{"start":{"line":60,"column":20},"end":{"line":60,"column":30}},"82":{"start":{"line":61,"column":20},"end":{"line":61,"column":44}},"83":{"start":{"line":63,"column":20},"end":{"line":63,"column":36}},"84":{"start":{"line":64,"column":20},"end":{"line":64,"column":57}},"85":{"start":{"line":66,"column":20},"end":{"line":66,"column":30}},"86":{"start":{"line":67,"column":20},"end":{"line":67,"column":44}},"87":{"start":{"line":68,"column":24},"end":{"line":68,"column":46}},"88":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"89":{"start":{"line":75,"column":8},"end":{"line":75,"column":45}},"90":{"start":{"line":77,"column":4},"end":{"line":81,"column":17}},"91":{"start":{"line":83,"column":0},"end":{"line":86,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"storeRefreshToken","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":26}},"loc":{"start":{"line":41,"column":33},"end":{"line":72,"column":1}},"line":41},"14":{"name":"(anonymous_14)","decl":{"start":{"line":42,"column":43},"end":{"line":42,"column":44}},"loc":{"start":{"line":42,"column":55},"end":{"line":71,"column":5}},"line":42},"15":{"name":"(anonymous_15)","decl":{"start":{"line":44,"column":33},"end":{"line":44,"column":34}},"loc":{"start":{"line":44,"column":47},"end":{"line":70,"column":9}},"line":44},"16":{"name":"checkRefreshToken","decl":{"start":{"line":73,"column":9},"end":{"line":73,"column":26}},"loc":{"start":{"line":73,"column":31},"end":{"line":82,"column":1}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":45,"column":12},"end":{"line":69,"column":13}},"type":"switch","locations":[{"start":{"line":46,"column":16},"end":{"line":46,"column":75}},{"start":{"line":47,"column":16},"end":{"line":49,"column":33}},{"start":{"line":50,"column":16},"end":{"line":52,"column":106}},{"start":{"line":53,"column":16},"end":{"line":55,"column":77}},{"start":{"line":56,"column":16},"end":{"line":58,"column":55}},{"start":{"line":59,"column":16},"end":{"line":61,"column":44}},{"start":{"line":62,"column":16},"end":{"line":64,"column":57}},{"start":{"line":65,"column":16},"end":{"line":67,"column":44}},{"start":{"line":68,"column":16},"end":{"line":68,"column":46}}],"line":45},"30":{"loc":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},{"start":{"line":74,"column":4},"end":{"line":76,"column":5}}],"line":74}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0,0,0,0,0,0,0,0],"30":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/db/queries/auth.ts","sources":["/app/app/db/queries/auth.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wCAAkC;AAClC,4CAAmD;AAEnD,SAAe,iBAAiB,CAAC,IAAI;;;;;wBACrB,qBAAM,cAAI,CAAC,WAAW,EAAE,EAAA;;oBAA9B,GAAG,GAAG,SAAwB;;;;oBAEhC,qBAAM,GAAG,CAAC,gBAAgB,CAAC,CAAC,KAAK,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,OAAO,EAAC,CAAC,CAAC,MAAM,EAAE,EAAA;;oBAAnE,SAAmE,CAAA;oBACnE,qBAAM,GAAG,CAAC,gBAAgB,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,EAAA;;oBAAxC,SAAwC,CAAA;oBACxC,qBAAM,GAAG,CAAC,MAAM,EAAE,EAAA;;oBAAlB,SAAkB,CAAC;;;;oBAEnB,qBAAM,GAAG,CAAC,QAAQ,EAAE,EAAA;;oBAApB,SAAoB,CAAC;;;;;;CAE5B;AAED,SAAS,iBAAiB,CAAC,EAAU;IACjC,IAAI,CAAC,EAAE,EAAE;QACL,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;KACxC;IACD,OAAO,cAAI,CAAC,gBAAgB,CAAC;SACxB,KAAK,CAAC,EAAC,EAAE,IAAA,EAAC,CAAC;SACX,QAAQ,CAAC,WAAW,EAAE,GAAG,EAAE,cAAI,CAAC,GAAG,CAAC,uBAAqB,sBAAe,MAAG,CAAC,CAAC;SAC7E,MAAM,CAAC,IAAI,EAAE,SAAS,CAAC;SACvB,KAAK,EAAE,CAAA;AAChB,CAAC;AACD,kBAAe;IACX,iBAAiB,mBAAA;IACjB,iBAAiB,mBAAA;CACpB,CAAA","sourcesContent":["import knex from '../../libs/knex'\nimport {JWT_REFRESH_TTL} from '../../services/auth'\n\nasync function storeRefreshToken(data) {\n    const trx = await knex.transaction()\n    try {\n        await trx('refresh_tokens').where({user_id: data.user_id}).delete()\n        await trx('refresh_tokens').insert(data)\n        await trx.commit();\n    } catch (e) {\n        await trx.rollback();\n    }\n}\n\nfunction checkRefreshToken(id: string): Promise<{id: string, user_id: string}> {\n    if (!id) {\n        throw new Error('Invalid arguments');\n    }\n    return knex('refresh_tokens')\n        .where({id})\n        .andWhere('timestamp', '>', knex.raw(`NOW() - INTERVAL '${JWT_REFRESH_TTL}'`))\n        .select('id', 'user_id')\n        .first()\n}\nexport default {\n    storeRefreshToken,\n    checkRefreshToken,\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6b7ad262943c524f2508b852e9d68e9aaf224fb3","contentHash":"5a89ee81bba73d7613f02baeccb098b06df0c984c33f8f847c3d00769112ea88"},"/app/app/services/mailer.ts":{"path":"/app/app/services/mailer.ts","statementMap":{"0":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":10,"column":6}},"2":{"start":{"line":4,"column":8},"end":{"line":8,"column":9}},"3":{"start":{"line":4,"column":24},"end":{"line":4,"column":25}},"4":{"start":{"line":4,"column":31},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"6":{"start":{"line":6,"column":12},"end":{"line":7,"column":28}},"7":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"8":{"start":{"line":7,"column":16},"end":{"line":7,"column":28}},"9":{"start":{"line":9,"column":8},"end":{"line":9,"column":17}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":43}},"11":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"12":{"start":{"line":14,"column":28},"end":{"line":14,"column":110}},"13":{"start":{"line":14,"column":91},"end":{"line":14,"column":106}},"14":{"start":{"line":15,"column":4},"end":{"line":20,"column":7}},"15":{"start":{"line":16,"column":36},"end":{"line":16,"column":97}},"16":{"start":{"line":16,"column":42},"end":{"line":16,"column":70}},"17":{"start":{"line":16,"column":85},"end":{"line":16,"column":95}},"18":{"start":{"line":17,"column":35},"end":{"line":17,"column":100}},"19":{"start":{"line":17,"column":41},"end":{"line":17,"column":73}},"20":{"start":{"line":17,"column":88},"end":{"line":17,"column":98}},"21":{"start":{"line":18,"column":32},"end":{"line":18,"column":116}},"22":{"start":{"line":19,"column":8},"end":{"line":19,"column":78}},"23":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"24":{"start":{"line":23,"column":12},"end":{"line":23,"column":104}},"25":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"26":{"start":{"line":23,"column":57},"end":{"line":23,"column":68}},"27":{"start":{"line":23,"column":69},"end":{"line":23,"column":81}},"28":{"start":{"line":24,"column":4},"end":{"line":24,"column":157}},"29":{"start":{"line":24,"column":138},"end":{"line":24,"column":150}},"30":{"start":{"line":25,"column":23},"end":{"line":25,"column":68}},"31":{"start":{"line":25,"column":45},"end":{"line":25,"column":65}},"32":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"33":{"start":{"line":27,"column":15},"end":{"line":27,"column":70}},"34":{"start":{"line":28,"column":8},"end":{"line":45,"column":66}},"35":{"start":{"line":28,"column":18},"end":{"line":45,"column":66}},"36":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"37":{"start":{"line":29,"column":160},"end":{"line":29,"column":169}},"38":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"39":{"start":{"line":30,"column":26},"end":{"line":30,"column":52}},"40":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"41":{"start":{"line":32,"column":32},"end":{"line":32,"column":39}},"42":{"start":{"line":32,"column":40},"end":{"line":32,"column":46}},"43":{"start":{"line":33,"column":24},"end":{"line":33,"column":34}},"44":{"start":{"line":33,"column":35},"end":{"line":33,"column":72}},"45":{"start":{"line":34,"column":24},"end":{"line":34,"column":34}},"46":{"start":{"line":34,"column":35},"end":{"line":34,"column":45}},"47":{"start":{"line":34,"column":46},"end":{"line":34,"column":55}},"48":{"start":{"line":34,"column":56},"end":{"line":34,"column":65}},"49":{"start":{"line":35,"column":24},"end":{"line":35,"column":41}},"50":{"start":{"line":35,"column":42},"end":{"line":35,"column":55}},"51":{"start":{"line":35,"column":56},"end":{"line":35,"column":65}},"52":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"53":{"start":{"line":37,"column":110},"end":{"line":37,"column":116}},"54":{"start":{"line":37,"column":117},"end":{"line":37,"column":126}},"55":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"56":{"start":{"line":38,"column":81},"end":{"line":38,"column":97}},"57":{"start":{"line":38,"column":98},"end":{"line":38,"column":104}},"58":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"59":{"start":{"line":39,"column":57},"end":{"line":39,"column":72}},"60":{"start":{"line":39,"column":73},"end":{"line":39,"column":80}},"61":{"start":{"line":39,"column":81},"end":{"line":39,"column":87}},"62":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"63":{"start":{"line":40,"column":47},"end":{"line":40,"column":62}},"64":{"start":{"line":40,"column":63},"end":{"line":40,"column":78}},"65":{"start":{"line":40,"column":79},"end":{"line":40,"column":85}},"66":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"67":{"start":{"line":41,"column":30},"end":{"line":41,"column":42}},"68":{"start":{"line":42,"column":20},"end":{"line":42,"column":33}},"69":{"start":{"line":42,"column":34},"end":{"line":42,"column":43}},"70":{"start":{"line":44,"column":12},"end":{"line":44,"column":39}},"71":{"start":{"line":45,"column":22},"end":{"line":45,"column":34}},"72":{"start":{"line":45,"column":35},"end":{"line":45,"column":41}},"73":{"start":{"line":45,"column":54},"end":{"line":45,"column":64}},"74":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"75":{"start":{"line":46,"column":23},"end":{"line":46,"column":35}},"76":{"start":{"line":46,"column":36},"end":{"line":46,"column":89}},"77":{"start":{"line":49,"column":0},"end":{"line":49,"column":62}},"78":{"start":{"line":50,"column":15},"end":{"line":50,"column":40}},"79":{"start":{"line":51,"column":15},"end":{"line":51,"column":45}},"80":{"start":{"line":52,"column":15},"end":{"line":52,"column":34}},"81":{"start":{"line":53,"column":0},"end":{"line":74,"column":2}},"82":{"start":{"line":54,"column":46},"end":{"line":68,"column":7}},"83":{"start":{"line":56,"column":8},"end":{"line":67,"column":11}},"84":{"start":{"line":57,"column":12},"end":{"line":57,"column":53}},"85":{"start":{"line":58,"column":12},"end":{"line":58,"column":43}},"86":{"start":{"line":59,"column":12},"end":{"line":59,"column":40}},"87":{"start":{"line":60,"column":12},"end":{"line":60,"column":227}},"88":{"start":{"line":61,"column":12},"end":{"line":65,"column":15}},"89":{"start":{"line":62,"column":16},"end":{"line":62,"column":43}},"90":{"start":{"line":63,"column":16},"end":{"line":63,"column":33}},"91":{"start":{"line":64,"column":16},"end":{"line":64,"column":43}},"92":{"start":{"line":66,"column":12},"end":{"line":66,"column":39}},"93":{"start":{"line":70,"column":18},"end":{"line":70,"column":194}},"94":{"start":{"line":71,"column":8},"end":{"line":71,"column":25}},"95":{"start":{"line":72,"column":8},"end":{"line":72,"column":19}},"96":{"start":{"line":76,"column":4},"end":{"line":79,"column":6}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":42},"end":{"line":2,"column":43}},"loc":{"start":{"line":2,"column":54},"end":{"line":12,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":3,"column":32},"end":{"line":3,"column":33}},"loc":{"start":{"line":3,"column":44},"end":{"line":10,"column":5}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":44},"end":{"line":13,"column":45}},"loc":{"start":{"line":13,"column":89},"end":{"line":21,"column":1}},"line":13},"3":{"name":"adopt","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":18}},"loc":{"start":{"line":14,"column":26},"end":{"line":14,"column":112}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":70},"end":{"line":14,"column":71}},"loc":{"start":{"line":14,"column":89},"end":{"line":14,"column":108}},"line":14},"5":{"name":"(anonymous_5)","decl":{"start":{"line":15,"column":36},"end":{"line":15,"column":37}},"loc":{"start":{"line":15,"column":63},"end":{"line":20,"column":5}},"line":15},"6":{"name":"fulfilled","decl":{"start":{"line":16,"column":17},"end":{"line":16,"column":26}},"loc":{"start":{"line":16,"column":34},"end":{"line":16,"column":99}},"line":16},"7":{"name":"rejected","decl":{"start":{"line":17,"column":17},"end":{"line":17,"column":25}},"loc":{"start":{"line":17,"column":33},"end":{"line":17,"column":102}},"line":17},"8":{"name":"step","decl":{"start":{"line":18,"column":17},"end":{"line":18,"column":21}},"loc":{"start":{"line":18,"column":30},"end":{"line":18,"column":118}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":48},"end":{"line":22,"column":49}},"loc":{"start":{"line":22,"column":73},"end":{"line":48,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":30},"end":{"line":23,"column":31}},"loc":{"start":{"line":23,"column":41},"end":{"line":23,"column":83}},"line":23},"11":{"name":"(anonymous_11)","decl":{"start":{"line":24,"column":125},"end":{"line":24,"column":126}},"loc":{"start":{"line":24,"column":136},"end":{"line":24,"column":152}},"line":24},"12":{"name":"verb","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":17}},"loc":{"start":{"line":25,"column":21},"end":{"line":25,"column":70}},"line":25},"13":{"name":"(anonymous_13)","decl":{"start":{"line":25,"column":30},"end":{"line":25,"column":31}},"loc":{"start":{"line":25,"column":43},"end":{"line":25,"column":67}},"line":25},"14":{"name":"step","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":17}},"loc":{"start":{"line":26,"column":22},"end":{"line":47,"column":5}},"line":26},"15":{"name":"(anonymous_15)","decl":{"start":{"line":54,"column":27},"end":{"line":54,"column":28}},"loc":{"start":{"line":54,"column":44},"end":{"line":68,"column":9}},"line":54},"16":{"name":"(anonymous_16)","decl":{"start":{"line":54,"column":87},"end":{"line":54,"column":88}},"loc":{"start":{"line":54,"column":99},"end":{"line":68,"column":5}},"line":54},"17":{"name":"(anonymous_17)","decl":{"start":{"line":56,"column":33},"end":{"line":56,"column":34}},"loc":{"start":{"line":56,"column":47},"end":{"line":67,"column":9}},"line":56},"18":{"name":"(anonymous_18)","decl":{"start":{"line":61,"column":40},"end":{"line":61,"column":41}},"loc":{"start":{"line":61,"column":55},"end":{"line":65,"column":13}},"line":61},"19":{"name":"(anonymous_19)","decl":{"start":{"line":69,"column":21},"end":{"line":69,"column":22}},"loc":{"start":{"line":69,"column":48},"end":{"line":73,"column":5}},"line":69},"20":{"name":"formAddress","decl":{"start":{"line":75,"column":9},"end":{"line":75,"column":20}},"loc":{"start":{"line":75,"column":28},"end":{"line":80,"column":1}},"line":75}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":16},"end":{"line":2,"column":20}},{"start":{"line":2,"column":24},"end":{"line":2,"column":37}},{"start":{"line":2,"column":42},"end":{"line":12,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":15},"end":{"line":10,"column":5}},"type":"binary-expr","locations":[{"start":{"line":3,"column":15},"end":{"line":3,"column":28}},{"start":{"line":3,"column":32},"end":{"line":10,"column":5}}],"line":3},"2":{"loc":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"type":"if","locations":[{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},{"start":{"line":6,"column":29},"end":{"line":7,"column":28}}],"line":6},"3":{"loc":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":13,"column":17},"end":{"line":13,"column":21}},{"start":{"line":13,"column":25},"end":{"line":13,"column":39}},{"start":{"line":13,"column":44},"end":{"line":21,"column":1}}],"line":13},"4":{"loc":{"start":{"line":14,"column":35},"end":{"line":14,"column":109}},"type":"cond-expr","locations":[{"start":{"line":14,"column":56},"end":{"line":14,"column":61}},{"start":{"line":14,"column":64},"end":{"line":14,"column":109}}],"line":14},"5":{"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":34}},"type":"binary-expr","locations":[{"start":{"line":15,"column":16},"end":{"line":15,"column":17}},{"start":{"line":15,"column":22},"end":{"line":15,"column":33}}],"line":15},"6":{"loc":{"start":{"line":18,"column":32},"end":{"line":18,"column":115}},"type":"cond-expr","locations":[{"start":{"line":18,"column":46},"end":{"line":18,"column":67}},{"start":{"line":18,"column":70},"end":{"line":18,"column":115}}],"line":18},"7":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":67}},"type":"binary-expr","locations":[{"start":{"line":19,"column":51},"end":{"line":19,"column":61}},{"start":{"line":19,"column":65},"end":{"line":19,"column":67}}],"line":19},"8":{"loc":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":19},"end":{"line":22,"column":23}},{"start":{"line":22,"column":27},"end":{"line":22,"column":43}},{"start":{"line":22,"column":48},"end":{"line":48,"column":1}}],"line":22},"9":{"loc":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"type":"if","locations":[{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},{"start":{"line":23,"column":43},"end":{"line":23,"column":68}}],"line":23},"10":{"loc":{"start":{"line":24,"column":71},"end":{"line":24,"column":153}},"type":"binary-expr","locations":[{"start":{"line":24,"column":71},"end":{"line":24,"column":99}},{"start":{"line":24,"column":104},"end":{"line":24,"column":152}}],"line":24},"11":{"loc":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},{"start":{"line":27,"column":8},"end":{"line":27,"column":70}}],"line":27},"12":{"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},{"start":{"line":29,"column":12},"end":{"line":29,"column":169}}],"line":29},"13":{"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":158}},"type":"binary-expr","locations":[{"start":{"line":29,"column":23},"end":{"line":29,"column":24}},{"start":{"line":29,"column":29},"end":{"line":29,"column":125}},{"start":{"line":29,"column":130},"end":{"line":29,"column":158}}],"line":29},"14":{"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":45},"end":{"line":29,"column":56}},{"start":{"line":29,"column":59},"end":{"line":29,"column":125}}],"line":29},"15":{"loc":{"start":{"line":29,"column":59},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},{"start":{"line":29,"column":119},"end":{"line":29,"column":125}}],"line":29},"16":{"loc":{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},"type":"binary-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":77}},{"start":{"line":29,"column":82},"end":{"line":29,"column":115}}],"line":29},"17":{"loc":{"start":{"line":29,"column":82},"end":{"line":29,"column":112}},"type":"binary-expr","locations":[{"start":{"line":29,"column":83},"end":{"line":29,"column":98}},{"start":{"line":29,"column":103},"end":{"line":29,"column":112}}],"line":29},"18":{"loc":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"type":"if","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},{"start":{"line":30,"column":12},"end":{"line":30,"column":52}}],"line":30},"19":{"loc":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"type":"switch","locations":[{"start":{"line":32,"column":16},"end":{"line":32,"column":23}},{"start":{"line":32,"column":24},"end":{"line":32,"column":46}},{"start":{"line":33,"column":16},"end":{"line":33,"column":72}},{"start":{"line":34,"column":16},"end":{"line":34,"column":65}},{"start":{"line":35,"column":16},"end":{"line":35,"column":65}},{"start":{"line":36,"column":16},"end":{"line":42,"column":43}}],"line":31},"20":{"loc":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"type":"if","locations":[{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},{"start":{"line":37,"column":20},"end":{"line":37,"column":128}}],"line":37},"21":{"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":106}},"type":"binary-expr","locations":[{"start":{"line":37,"column":24},"end":{"line":37,"column":74}},{"start":{"line":37,"column":79},"end":{"line":37,"column":90}},{"start":{"line":37,"column":94},"end":{"line":37,"column":105}}],"line":37},"22":{"loc":{"start":{"line":37,"column":42},"end":{"line":37,"column":73}},"type":"binary-expr","locations":[{"start":{"line":37,"column":42},"end":{"line":37,"column":54}},{"start":{"line":37,"column":58},"end":{"line":37,"column":73}}],"line":37},"23":{"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"type":"if","locations":[{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},{"start":{"line":38,"column":20},"end":{"line":38,"column":106}}],"line":38},"24":{"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":77}},"type":"binary-expr","locations":[{"start":{"line":38,"column":24},"end":{"line":38,"column":35}},{"start":{"line":38,"column":40},"end":{"line":38,"column":42}},{"start":{"line":38,"column":47},"end":{"line":38,"column":59}},{"start":{"line":38,"column":63},"end":{"line":38,"column":75}}],"line":38},"25":{"loc":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"type":"if","locations":[{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},{"start":{"line":39,"column":20},"end":{"line":39,"column":89}}],"line":39},"26":{"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":53}},"type":"binary-expr","locations":[{"start":{"line":39,"column":24},"end":{"line":39,"column":35}},{"start":{"line":39,"column":39},"end":{"line":39,"column":53}}],"line":39},"27":{"loc":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"type":"if","locations":[{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},{"start":{"line":40,"column":20},"end":{"line":40,"column":87}}],"line":40},"28":{"loc":{"start":{"line":40,"column":24},"end":{"line":40,"column":43}},"type":"binary-expr","locations":[{"start":{"line":40,"column":24},"end":{"line":40,"column":25}},{"start":{"line":40,"column":29},"end":{"line":40,"column":43}}],"line":40},"29":{"loc":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"type":"if","locations":[{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},{"start":{"line":41,"column":20},"end":{"line":41,"column":42}}],"line":41},"30":{"loc":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},{"start":{"line":46,"column":8},"end":{"line":46,"column":35}}],"line":46},"31":{"loc":{"start":{"line":46,"column":52},"end":{"line":46,"column":74}},"type":"cond-expr","locations":[{"start":{"line":46,"column":60},"end":{"line":46,"column":65}},{"start":{"line":46,"column":68},"end":{"line":46,"column":74}}],"line":46}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":1,"24":1,"25":0,"26":0,"27":0,"28":1,"29":0,"30":3,"31":1,"32":1,"33":0,"34":1,"35":2,"36":2,"37":0,"38":2,"39":0,"40":2,"41":1,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":1,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":1,"71":1,"72":1,"73":2,"74":1,"75":1,"76":0,"77":1,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":1,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0},"f":{"0":0,"1":0,"2":1,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":3,"13":1,"14":1,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[1,1,1],"4":[0,0],"5":[1,1],"6":[0,0],"7":[1,1],"8":[1,1,1],"9":[0,0],"10":[1,1],"11":[0,1],"12":[0,2],"13":[2,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,2],"19":[1,1,0,0,0,1],"20":[1,0],"21":[1,1,0],"22":[1,0],"23":[0,0],"24":[0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[1,0],"31":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/services/mailer.ts","sources":["/app/app/services/mailer.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yCAAsD;AACtD,8CAA2C;AAC3C,mCAAiC;AAEjC,kBAAe;IACX,qBAAqB,EAAE,UAAO,KAAa;;;YACjC,cAAc,GAAG,gBAAO,CAAC,KAAK,CAAC,CAAC;YAEtC,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;YAC/B,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YACtB,GAAG,GAAI,gBAAM,CAAC,QAAQ,uBACrB,WAAW,CAAC,KAAK,CAAC,KACrB,OAAO,EAAE,yBAAyB,EAClC,IAAI,EAAE,6BAA6B,EACnC,IAAI,EAAE,gBAAQ,CAAC,YAAY,CAAC,gBAAO,CAAC,KAAK,CAAC,CAAC,IAC7C,CAAA;YAEF,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,UAAA,GAAG;gBAC3B,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gBAC3B,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBACjB,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAA;YACF,sBAAO,GAAG,EAAA;;SACb;IACD,eAAe,EAAE,UAAC,KAAa,EAAE,QAAgB;QAC7C,IAAM,GAAG,GAAG,gBAAM,CAAC,QAAQ,uBACpB,WAAW,CAAC,KAAK,CAAC,KACrB,OAAO,EAAE,mBAAmB,EAC5B,IAAI,EAAE,mBAAmB,EACzB,IAAI,EAAE,gBAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,IACtC,CAAA;QACF,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QAChB,OAAO,GAAG,CAAA;IACd,CAAC;CACJ,CAAA;AAED,SAAS,WAAW,CAAC,KAAK;IACtB,OAAO;QACH,IAAI,EAAE,oDAAoD;QAC1D,EAAE,EAAE,KAAK;KACZ,CAAA;AACL,CAAC","sourcesContent":["import mailer, {IMailerResponse} from '../libs/mailer'\nimport template from '../templates/emails';\nimport {encrypt} from './crypto';\n\nexport default {\n    sendConfirmationEmail: async (email: string): Promise<IMailerResponse> => {\n        const encryptedEmail = encrypt(email);\n\n        console.log('Encrypted email');\n        console.log(encryptedEmail);\n        const res =  mailer.sendMail({\n            ...formAddress(email),\n            subject: 'Confirm email account ',\n            text: 'Confirm your email account?',\n            html: template.confirmEmail(encrypt(email)),\n        })\n\n        res.then(console.log).catch(err => {\n            console.log('-----------');\n            console.log(err);\n            console.log('-----------');\n        })\n        return res\n    },\n    sendNewPassword: (email: string, password: string): Promise<IMailerResponse> => {\n        const res = mailer.sendMail({\n            ...formAddress(email),\n            subject: 'Your new password',\n            text: 'Your new password',\n            html: template.newPassword(password),\n        })\n        console.log(res)\n        return res\n    }\n}\n\nfunction formAddress(email) {\n    return {\n        from: '\"Football for everyone \" <f4econtacts@gmail.com>',\n        to: email\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1e257b9edb40bcc4e6848c93ce59b25d3ba90a01","contentHash":"f3ace102095634445a1dda47c59843f4e4a9e3516cafbca6635dbef3a8ea5e98"},"/app/app/libs/mailer/index.ts":{"path":"/app/app/libs/mailer/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":17},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":9},"end":{"line":4,"column":22}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":11},"end":{"line":6,"column":95}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":22}},"6":{"start":{"line":30,"column":0},"end":{"line":30,"column":30}},"7":{"start":{"line":32,"column":10},"end":{"line":32,"column":168}},"8":{"start":{"line":33,"column":0},"end":{"line":45,"column":3}},"9":{"start":{"line":34,"column":4},"end":{"line":34,"column":28}},"10":{"start":{"line":35,"column":4},"end":{"line":35,"column":34}},"11":{"start":{"line":36,"column":4},"end":{"line":44,"column":7}},"12":{"start":{"line":46,"column":0},"end":{"line":46,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":33,"column":14},"end":{"line":33,"column":15}},"loc":{"start":{"line":33,"column":37},"end":{"line":45,"column":1}},"line":33}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/libs/mailer/index.ts","sources":["/app/app/libs/mailer/index.ts"],"names":[],"mappings":";;AAAA,uCAAwC;AAExC,uBAAyB;AACzB,yCAAkC;AAClC,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,SAAS,GAAC,gCAAgC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;AAEhG,IAAI,WAAW,GAAG,IAAI,CAAC;AAEvB,iCAAiC;AACjC,sBAAsB;AAEtB,mDAAmD;AACnD,wBAAwB;AACxB,cAAc;AACd,0BAA0B;AAC1B,8CAA8C;AAC9C,oDAAoD;AACpD,mDAAmD;AACnD,4CAA4C;AAC5C,oDAAoD;AACpD,SAAS;AACT,MAAM;AAEN,mDAAmD;AACnD,8BAA8B;AAC9B,cAAc;AACd,wCAAwC;AACxC,kDAAkD;AAClD,gEAAgE;AAChE,0BAA0B;AAC1B,QAAQ;AACR,MAAM;AAEN,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;AAC9B,EAAE;AACF,IAAM,GAAG,GAAG,IAAI,mBAAM,CAAC,IAAI,CAAC,GAAG,CAC3B,8CAA8C,EAC9C,IAAI,EACJ,IAAI,CAAC,WAAW,EAChB,CAAC,4CAA4C,CAAC,EAC9C,IAAI,CACP,CAAC;AACF,GAAG,CAAC,SAAS,CAAC,UAAC,GAAG,EAAE,MAAM;IACtB,OAAO,CAAC,GAAG,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;IACxB,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;IAC9B,WAAW,GAAG,UAAU,CAAC,eAAe,CAAC;QACrC,IAAI,EAAE,gBAAgB;QACtB,IAAI,EAAE;YACF,UAAU,EAAE,IAAI,CAAC,WAAW;YAC5B,aAAa,EAAE,uBAAuB;YACtC,IAAI,EAAE,8CAA8C;YACpD,IAAI,EAAE,QAAQ;SACjB;KACJ,CAAC,CAAC;AACP,CAAC,CAAC,CAAA;AAMF,kBAAe,WAAW,CAAC","sourcesContent":["import * as nodemailer from 'nodemailer'\nimport config from '../../config'\nimport * as fs from 'fs';\nimport {google} from 'googleapis';\nconst file = JSON.parse(fs.readFileSync(__dirname+'/test-265610-d2589ad59376.json').toString());\n\nlet transporter = null;\n\n// console.log(file.private_key);\n// console.log(config)\n\n// const transporter = nodemailer.createTransport({\n//     service: 'gmail',\n//     auth: {\n//         type: 'OAuth2',\n//         user: 'f4econtactcenter@gmail.com',\n//         refreshToken: config.GMAIL_REFRESH_TOKEN,\n//         access_token: config.GMAIL_ACCESS_TOKEN,\n//         clientId: config.GMAIL_CLIENT_ID,\n//         clientSecret: config.GMAIL_CLIENT_SECRET,\n//     },\n// });\n\n// const transporter = nodemailer.createTransport({\n//     host: 'smtp.gmail.com',\n//     auth: {\n//         privateKey: file.private_key,\n//         serviceClient: '101211918838003528763',\n//         user: 'contacts@test-265610.iam.gserviceaccount.com',\n//         type: 'OAuth2',\n//     }\n// });\n\nconsole.log(file.private_key);\n//\nconst jwt = new google.auth.JWT(\n    'contacts@test-265610.iam.gserviceaccount.com',\n    null,\n    file.private_key,\n    ['https://www.googleapis.com/auth/gmail.send'],\n    null\n);\njwt.authorize((err, tokens) => {\n    console.log('err', err);\n    console.log('tokens', tokens);\n    transporter = nodemailer.createTransport({\n        host: 'smtp.gmail.com',\n        auth: {\n            privateKey: file.private_key,\n            serviceClient: '101211918838003528763',\n            user: 'contacts@test-265610.iam.gserviceaccount.com',\n            type: 'OAuth2',\n        }\n    });\n})\n\nexport interface IMailerResponse {\n    messageId: string;\n}\n\nexport default transporter;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a2cc98570f8b263e82fd519f0c70f2172b6ba318","contentHash":"f74185a67d116ab9a8c0aa06492a2a0d46e8484a6eb3d2bc5076ae488c55cff7"},"/app/app/templates/emails/index.ts":{"path":"/app/app/templates/emails/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":15},"end":{"line":3,"column":38}},"2":{"start":{"line":4,"column":0},"end":{"line":11,"column":2}},"3":{"start":{"line":6,"column":8},"end":{"line":6,"column":68}},"4":{"start":{"line":9,"column":8},"end":{"line":9,"column":140}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":18}},"loc":{"start":{"line":5,"column":37},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":18},"end":{"line":8,"column":19}},"loc":{"start":{"line":8,"column":34},"end":{"line":10,"column":5}},"line":8}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":0,"4":0},"f":{"0":0,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/templates/emails/index.ts","sources":["/app/app/templates/emails/index.ts"],"names":[],"mappings":";;AAAA,uCAAkC;AAElC,kBAAe;IACX,WAAW,EAAE,UAAC,QAAQ;QAClB,OAAO,iCAA+B,QAAQ,WAAQ,CAAA;IAC1D,CAAC;IACD,YAAY,EAAE,UAAC,IAAY;QACvB,OAAO,6CAA0C,gBAAM,CAAC,IAAI,gCAA2B,IAAI,sBAAkB,CAAC;IAClH,CAAC;CACJ,CAAA","sourcesContent":["import config from '../../config';\n\nexport default {\n    newPassword: (password) => {\n        return `<div>Your new password is - ${password}</div>`\n    },\n    confirmEmail: (hash: string) => {\n        return `<b>To confirm your account</b><a href=\"${config.HOST}/api/auth/confirm-email/${hash}\">Click here</a>`;\n    },\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"887c92000e4f4b867ecd3306905e67de5b9545be","contentHash":"8cd3babc9037e29d484df474c8aad2aa304284a50a1bf5253c25072c0a6f7d9f"},"/app/app/middleware/default/03-logger.ts":{"path":"/app/app/middleware/default/03-logger.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":60}},"3":{"start":{"line":4,"column":32},"end":{"line":4,"column":57}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":30},"end":{"line":4,"column":59}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/middleware/default/03-logger.ts","sources":["/app/app/middleware/default/03-logger.ts"],"names":[],"mappings":";;AAAA,mCAAoC;AACpC,OAAO,CAAC,IAAI,GAAG,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,EAAjB,CAAiB,CAAC","sourcesContent":["import * as logger from 'koa-logger'\nexports.init = (app) => app.use(logger());\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"182ea5aacdd8c0b42c49914cc52e868f62c5fb2f","contentHash":"4cc5f4425a510334a0bd7a7cdc53efe791dbea14afcc5f1e90afb0458f434bb6"},"/app/app/middleware/default/04-errors.ts":{"path":"/app/app/middleware/default/04-errors.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":9,"column":1}},"1":{"start":{"line":2,"column":28},"end":{"line":2,"column":110}},"2":{"start":{"line":2,"column":91},"end":{"line":2,"column":106}},"3":{"start":{"line":3,"column":4},"end":{"line":8,"column":7}},"4":{"start":{"line":4,"column":36},"end":{"line":4,"column":97}},"5":{"start":{"line":4,"column":42},"end":{"line":4,"column":70}},"6":{"start":{"line":4,"column":85},"end":{"line":4,"column":95}},"7":{"start":{"line":5,"column":35},"end":{"line":5,"column":100}},"8":{"start":{"line":5,"column":41},"end":{"line":5,"column":73}},"9":{"start":{"line":5,"column":88},"end":{"line":5,"column":98}},"10":{"start":{"line":6,"column":32},"end":{"line":6,"column":116}},"11":{"start":{"line":7,"column":8},"end":{"line":7,"column":78}},"12":{"start":{"line":10,"column":18},"end":{"line":36,"column":1}},"13":{"start":{"line":11,"column":12},"end":{"line":11,"column":104}},"14":{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},"15":{"start":{"line":11,"column":57},"end":{"line":11,"column":68}},"16":{"start":{"line":11,"column":69},"end":{"line":11,"column":81}},"17":{"start":{"line":12,"column":4},"end":{"line":12,"column":157}},"18":{"start":{"line":12,"column":138},"end":{"line":12,"column":150}},"19":{"start":{"line":13,"column":23},"end":{"line":13,"column":68}},"20":{"start":{"line":13,"column":45},"end":{"line":13,"column":65}},"21":{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},"22":{"start":{"line":15,"column":15},"end":{"line":15,"column":70}},"23":{"start":{"line":16,"column":8},"end":{"line":33,"column":66}},"24":{"start":{"line":16,"column":18},"end":{"line":33,"column":66}},"25":{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},"26":{"start":{"line":17,"column":160},"end":{"line":17,"column":169}},"27":{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},"28":{"start":{"line":18,"column":26},"end":{"line":18,"column":52}},"29":{"start":{"line":19,"column":12},"end":{"line":31,"column":13}},"30":{"start":{"line":20,"column":32},"end":{"line":20,"column":39}},"31":{"start":{"line":20,"column":40},"end":{"line":20,"column":46}},"32":{"start":{"line":21,"column":24},"end":{"line":21,"column":34}},"33":{"start":{"line":21,"column":35},"end":{"line":21,"column":72}},"34":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"35":{"start":{"line":22,"column":35},"end":{"line":22,"column":45}},"36":{"start":{"line":22,"column":46},"end":{"line":22,"column":55}},"37":{"start":{"line":22,"column":56},"end":{"line":22,"column":65}},"38":{"start":{"line":23,"column":24},"end":{"line":23,"column":41}},"39":{"start":{"line":23,"column":42},"end":{"line":23,"column":55}},"40":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"41":{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},"42":{"start":{"line":25,"column":110},"end":{"line":25,"column":116}},"43":{"start":{"line":25,"column":117},"end":{"line":25,"column":126}},"44":{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},"45":{"start":{"line":26,"column":81},"end":{"line":26,"column":97}},"46":{"start":{"line":26,"column":98},"end":{"line":26,"column":104}},"47":{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},"48":{"start":{"line":27,"column":57},"end":{"line":27,"column":72}},"49":{"start":{"line":27,"column":73},"end":{"line":27,"column":80}},"50":{"start":{"line":27,"column":81},"end":{"line":27,"column":87}},"51":{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},"52":{"start":{"line":28,"column":47},"end":{"line":28,"column":62}},"53":{"start":{"line":28,"column":63},"end":{"line":28,"column":78}},"54":{"start":{"line":28,"column":79},"end":{"line":28,"column":85}},"55":{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},"56":{"start":{"line":29,"column":30},"end":{"line":29,"column":42}},"57":{"start":{"line":30,"column":20},"end":{"line":30,"column":33}},"58":{"start":{"line":30,"column":34},"end":{"line":30,"column":43}},"59":{"start":{"line":32,"column":12},"end":{"line":32,"column":39}},"60":{"start":{"line":33,"column":22},"end":{"line":33,"column":34}},"61":{"start":{"line":33,"column":35},"end":{"line":33,"column":41}},"62":{"start":{"line":33,"column":54},"end":{"line":33,"column":64}},"63":{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},"64":{"start":{"line":34,"column":23},"end":{"line":34,"column":35}},"65":{"start":{"line":34,"column":36},"end":{"line":34,"column":89}},"66":{"start":{"line":37,"column":12},"end":{"line":37,"column":16}},"67":{"start":{"line":38,"column":0},"end":{"line":63,"column":2}},"68":{"start":{"line":39,"column":4},"end":{"line":62,"column":11}},"69":{"start":{"line":39,"column":42},"end":{"line":62,"column":7}},"70":{"start":{"line":41,"column":8},"end":{"line":61,"column":11}},"71":{"start":{"line":42,"column":12},"end":{"line":60,"column":13}},"72":{"start":{"line":44,"column":20},"end":{"line":44,"column":46}},"73":{"start":{"line":45,"column":20},"end":{"line":45,"column":49}},"74":{"start":{"line":47,"column":20},"end":{"line":47,"column":30}},"75":{"start":{"line":48,"column":20},"end":{"line":48,"column":44}},"76":{"start":{"line":50,"column":20},"end":{"line":50,"column":36}},"77":{"start":{"line":51,"column":20},"end":{"line":51,"column":51}},"78":{"start":{"line":52,"column":20},"end":{"line":52,"column":47}},"79":{"start":{"line":53,"column":20},"end":{"line":53,"column":55}},"80":{"start":{"line":54,"column":20},"end":{"line":56,"column":21}},"81":{"start":{"line":55,"column":24},"end":{"line":55,"column":64}},"82":{"start":{"line":57,"column":20},"end":{"line":57,"column":40}},"83":{"start":{"line":58,"column":20},"end":{"line":58,"column":71}},"84":{"start":{"line":59,"column":24},"end":{"line":59,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":44},"end":{"line":1,"column":45}},"loc":{"start":{"line":1,"column":89},"end":{"line":9,"column":1}},"line":1},"1":{"name":"adopt","decl":{"start":{"line":2,"column":13},"end":{"line":2,"column":18}},"loc":{"start":{"line":2,"column":26},"end":{"line":2,"column":112}},"line":2},"2":{"name":"(anonymous_2)","decl":{"start":{"line":2,"column":70},"end":{"line":2,"column":71}},"loc":{"start":{"line":2,"column":89},"end":{"line":2,"column":108}},"line":2},"3":{"name":"(anonymous_3)","decl":{"start":{"line":3,"column":36},"end":{"line":3,"column":37}},"loc":{"start":{"line":3,"column":63},"end":{"line":8,"column":5}},"line":3},"4":{"name":"fulfilled","decl":{"start":{"line":4,"column":17},"end":{"line":4,"column":26}},"loc":{"start":{"line":4,"column":34},"end":{"line":4,"column":99}},"line":4},"5":{"name":"rejected","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":25}},"loc":{"start":{"line":5,"column":33},"end":{"line":5,"column":102}},"line":5},"6":{"name":"step","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":21}},"loc":{"start":{"line":6,"column":30},"end":{"line":6,"column":118}},"line":6},"7":{"name":"(anonymous_7)","decl":{"start":{"line":10,"column":48},"end":{"line":10,"column":49}},"loc":{"start":{"line":10,"column":73},"end":{"line":36,"column":1}},"line":10},"8":{"name":"(anonymous_8)","decl":{"start":{"line":11,"column":30},"end":{"line":11,"column":31}},"loc":{"start":{"line":11,"column":41},"end":{"line":11,"column":83}},"line":11},"9":{"name":"(anonymous_9)","decl":{"start":{"line":12,"column":125},"end":{"line":12,"column":126}},"loc":{"start":{"line":12,"column":136},"end":{"line":12,"column":152}},"line":12},"10":{"name":"verb","decl":{"start":{"line":13,"column":13},"end":{"line":13,"column":17}},"loc":{"start":{"line":13,"column":21},"end":{"line":13,"column":70}},"line":13},"11":{"name":"(anonymous_11)","decl":{"start":{"line":13,"column":30},"end":{"line":13,"column":31}},"loc":{"start":{"line":13,"column":43},"end":{"line":13,"column":67}},"line":13},"12":{"name":"step","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":22},"end":{"line":35,"column":5}},"line":14},"13":{"name":"(anonymous_13)","decl":{"start":{"line":38,"column":15},"end":{"line":38,"column":16}},"loc":{"start":{"line":38,"column":30},"end":{"line":63,"column":1}},"line":38},"14":{"name":"(anonymous_14)","decl":{"start":{"line":39,"column":19},"end":{"line":39,"column":20}},"loc":{"start":{"line":39,"column":40},"end":{"line":62,"column":9}},"line":39},"15":{"name":"(anonymous_15)","decl":{"start":{"line":39,"column":82},"end":{"line":39,"column":83}},"loc":{"start":{"line":39,"column":94},"end":{"line":62,"column":5}},"line":39},"16":{"name":"(anonymous_16)","decl":{"start":{"line":41,"column":33},"end":{"line":41,"column":34}},"loc":{"start":{"line":41,"column":47},"end":{"line":61,"column":9}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":1,"column":16},"end":{"line":9,"column":1}},"type":"binary-expr","locations":[{"start":{"line":1,"column":17},"end":{"line":1,"column":21}},{"start":{"line":1,"column":25},"end":{"line":1,"column":39}},{"start":{"line":1,"column":44},"end":{"line":9,"column":1}}],"line":1},"1":{"loc":{"start":{"line":2,"column":35},"end":{"line":2,"column":109}},"type":"cond-expr","locations":[{"start":{"line":2,"column":56},"end":{"line":2,"column":61}},{"start":{"line":2,"column":64},"end":{"line":2,"column":109}}],"line":2},"2":{"loc":{"start":{"line":3,"column":16},"end":{"line":3,"column":34}},"type":"binary-expr","locations":[{"start":{"line":3,"column":16},"end":{"line":3,"column":17}},{"start":{"line":3,"column":22},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":6,"column":32},"end":{"line":6,"column":115}},"type":"cond-expr","locations":[{"start":{"line":6,"column":46},"end":{"line":6,"column":67}},{"start":{"line":6,"column":70},"end":{"line":6,"column":115}}],"line":6},"4":{"loc":{"start":{"line":7,"column":51},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":51},"end":{"line":7,"column":61}},{"start":{"line":7,"column":65},"end":{"line":7,"column":67}}],"line":7},"5":{"loc":{"start":{"line":10,"column":18},"end":{"line":36,"column":1}},"type":"binary-expr","locations":[{"start":{"line":10,"column":19},"end":{"line":10,"column":23}},{"start":{"line":10,"column":27},"end":{"line":10,"column":43}},{"start":{"line":10,"column":48},"end":{"line":36,"column":1}}],"line":10},"6":{"loc":{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},"type":"if","locations":[{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},{"start":{"line":11,"column":43},"end":{"line":11,"column":68}}],"line":11},"7":{"loc":{"start":{"line":12,"column":71},"end":{"line":12,"column":153}},"type":"binary-expr","locations":[{"start":{"line":12,"column":71},"end":{"line":12,"column":99}},{"start":{"line":12,"column":104},"end":{"line":12,"column":152}}],"line":12},"8":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},{"start":{"line":15,"column":8},"end":{"line":15,"column":70}}],"line":15},"9":{"loc":{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},{"start":{"line":17,"column":12},"end":{"line":17,"column":169}}],"line":17},"10":{"loc":{"start":{"line":17,"column":23},"end":{"line":17,"column":158}},"type":"binary-expr","locations":[{"start":{"line":17,"column":23},"end":{"line":17,"column":24}},{"start":{"line":17,"column":29},"end":{"line":17,"column":125}},{"start":{"line":17,"column":130},"end":{"line":17,"column":158}}],"line":17},"11":{"loc":{"start":{"line":17,"column":33},"end":{"line":17,"column":125}},"type":"cond-expr","locations":[{"start":{"line":17,"column":45},"end":{"line":17,"column":56}},{"start":{"line":17,"column":59},"end":{"line":17,"column":125}}],"line":17},"12":{"loc":{"start":{"line":17,"column":59},"end":{"line":17,"column":125}},"type":"cond-expr","locations":[{"start":{"line":17,"column":67},"end":{"line":17,"column":116}},{"start":{"line":17,"column":119},"end":{"line":17,"column":125}}],"line":17},"13":{"loc":{"start":{"line":17,"column":67},"end":{"line":17,"column":116}},"type":"binary-expr","locations":[{"start":{"line":17,"column":67},"end":{"line":17,"column":77}},{"start":{"line":17,"column":82},"end":{"line":17,"column":115}}],"line":17},"14":{"loc":{"start":{"line":17,"column":82},"end":{"line":17,"column":112}},"type":"binary-expr","locations":[{"start":{"line":17,"column":83},"end":{"line":17,"column":98}},{"start":{"line":17,"column":103},"end":{"line":17,"column":112}}],"line":17},"15":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},{"start":{"line":18,"column":12},"end":{"line":18,"column":52}}],"line":18},"16":{"loc":{"start":{"line":19,"column":12},"end":{"line":31,"column":13}},"type":"switch","locations":[{"start":{"line":20,"column":16},"end":{"line":20,"column":23}},{"start":{"line":20,"column":24},"end":{"line":20,"column":46}},{"start":{"line":21,"column":16},"end":{"line":21,"column":72}},{"start":{"line":22,"column":16},"end":{"line":22,"column":65}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":30,"column":43}}],"line":19},"17":{"loc":{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},"type":"if","locations":[{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},{"start":{"line":25,"column":20},"end":{"line":25,"column":128}}],"line":25},"18":{"loc":{"start":{"line":25,"column":24},"end":{"line":25,"column":106}},"type":"binary-expr","locations":[{"start":{"line":25,"column":24},"end":{"line":25,"column":74}},{"start":{"line":25,"column":79},"end":{"line":25,"column":90}},{"start":{"line":25,"column":94},"end":{"line":25,"column":105}}],"line":25},"19":{"loc":{"start":{"line":25,"column":42},"end":{"line":25,"column":73}},"type":"binary-expr","locations":[{"start":{"line":25,"column":42},"end":{"line":25,"column":54}},{"start":{"line":25,"column":58},"end":{"line":25,"column":73}}],"line":25},"20":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},{"start":{"line":26,"column":20},"end":{"line":26,"column":106}}],"line":26},"21":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":77}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":35}},{"start":{"line":26,"column":40},"end":{"line":26,"column":42}},{"start":{"line":26,"column":47},"end":{"line":26,"column":59}},{"start":{"line":26,"column":63},"end":{"line":26,"column":75}}],"line":26},"22":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},{"start":{"line":27,"column":20},"end":{"line":27,"column":89}}],"line":27},"23":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":53}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":39},"end":{"line":27,"column":53}}],"line":27},"24":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},{"start":{"line":28,"column":20},"end":{"line":28,"column":87}}],"line":28},"25":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":43}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":25}},{"start":{"line":28,"column":29},"end":{"line":28,"column":43}}],"line":28},"26":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},{"start":{"line":29,"column":20},"end":{"line":29,"column":42}}],"line":29},"27":{"loc":{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},{"start":{"line":34,"column":8},"end":{"line":34,"column":35}}],"line":34},"28":{"loc":{"start":{"line":34,"column":52},"end":{"line":34,"column":74}},"type":"cond-expr","locations":[{"start":{"line":34,"column":60},"end":{"line":34,"column":65}},{"start":{"line":34,"column":68},"end":{"line":34,"column":74}}],"line":34},"29":{"loc":{"start":{"line":42,"column":12},"end":{"line":60,"column":13}},"type":"switch","locations":[{"start":{"line":43,"column":16},"end":{"line":45,"column":49}},{"start":{"line":46,"column":16},"end":{"line":48,"column":44}},{"start":{"line":49,"column":16},"end":{"line":58,"column":71}},{"start":{"line":59,"column":16},"end":{"line":59,"column":46}}],"line":42},"30":{"loc":{"start":{"line":54,"column":20},"end":{"line":56,"column":21}},"type":"if","locations":[{"start":{"line":54,"column":20},"end":{"line":56,"column":21}},{"start":{"line":54,"column":20},"end":{"line":56,"column":21}}],"line":54}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0,0,0],"30":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/middleware/default/04-errors.ts","sources":["/app/app/middleware/default/04-errors.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,iBAeA;AAfA,OAAO,CAAC,IAAI,GAAG,UAAC,GAAG;IACf,OAAA,GAAG,CAAC,GAAG,CAAC,UAAO,GAAG,EAAE,IAAI;;;;;;oBAEhB,qBAAM,IAAI,EAAE,EAAA;;oBAAZ,SAAY,CAAC;;;;oBAEb,OAAO,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;oBAC/B,OAAO,CAAC,KAAK,CAAC,GAAC,CAAC,OAAO,CAAC,CAAC;oBACzB,OAAO,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC;oBACnC,IAAG,CAAC,GAAC,CAAC,UAAU,EAAE;wBACd,sBAAO,GAAG,CAAC,MAAM,GAAG,GAAG,EAAA;qBAC1B;oBACD,GAAG,CAAC,IAAI,GAAG,GAAC,CAAC,IAAI,CAAA;oBACjB,sBAAO,GAAG,CAAC,MAAM,GAAG,GAAC,CAAC,UAAU,EAAA;;;;SAEvC,CAAC;AAbF,CAaE,CAAC","sourcesContent":["exports.init = (app) =>\n    app.use(async (ctx, next) => {\n        try {\n            await next();\n        } catch (e) {\n            console.error(`ERROR MESSAGE`);\n            console.error(e.message);\n            console.error(`END ERROR MESSAGE`);\n            if(!e.httpStatus) {\n                return ctx.status = 500\n            }\n            ctx.body = e.body\n            return ctx.status = e.httpStatus\n        }\n    });\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2a6dd7b109b68d5aa23c847943d84487beaa148e","contentHash":"40bfe480506b9d6f9ee6e38864e5cb09a49e9abbbe31aee12a8dec0f02764f61"},"/app/app/middleware/default/07-bodyParser.ts":{"path":"/app/app/middleware/default/07-bodyParser.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":17},"end":{"line":3,"column":42}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":7}},"3":{"start":{"line":4,"column":32},"end":{"line":6,"column":4}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":30},"end":{"line":6,"column":6}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/middleware/default/07-bodyParser.ts","sources":["/app/app/middleware/default/07-bodyParser.ts"],"names":[],"mappings":";;AAAA,2CAA4C;AAC5C,OAAO,CAAC,IAAI,GAAG,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC;IACzC,SAAS,EAAE,MAAM;CAClB,CAAC,CAAC,EAFqB,CAErB,CAAC","sourcesContent":["import * as bodyParser from 'koa-bodyparser'\nexports.init = (app) => app.use(bodyParser({\n  jsonLimit: '56kb',\n}));\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ff93f8caf59138b040f30358c144fcd99ce7ae8b","contentHash":"9d3e083d08e0bb7436d6894f30000130bcbfeda2f5c8728daeb35b29a3d8ef17"},"/app/app/middleware/default/13-coors.ts":{"path":"/app/app/middleware/default/13-coors.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":11},"end":{"line":3,"column":31}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":58}},"3":{"start":{"line":4,"column":32},"end":{"line":4,"column":55}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":30},"end":{"line":4,"column":57}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/middleware/default/13-coors.ts","sources":["/app/app/middleware/default/13-coors.ts"],"names":[],"mappings":";;AAAA,gCAAiC;AACjC,OAAO,CAAC,IAAI,GAAG,UAAC,GAAG,IAAK,OAAA,GAAG,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,EAAf,CAAe,CAAC","sourcesContent":["import * as cors from 'koa2-cors'\nexports.init = (app) => app.use(cors());\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2e2a897b25ca5cffa19f8f7795f9764b522c0093","contentHash":"808278eb885a2c518d041f0df5d795ea3b3d45134b46caa5468c79571c85a527"},"/app/app/routes/auth.ts":{"path":"/app/app/routes/auth.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":13},"end":{"line":4,"column":43}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":48}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":200}},"6":{"start":{"line":8,"column":25},"end":{"line":8,"column":100}},"7":{"start":{"line":9,"column":0},"end":{"line":19,"column":82}},"8":{"start":{"line":20,"column":0},"end":{"line":20,"column":28}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/routes/auth.ts","sources":["/app/app/routes/auth.ts"],"names":[],"mappings":";;AAAA,mCAAoC;AACpC,4CAAgD;AAChD,6CAAuC;AACvC,IAAM,UAAU,GAAG,IAAI,MAAM,CAAC,EAAC,MAAM,EAAE,OAAO,EAAC,CAAC,CAAA;AAChD,IAAM,WAAW,GAAG,kBAAQ,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAC,KAAK,EAAE,CAAC,QAAQ,EAAE,kDAAkD,EAAE,gDAAgD,CAAC,EAAE,OAAO,EAAE,KAAK,EAAC,CAAC,CAAC;AAC/L,IAAM,kBAAkB,GAAG,kBAAQ,CAAC,YAAY,CAAC,CAAC,KAAK,EAAE,aAAa,CAAC,EAAE,EAAC,OAAO,EAAE,KAAK,EAAC,CAAC,CAAA;AAE1F,UAAU;KACL,GAAG,CAAC,sBAAsB,EAAE,cAAc,CAAC,YAAY,CAAC;KACxD,IAAI,CAAC,eAAe,EAAE,cAAc,CAAC,YAAY,CAAC;KAClD,IAAI,CAAC,kBAAkB,EAAE,cAAc,CAAC,cAAc,CAAC;KACvD,IAAI,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,cAAc,CAAC,cAAc,CAAC;KAC3E,IAAI,CAAC,QAAQ,EAAE,cAAc,CAAC,KAAK,CAAC;KACpC,IAAI,CAAC,SAAS,EAAE,cAAc,CAAC,MAAM,CAAC;KACtC,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC;KAC3B,GAAG,CAAC,OAAO,EAAE,kBAAkB,EAAE,cAAc,CAAC,IAAI,CAAC;KACrD,GAAG,CAAC,wBAAwB,EAAE,WAAW,EAAE,cAAc,CAAC,WAAW,CAAC;KACtE,GAAG,CAAC,uBAAuB,EAAE,WAAW,EAAE,cAAc,CAAC,kBAAkB,CAAC,CAAA;AAEjF,MAAM,CAAC,OAAO,GAAG,UAAU,CAAC","sourcesContent":["import * as Router from 'koa-router'\nimport authController from '../controllers/auth'\nimport passport from '../libs/passport'\nconst authRoutes = new Router({prefix: '/auth'})\nconst googleScope = passport.authenticate('google', {scope: ['openid', 'https://www.googleapis.com/auth/userinfo.profile', 'https://www.googleapis.com/auth/userinfo.email'], session: false});\nconst passportMiddleware = passport.authenticate(['jwt', 'jwt-refresh'], {session: false})\n\nauthRoutes\n    .get('/confirm-email/:hash', authController.confirmEmail)\n    .post('/registration', authController.registration)\n    .post('/forgot-password', authController.forgotPassword)\n    .post('/change-password', passportMiddleware, authController.changePassword)\n    .post('/login', authController.login)\n    .post('/logout', authController.logout)\n    .get('/google', googleScope)\n    .get('/ping', passportMiddleware, authController.ping)\n    .get('/google/oauth/callback', googleScope, authController.googleOAuth)\n    .get('/gmail/oauth/callback', googleScope, authController.gmailOAuthCallback)\n\nmodule.exports = authRoutes;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"74b33db84d6c86eccf0b04cd08d9a4ed02ef5d95","contentHash":"d41e828f5fccefbd4e59ef9cfd1cf089604245d2bfc3c729dd4156172e72a208"},"/app/app/controllers/auth.ts":{"path":"/app/app/controllers/auth.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":18},"end":{"line":39,"column":45}},"68":{"start":{"line":40,"column":14},"end":{"line":40,"column":42}},"69":{"start":{"line":41,"column":15},"end":{"line":41,"column":45}},"70":{"start":{"line":42,"column":21},"end":{"line":197,"column":1}},"71":{"start":{"line":44,"column":8},"end":{"line":57,"column":11}},"72":{"start":{"line":46,"column":12},"end":{"line":56,"column":15}},"73":{"start":{"line":47,"column":16},"end":{"line":55,"column":17}},"74":{"start":{"line":49,"column":24},"end":{"line":49,"column":55}},"75":{"start":{"line":50,"column":24},"end":{"line":50,"column":85}},"76":{"start":{"line":52,"column":24},"end":{"line":52,"column":34}},"77":{"start":{"line":53,"column":24},"end":{"line":53,"column":41}},"78":{"start":{"line":54,"column":24},"end":{"line":54,"column":46}},"79":{"start":{"line":60,"column":8},"end":{"line":73,"column":11}},"80":{"start":{"line":62,"column":12},"end":{"line":72,"column":15}},"81":{"start":{"line":63,"column":16},"end":{"line":71,"column":17}},"82":{"start":{"line":65,"column":24},"end":{"line":65,"column":45}},"83":{"start":{"line":66,"column":24},"end":{"line":66,"column":108}},"84":{"start":{"line":68,"column":24},"end":{"line":68,"column":34}},"85":{"start":{"line":69,"column":24},"end":{"line":69,"column":41}},"86":{"start":{"line":70,"column":24},"end":{"line":70,"column":46}},"87":{"start":{"line":76,"column":8},"end":{"line":89,"column":11}},"88":{"start":{"line":78,"column":12},"end":{"line":88,"column":15}},"89":{"start":{"line":79,"column":16},"end":{"line":87,"column":17}},"90":{"start":{"line":81,"column":24},"end":{"line":81,"column":104}},"91":{"start":{"line":82,"column":24},"end":{"line":82,"column":128}},"92":{"start":{"line":84,"column":24},"end":{"line":84,"column":34}},"93":{"start":{"line":85,"column":24},"end":{"line":85,"column":41}},"94":{"start":{"line":86,"column":24},"end":{"line":86,"column":46}},"95":{"start":{"line":92,"column":8},"end":{"line":114,"column":11}},"96":{"start":{"line":94,"column":12},"end":{"line":113,"column":15}},"97":{"start":{"line":95,"column":16},"end":{"line":112,"column":17}},"98":{"start":{"line":97,"column":24},"end":{"line":97,"column":88}},"99":{"start":{"line":98,"column":24},"end":{"line":98,"column":110}},"100":{"start":{"line":100,"column":24},"end":{"line":100,"column":41}},"101":{"start":{"line":101,"column":24},"end":{"line":103,"column":25}},"102":{"start":{"line":102,"column":28},"end":{"line":102,"column":58}},"103":{"start":{"line":104,"column":24},"end":{"line":106,"column":25}},"104":{"start":{"line":105,"column":28},"end":{"line":105,"column":62}},"105":{"start":{"line":107,"column":24},"end":{"line":107,"column":86}},"106":{"start":{"line":109,"column":24},"end":{"line":109,"column":34}},"107":{"start":{"line":110,"column":24},"end":{"line":110,"column":61}},"108":{"start":{"line":111,"column":24},"end":{"line":111,"column":46}},"109":{"start":{"line":117,"column":8},"end":{"line":124,"column":11}},"110":{"start":{"line":118,"column":12},"end":{"line":123,"column":15}},"111":{"start":{"line":119,"column":16},"end":{"line":119,"column":47}},"112":{"start":{"line":120,"column":16},"end":{"line":120,"column":54}},"113":{"start":{"line":121,"column":16},"end":{"line":121,"column":33}},"114":{"start":{"line":122,"column":16},"end":{"line":122,"column":38}},"115":{"start":{"line":127,"column":8},"end":{"line":144,"column":11}},"116":{"start":{"line":129,"column":12},"end":{"line":143,"column":15}},"117":{"start":{"line":130,"column":16},"end":{"line":142,"column":17}},"118":{"start":{"line":131,"column":28},"end":{"line":131,"column":92}},"119":{"start":{"line":133,"column":24},"end":{"line":133,"column":41}},"120":{"start":{"line":134,"column":24},"end":{"line":136,"column":25}},"121":{"start":{"line":135,"column":28},"end":{"line":135,"column":69}},"122":{"start":{"line":137,"column":24},"end":{"line":137,"column":102}},"123":{"start":{"line":138,"column":24},"end":{"line":138,"column":86}},"124":{"start":{"line":140,"column":24},"end":{"line":140,"column":34}},"125":{"start":{"line":141,"column":24},"end":{"line":141,"column":79}},"126":{"start":{"line":147,"column":8},"end":{"line":152,"column":11}},"127":{"start":{"line":148,"column":12},"end":{"line":151,"column":15}},"128":{"start":{"line":149,"column":16},"end":{"line":149,"column":33}},"129":{"start":{"line":150,"column":16},"end":{"line":150,"column":56}},"130":{"start":{"line":155,"column":8},"end":{"line":187,"column":11}},"131":{"start":{"line":157,"column":12},"end":{"line":186,"column":15}},"132":{"start":{"line":158,"column":16},"end":{"line":185,"column":17}},"133":{"start":{"line":160,"column":24},"end":{"line":160,"column":61}},"134":{"start":{"line":161,"column":24},"end":{"line":161,"column":56}},"135":{"start":{"line":162,"column":24},"end":{"line":169,"column":25}},"136":{"start":{"line":163,"column":28},"end":{"line":163,"column":65}},"137":{"start":{"line":164,"column":28},"end":{"line":164,"column":60}},"138":{"start":{"line":167,"column":28},"end":{"line":167,"column":63}},"139":{"start":{"line":168,"column":28},"end":{"line":168,"column":36}},"140":{"start":{"line":170,"column":24},"end":{"line":170,"column":90}},"141":{"start":{"line":172,"column":24},"end":{"line":172,"column":41}},"142":{"start":{"line":173,"column":24},"end":{"line":173,"column":69}},"143":{"start":{"line":174,"column":24},"end":{"line":174,"column":60}},"144":{"start":{"line":174,"column":36},"end":{"line":174,"column":60}},"145":{"start":{"line":175,"column":24},"end":{"line":175,"column":67}},"146":{"start":{"line":176,"column":24},"end":{"line":176,"column":108}},"147":{"start":{"line":178,"column":24},"end":{"line":178,"column":41}},"148":{"start":{"line":179,"column":24},"end":{"line":179,"column":37}},"149":{"start":{"line":180,"column":28},"end":{"line":180,"column":90}},"150":{"start":{"line":182,"column":24},"end":{"line":182,"column":34}},"151":{"start":{"line":183,"column":24},"end":{"line":183,"column":92}},"152":{"start":{"line":184,"column":24},"end":{"line":184,"column":79}},"153":{"start":{"line":190,"column":8},"end":{"line":195,"column":11}},"154":{"start":{"line":191,"column":12},"end":{"line":194,"column":15}},"155":{"start":{"line":192,"column":16},"end":{"line":192,"column":33}},"156":{"start":{"line":193,"column":16},"end":{"line":193,"column":38}},"157":{"start":{"line":198,"column":0},"end":{"line":198,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"(anonymous_13)","decl":{"start":{"line":43,"column":20},"end":{"line":43,"column":21}},"loc":{"start":{"line":43,"column":35},"end":{"line":58,"column":5}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":44,"column":47},"end":{"line":44,"column":48}},"loc":{"start":{"line":44,"column":59},"end":{"line":57,"column":9}},"line":44},"15":{"name":"(anonymous_15)","decl":{"start":{"line":46,"column":37},"end":{"line":46,"column":38}},"loc":{"start":{"line":46,"column":51},"end":{"line":56,"column":13}},"line":46},"16":{"name":"(anonymous_16)","decl":{"start":{"line":59,"column":20},"end":{"line":59,"column":21}},"loc":{"start":{"line":59,"column":35},"end":{"line":74,"column":5}},"line":59},"17":{"name":"(anonymous_17)","decl":{"start":{"line":60,"column":47},"end":{"line":60,"column":48}},"loc":{"start":{"line":60,"column":59},"end":{"line":73,"column":9}},"line":60},"18":{"name":"(anonymous_18)","decl":{"start":{"line":62,"column":37},"end":{"line":62,"column":38}},"loc":{"start":{"line":62,"column":51},"end":{"line":72,"column":13}},"line":62},"19":{"name":"(anonymous_19)","decl":{"start":{"line":75,"column":18},"end":{"line":75,"column":19}},"loc":{"start":{"line":75,"column":33},"end":{"line":90,"column":5}},"line":75},"20":{"name":"(anonymous_20)","decl":{"start":{"line":76,"column":47},"end":{"line":76,"column":48}},"loc":{"start":{"line":76,"column":59},"end":{"line":89,"column":9}},"line":76},"21":{"name":"(anonymous_21)","decl":{"start":{"line":78,"column":37},"end":{"line":78,"column":38}},"loc":{"start":{"line":78,"column":51},"end":{"line":88,"column":13}},"line":78},"22":{"name":"(anonymous_22)","decl":{"start":{"line":91,"column":11},"end":{"line":91,"column":12}},"loc":{"start":{"line":91,"column":26},"end":{"line":115,"column":5}},"line":91},"23":{"name":"(anonymous_23)","decl":{"start":{"line":92,"column":47},"end":{"line":92,"column":48}},"loc":{"start":{"line":92,"column":59},"end":{"line":114,"column":9}},"line":92},"24":{"name":"(anonymous_24)","decl":{"start":{"line":94,"column":37},"end":{"line":94,"column":38}},"loc":{"start":{"line":94,"column":51},"end":{"line":113,"column":13}},"line":94},"25":{"name":"(anonymous_25)","decl":{"start":{"line":116,"column":12},"end":{"line":116,"column":13}},"loc":{"start":{"line":116,"column":27},"end":{"line":125,"column":5}},"line":116},"26":{"name":"(anonymous_26)","decl":{"start":{"line":117,"column":47},"end":{"line":117,"column":48}},"loc":{"start":{"line":117,"column":59},"end":{"line":124,"column":9}},"line":117},"27":{"name":"(anonymous_27)","decl":{"start":{"line":118,"column":37},"end":{"line":118,"column":38}},"loc":{"start":{"line":118,"column":51},"end":{"line":123,"column":13}},"line":118},"28":{"name":"(anonymous_28)","decl":{"start":{"line":126,"column":18},"end":{"line":126,"column":19}},"loc":{"start":{"line":126,"column":33},"end":{"line":145,"column":5}},"line":126},"29":{"name":"(anonymous_29)","decl":{"start":{"line":127,"column":47},"end":{"line":127,"column":48}},"loc":{"start":{"line":127,"column":59},"end":{"line":144,"column":9}},"line":127},"30":{"name":"(anonymous_30)","decl":{"start":{"line":129,"column":37},"end":{"line":129,"column":38}},"loc":{"start":{"line":129,"column":51},"end":{"line":143,"column":13}},"line":129},"31":{"name":"(anonymous_31)","decl":{"start":{"line":146,"column":24},"end":{"line":146,"column":25}},"loc":{"start":{"line":146,"column":39},"end":{"line":153,"column":5}},"line":146},"32":{"name":"(anonymous_32)","decl":{"start":{"line":147,"column":47},"end":{"line":147,"column":48}},"loc":{"start":{"line":147,"column":59},"end":{"line":152,"column":9}},"line":147},"33":{"name":"(anonymous_33)","decl":{"start":{"line":148,"column":37},"end":{"line":148,"column":38}},"loc":{"start":{"line":148,"column":51},"end":{"line":151,"column":13}},"line":148},"34":{"name":"(anonymous_34)","decl":{"start":{"line":154,"column":17},"end":{"line":154,"column":18}},"loc":{"start":{"line":154,"column":32},"end":{"line":188,"column":5}},"line":154},"35":{"name":"(anonymous_35)","decl":{"start":{"line":155,"column":47},"end":{"line":155,"column":48}},"loc":{"start":{"line":155,"column":59},"end":{"line":187,"column":9}},"line":155},"36":{"name":"(anonymous_36)","decl":{"start":{"line":157,"column":37},"end":{"line":157,"column":38}},"loc":{"start":{"line":157,"column":51},"end":{"line":186,"column":13}},"line":157},"37":{"name":"(anonymous_37)","decl":{"start":{"line":189,"column":10},"end":{"line":189,"column":11}},"loc":{"start":{"line":189,"column":25},"end":{"line":196,"column":5}},"line":189},"38":{"name":"(anonymous_38)","decl":{"start":{"line":190,"column":47},"end":{"line":190,"column":48}},"loc":{"start":{"line":190,"column":59},"end":{"line":195,"column":9}},"line":190},"39":{"name":"(anonymous_39)","decl":{"start":{"line":191,"column":37},"end":{"line":191,"column":38}},"loc":{"start":{"line":191,"column":51},"end":{"line":194,"column":13}},"line":191}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":47,"column":16},"end":{"line":55,"column":17}},"type":"switch","locations":[{"start":{"line":48,"column":20},"end":{"line":50,"column":85}},{"start":{"line":51,"column":20},"end":{"line":54,"column":46}}],"line":47},"30":{"loc":{"start":{"line":63,"column":16},"end":{"line":71,"column":17}},"type":"switch","locations":[{"start":{"line":64,"column":20},"end":{"line":66,"column":108}},{"start":{"line":67,"column":20},"end":{"line":70,"column":46}}],"line":63},"31":{"loc":{"start":{"line":79,"column":16},"end":{"line":87,"column":17}},"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":82,"column":128}},{"start":{"line":83,"column":20},"end":{"line":86,"column":46}}],"line":79},"32":{"loc":{"start":{"line":95,"column":16},"end":{"line":112,"column":17}},"type":"switch","locations":[{"start":{"line":96,"column":20},"end":{"line":98,"column":110}},{"start":{"line":99,"column":20},"end":{"line":107,"column":86}},{"start":{"line":108,"column":20},"end":{"line":111,"column":46}}],"line":95},"33":{"loc":{"start":{"line":101,"column":24},"end":{"line":103,"column":25}},"type":"if","locations":[{"start":{"line":101,"column":24},"end":{"line":103,"column":25}},{"start":{"line":101,"column":24},"end":{"line":103,"column":25}}],"line":101},"34":{"loc":{"start":{"line":104,"column":24},"end":{"line":106,"column":25}},"type":"if","locations":[{"start":{"line":104,"column":24},"end":{"line":106,"column":25}},{"start":{"line":104,"column":24},"end":{"line":106,"column":25}}],"line":104},"35":{"loc":{"start":{"line":130,"column":16},"end":{"line":142,"column":17}},"type":"switch","locations":[{"start":{"line":131,"column":20},"end":{"line":131,"column":92}},{"start":{"line":132,"column":20},"end":{"line":138,"column":86}},{"start":{"line":139,"column":20},"end":{"line":141,"column":79}}],"line":130},"36":{"loc":{"start":{"line":134,"column":24},"end":{"line":136,"column":25}},"type":"if","locations":[{"start":{"line":134,"column":24},"end":{"line":136,"column":25}},{"start":{"line":134,"column":24},"end":{"line":136,"column":25}}],"line":134},"37":{"loc":{"start":{"line":158,"column":16},"end":{"line":185,"column":17}},"type":"switch","locations":[{"start":{"line":159,"column":20},"end":{"line":170,"column":90}},{"start":{"line":171,"column":20},"end":{"line":176,"column":108}},{"start":{"line":177,"column":20},"end":{"line":179,"column":37}},{"start":{"line":180,"column":20},"end":{"line":180,"column":90}},{"start":{"line":181,"column":20},"end":{"line":184,"column":79}}],"line":158},"38":{"loc":{"start":{"line":174,"column":24},"end":{"line":174,"column":60}},"type":"if","locations":[{"start":{"line":174,"column":24},"end":{"line":174,"column":60}},{"start":{"line":174,"column":24},"end":{"line":174,"column":60}}],"line":174}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0,0],"33":[0,0],"34":[0,0],"35":[0,0,0],"36":[0,0],"37":[0,0,0,0,0],"38":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/controllers/auth.ts","sources":["/app/app/controllers/auth.ts"],"names":[],"mappings":"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","sourcesContent":["import * as authService from '../services/auth'\nimport userService from '../services/users'\nimport { _ } from 'lodash'\nimport {EMAIL_NOT_VERIFIED, WRONG_PASSWORD} from '../templates/errors';\n\nconst authController = {\n\n  async forgotPassword(ctx)\n  {\n    const {email} = ctx.request.body;\n    await userService.sendNewPassword(email);\n    ctx.status = 200\n  },\n\n  async changePassword(ctx)\n  {\n    const {id} = ctx.req.user;\n    await userService.changePassword(ctx.request.body.password, id);\n    ctx.status = 200\n  },\n\n  async registration(ctx)\n  {\n    const {name, email, password} = ctx.request.body\n    await userService.createLocalUser({name, email, password});\n    ctx.status = 200;\n  },\n\n  async login(ctx)\n  {\n    const {email, password} = ctx.request.body;\n    const user = await userService.checkUser({email, password});\n    if (!user) { throw WRONG_PASSWORD }\n    if (!user.local.verified) { throw EMAIL_NOT_VERIFIED }\n    await authService.authenticateUser(user, ctx);\n    ctx.body = {name: user.local.name};\n  },\n\n  async logout(ctx)\n  {\n    ctx.cookies.set('token', null);\n    ctx.cookies.set('refreshToken', null);\n    ctx.status = 200\n  },\n\n  async confirmEmail(ctx)\n  {\n    const user = await authService.confirmEmail(ctx.params.hash);\n    if(!user) {return ctx.redirect('/')}\n    const base64data = authService.hashObject({name: user.local.name, type: 'local'});\n    await authService.authenticateUser(user, ctx);\n    return ctx.redirect(`/#${base64data}`)\n  },\n  async gmailOAuthCallback(ctx)\n  {\n    console.log(ctx);\n    return ctx.status = 200;\n  },\n  async googleOAuth(ctx)\n  {\n    let email: string = ctx.req.user.emails[0].value;\n    let name : string = ctx.req.user.displayName;\n    try {\n       email = ctx.req.user.emails[0].value;\n       name  = ctx.req.user.displayName;\n    } catch (e) {\n      console.log('failed obtain users');\n      throw e\n    }\n    let user = await userService.getGoogleUserByEmail(email)\n    console.log('found user via email '+ email);\n    if (!user) {\n      console.log('no user with email '+ email);\n      user = await userService.storeGoogleUser({name, email});\n    }\n    await authService.authenticateUser(user, ctx);\n    const base64data = authService.hashObject({name, type: 'google'});\n    return ctx.redirect(`/#${base64data}`)\n  },\n  async ping(ctx)\n  {\n    ctx.status = 200\n  }\n};\nexport default authController\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3ec838ce1c1ef629cbc4694cfeca25c15d765ef0","contentHash":"b6b87bee562e6ee5b3f29e810fa50d77e2cea98cb4fece89537ea5c545de8752"},"/app/app/services/users.ts":{"path":"/app/app/services/users.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":16},"end":{"line":39,"column":46}},"68":{"start":{"line":40,"column":13},"end":{"line":40,"column":32}},"69":{"start":{"line":41,"column":15},"end":{"line":41,"column":44}},"70":{"start":{"line":42,"column":18},"end":{"line":42,"column":45}},"71":{"start":{"line":44,"column":4},"end":{"line":57,"column":7}},"72":{"start":{"line":46,"column":8},"end":{"line":56,"column":11}},"73":{"start":{"line":47,"column":12},"end":{"line":55,"column":13}},"74":{"start":{"line":48,"column":24},"end":{"line":48,"column":93}},"75":{"start":{"line":50,"column":20},"end":{"line":50,"column":37}},"76":{"start":{"line":51,"column":20},"end":{"line":53,"column":21}},"77":{"start":{"line":52,"column":24},"end":{"line":52,"column":52}},"78":{"start":{"line":54,"column":20},"end":{"line":54,"column":48}},"79":{"start":{"line":60,"column":4},"end":{"line":67,"column":7}},"80":{"start":{"line":61,"column":8},"end":{"line":66,"column":11}},"81":{"start":{"line":62,"column":12},"end":{"line":65,"column":13}},"82":{"start":{"line":63,"column":24},"end":{"line":63,"column":90}},"83":{"start":{"line":64,"column":24},"end":{"line":64,"column":57}},"84":{"start":{"line":70,"column":4},"end":{"line":74,"column":7}},"85":{"start":{"line":71,"column":8},"end":{"line":73,"column":11}},"86":{"start":{"line":72,"column":12},"end":{"line":72,"column":73}},"87":{"start":{"line":77,"column":4},"end":{"line":81,"column":7}},"88":{"start":{"line":78,"column":8},"end":{"line":80,"column":11}},"89":{"start":{"line":79,"column":12},"end":{"line":79,"column":67}},"90":{"start":{"line":84,"column":4},"end":{"line":88,"column":7}},"91":{"start":{"line":85,"column":8},"end":{"line":87,"column":11}},"92":{"start":{"line":86,"column":12},"end":{"line":86,"column":73}},"93":{"start":{"line":91,"column":4},"end":{"line":110,"column":7}},"94":{"start":{"line":93,"column":8},"end":{"line":109,"column":11}},"95":{"start":{"line":94,"column":12},"end":{"line":108,"column":13}},"96":{"start":{"line":96,"column":20},"end":{"line":96,"column":74}},"97":{"start":{"line":97,"column":20},"end":{"line":97,"column":80}},"98":{"start":{"line":99,"column":20},"end":{"line":99,"column":37}},"99":{"start":{"line":100,"column":20},"end":{"line":102,"column":21}},"100":{"start":{"line":101,"column":24},"end":{"line":101,"column":46}},"101":{"start":{"line":103,"column":20},"end":{"line":103,"column":95}},"102":{"start":{"line":105,"column":20},"end":{"line":105,"column":30}},"103":{"start":{"line":106,"column":20},"end":{"line":106,"column":94}},"104":{"start":{"line":107,"column":24},"end":{"line":107,"column":57}},"105":{"start":{"line":113,"column":4},"end":{"line":130,"column":7}},"106":{"start":{"line":115,"column":8},"end":{"line":129,"column":11}},"107":{"start":{"line":116,"column":12},"end":{"line":128,"column":13}},"108":{"start":{"line":118,"column":20},"end":{"line":118,"column":50}},"109":{"start":{"line":119,"column":20},"end":{"line":119,"column":71}},"110":{"start":{"line":121,"column":20},"end":{"line":121,"column":34}},"111":{"start":{"line":122,"column":20},"end":{"line":122,"column":48}},"112":{"start":{"line":123,"column":20},"end":{"line":123,"column":88}},"113":{"start":{"line":125,"column":20},"end":{"line":125,"column":30}},"114":{"start":{"line":126,"column":20},"end":{"line":126,"column":46}},"115":{"start":{"line":127,"column":20},"end":{"line":127,"column":45}},"116":{"start":{"line":132,"column":0},"end":{"line":140,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"checkUser","decl":{"start":{"line":43,"column":9},"end":{"line":43,"column":18}},"loc":{"start":{"line":43,"column":29},"end":{"line":58,"column":1}},"line":43},"14":{"name":"(anonymous_14)","decl":{"start":{"line":44,"column":43},"end":{"line":44,"column":44}},"loc":{"start":{"line":44,"column":55},"end":{"line":57,"column":5}},"line":44},"15":{"name":"(anonymous_15)","decl":{"start":{"line":46,"column":33},"end":{"line":46,"column":34}},"loc":{"start":{"line":46,"column":47},"end":{"line":56,"column":9}},"line":46},"16":{"name":"changePassword","decl":{"start":{"line":59,"column":9},"end":{"line":59,"column":23}},"loc":{"start":{"line":59,"column":38},"end":{"line":68,"column":1}},"line":59},"17":{"name":"(anonymous_17)","decl":{"start":{"line":60,"column":43},"end":{"line":60,"column":44}},"loc":{"start":{"line":60,"column":55},"end":{"line":67,"column":5}},"line":60},"18":{"name":"(anonymous_18)","decl":{"start":{"line":61,"column":33},"end":{"line":61,"column":34}},"loc":{"start":{"line":61,"column":47},"end":{"line":66,"column":9}},"line":61},"19":{"name":"gerUserByEmail","decl":{"start":{"line":69,"column":9},"end":{"line":69,"column":23}},"loc":{"start":{"line":69,"column":31},"end":{"line":75,"column":1}},"line":69},"20":{"name":"(anonymous_20)","decl":{"start":{"line":70,"column":43},"end":{"line":70,"column":44}},"loc":{"start":{"line":70,"column":55},"end":{"line":74,"column":5}},"line":70},"21":{"name":"(anonymous_21)","decl":{"start":{"line":71,"column":33},"end":{"line":71,"column":34}},"loc":{"start":{"line":71,"column":47},"end":{"line":73,"column":9}},"line":71},"22":{"name":"storeGoogleUser","decl":{"start":{"line":76,"column":9},"end":{"line":76,"column":24}},"loc":{"start":{"line":76,"column":31},"end":{"line":82,"column":1}},"line":76},"23":{"name":"(anonymous_23)","decl":{"start":{"line":77,"column":43},"end":{"line":77,"column":44}},"loc":{"start":{"line":77,"column":55},"end":{"line":81,"column":5}},"line":77},"24":{"name":"(anonymous_24)","decl":{"start":{"line":78,"column":33},"end":{"line":78,"column":34}},"loc":{"start":{"line":78,"column":47},"end":{"line":80,"column":9}},"line":78},"25":{"name":"getGoogleUserByEmail","decl":{"start":{"line":83,"column":9},"end":{"line":83,"column":29}},"loc":{"start":{"line":83,"column":37},"end":{"line":89,"column":1}},"line":83},"26":{"name":"(anonymous_26)","decl":{"start":{"line":84,"column":43},"end":{"line":84,"column":44}},"loc":{"start":{"line":84,"column":55},"end":{"line":88,"column":5}},"line":84},"27":{"name":"(anonymous_27)","decl":{"start":{"line":85,"column":33},"end":{"line":85,"column":34}},"loc":{"start":{"line":85,"column":47},"end":{"line":87,"column":9}},"line":85},"28":{"name":"sendNewPassword","decl":{"start":{"line":90,"column":9},"end":{"line":90,"column":24}},"loc":{"start":{"line":90,"column":32},"end":{"line":111,"column":1}},"line":90},"29":{"name":"(anonymous_29)","decl":{"start":{"line":91,"column":43},"end":{"line":91,"column":44}},"loc":{"start":{"line":91,"column":55},"end":{"line":110,"column":5}},"line":91},"30":{"name":"(anonymous_30)","decl":{"start":{"line":93,"column":33},"end":{"line":93,"column":34}},"loc":{"start":{"line":93,"column":47},"end":{"line":109,"column":9}},"line":93},"31":{"name":"createLocalUser","decl":{"start":{"line":112,"column":9},"end":{"line":112,"column":24}},"loc":{"start":{"line":112,"column":31},"end":{"line":131,"column":1}},"line":112},"32":{"name":"(anonymous_32)","decl":{"start":{"line":113,"column":43},"end":{"line":113,"column":44}},"loc":{"start":{"line":113,"column":55},"end":{"line":130,"column":5}},"line":113},"33":{"name":"(anonymous_33)","decl":{"start":{"line":115,"column":33},"end":{"line":115,"column":34}},"loc":{"start":{"line":115,"column":47},"end":{"line":129,"column":9}},"line":115}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":47,"column":12},"end":{"line":55,"column":13}},"type":"switch","locations":[{"start":{"line":48,"column":16},"end":{"line":48,"column":93}},{"start":{"line":49,"column":16},"end":{"line":54,"column":48}}],"line":47},"30":{"loc":{"start":{"line":51,"column":20},"end":{"line":53,"column":21}},"type":"if","locations":[{"start":{"line":51,"column":20},"end":{"line":53,"column":21}},{"start":{"line":51,"column":20},"end":{"line":53,"column":21}}],"line":51},"31":{"loc":{"start":{"line":51,"column":24},"end":{"line":51,"column":90}},"type":"binary-expr","locations":[{"start":{"line":51,"column":24},"end":{"line":51,"column":28}},{"start":{"line":51,"column":32},"end":{"line":51,"column":90}}],"line":51},"32":{"loc":{"start":{"line":62,"column":12},"end":{"line":65,"column":13}},"type":"switch","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":90}},{"start":{"line":64,"column":16},"end":{"line":64,"column":57}}],"line":62},"33":{"loc":{"start":{"line":94,"column":12},"end":{"line":108,"column":13}},"type":"switch","locations":[{"start":{"line":95,"column":16},"end":{"line":97,"column":80}},{"start":{"line":98,"column":16},"end":{"line":103,"column":95}},{"start":{"line":104,"column":16},"end":{"line":106,"column":94}},{"start":{"line":107,"column":16},"end":{"line":107,"column":57}}],"line":94},"34":{"loc":{"start":{"line":100,"column":20},"end":{"line":102,"column":21}},"type":"if","locations":[{"start":{"line":100,"column":20},"end":{"line":102,"column":21}},{"start":{"line":100,"column":20},"end":{"line":102,"column":21}}],"line":100},"35":{"loc":{"start":{"line":116,"column":12},"end":{"line":128,"column":13}},"type":"switch","locations":[{"start":{"line":117,"column":16},"end":{"line":119,"column":71}},{"start":{"line":120,"column":16},"end":{"line":123,"column":88}},{"start":{"line":124,"column":16},"end":{"line":127,"column":45}}],"line":116}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0,0,0],"34":[0,0],"35":[0,0,0]},"inputSourceMap":{"version":3,"file":"/app/app/services/users.ts","sources":["/app/app/services/users.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAgD;AAEhD,iCAAkC;AAClC,6CAAuC;AACvC,8CAA+C;AAC/C,SAAe,SAAS,CAAC,QAA0B;;;;;wBAC3B,qBAAM,SAAS,CAAC,oBAAoB,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAA;;oBAAlE,IAAI,GAAU,SAAoD;oBACxE,IAAG,IAAI,IAAI,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;wBACnE,sBAAO,IAAI,EAAA;qBACd;oBACD,sBAAO,IAAI,EAAA;;;;CACd;AACD,SAAe,cAAc,CAAC,QAAgB,EAAE,EAAU;;;;wBAC/C,qBAAM,SAAS,CAAC,mBAAmB,CAAC,EAAE,EAAE,QAAQ,CAAC,EAAA;wBAAxD,sBAAO,SAAiD,EAAA;;;;CAC3D;AACD,SAAe,cAAc,CAAC,KAAa;;;YACvC,sBAAO,SAAS,CAAC,oBAAoB,CAAC,KAAK,CAAC,EAAA;;;CAC/C;AACD,SAAe,eAAe,CAAC,IAAiB;;;YAC5C,sBAAO,SAAS,CAAC,eAAe,CAAC,IAAI,CAAC,EAAC;;;CAC1C;AACD,SAAe,oBAAoB,CAAC,KAAa;;;YAC7C,sBAAO,SAAS,CAAC,oBAAoB,CAAC,KAAK,CAAC,EAAA;;;CAC/C;AACD,SAAe,eAAe,CAAC,KAAa;;;;;;oBAClC,WAAW,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;oBAC9C,qBAAM,SAAS,CAAC,oBAAoB,CAAC,KAAK,CAAC,EAAA;;oBAAlD,IAAI,GAAG,SAA2C;oBACxD,IAAG,CAAC,IAAI,EAAE;wBACN,sBAAM;qBACT;oBACD,qBAAM,gBAAM,CAAC,eAAe,CAAC,KAAK,EAAE,WAAW,CAAC,EAAA;;oBAAhD,SAAgD,CAAA;oBACzC,qBAAM,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,EAAE,WAAW,CAAC,EAAA;wBAAhE,sBAAO,SAAyD,EAAA;;;;CACnE;AAED,SAAe,eAAe,CAAC,IAAqD;;;;;;oBAChF,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAA;oBACZ,qBAAM,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,EAAA;;oBAA7C,CAAC,GAAU,SAAkC;oBACnD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAA;oBAC3B,qBAAM,WAAW,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAA;;oBAAnD,SAAmD,CAAA;oBACnD,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;oBACzB,sBAAO,CAAC,EAAA;;;;CACX;AAED,kBAAe;IACX,eAAe,iBAAA;IACf,SAAS,WAAA;IACT,oBAAoB,sBAAA;IACpB,eAAe,iBAAA;IACf,cAAc,gBAAA;IACd,cAAc,gBAAA;IACd,eAAe,iBAAA;CAClB,CAAA","sourcesContent":["import * as userModel from '../db/queries/users'\nimport {IGoogleUser, IUser, IUserCredentials} from '../db/queries/interfaces/Iusers'\nimport * as bcrypt from 'bcryptjs'\nimport mailer from '../services/mailer'\nimport * as authService from '../services/auth'\nasync function checkUser(userCred: IUserCredentials): Promise<null | IUser> {\n    const user: IUser = await userModel.getSingleUserByEmail(userCred.email)\n    if(user && bcrypt.compareSync(userCred.password, user.local.password)) {\n        return user\n    }\n    return null\n}\nasync function changePassword(password: string, id: string) {\n    return await userModel.updateLocalPassword(id, password)\n}\nasync function gerUserByEmail(email: string): Promise<IUser> {\n    return userModel.getSingleUserByEmail(email)\n}\nasync function storeGoogleUser(user: IGoogleUser) {\n    return userModel.storeGoogleUser(user);\n}\nasync function getGoogleUserByEmail(email: string): Promise<IUser> {\n    return userModel.getGoogleUserByEmail(email)\n}\nasync function sendNewPassword(email: string) {\n    const newPassword = Math.random().toString(36).substring(7)\n    const user = await userModel.getSingleUserByEmail(email)\n    if(!user) {\n        return\n    }\n    await mailer.sendNewPassword(email, newPassword)\n    return await userModel.updateLocalPassword(user.id, newPassword)\n}\n\nasync function createLocalUser(user: {name: string, email: string, password: string}): Promise<IUser> {\n    console.log('before created')\n    const u: IUser = await userModel.addLocalUser(user)\n    console.log('user created')\n    await authService.sendConfirmationEmail(user.email)\n    console.log('email sent')\n    return u\n}\n\nexport default {\n    createLocalUser,\n    checkUser,\n    getGoogleUserByEmail,\n    storeGoogleUser,\n    gerUserByEmail,\n    changePassword,\n    sendNewPassword\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"321368dabcf07490db142ad4fadd87e32e242e58","contentHash":"8d734b689b77fcbcdc51c968c0ec2051b1c07df2c5ef0d4b6dd0737c2ccca6ba"},"/app/app/routes/cities.ts":{"path":"/app/app/routes/cities.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":15},"end":{"line":4,"column":47}},"3":{"start":{"line":5,"column":13},"end":{"line":5,"column":46}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":49}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":59}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":24}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/routes/cities.ts","sources":["/app/app/routes/cities.ts"],"names":[],"mappings":";;AAAA,mCAAoC;AACpC,gDAA0C;AAC1C,IAAM,MAAM,GAAG,IAAI,MAAM,CAAC,EAAC,MAAM,EAAE,SAAS,EAAC,CAAC,CAAC;AAE/C,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,gBAAM,CAAC,OAAO,CAAC,CAAA;AACtC,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,gBAAM,CAAC,SAAS,CAAC,CAAC;AAEjD,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC","sourcesContent":["import * as Router from 'koa-router'\nimport cities from '../controllers/cities'\nconst router = new Router({prefix: '/cities'});\n\nrouter.get('/showenv', cities.showEnv)\nrouter.get('/getByName/:name', cities.getByName);\n\nmodule.exports = router;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"20fc8a64ca82ac704fffbb87f58cc4e610570bbf","contentHash":"4aa41e163030e9e0d8e58f618cae6528f424b0e853d9b601bff75b5cef938cce"},"/app/app/controllers/cities.ts":{"path":"/app/app/controllers/cities.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":15},"end":{"line":39,"column":46}},"68":{"start":{"line":40,"column":0},"end":{"line":65,"column":2}},"69":{"start":{"line":42,"column":8},"end":{"line":55,"column":11}},"70":{"start":{"line":44,"column":12},"end":{"line":54,"column":15}},"71":{"start":{"line":45,"column":16},"end":{"line":53,"column":17}},"72":{"start":{"line":47,"column":24},"end":{"line":47,"column":47}},"73":{"start":{"line":48,"column":24},"end":{"line":48,"column":33}},"74":{"start":{"line":49,"column":24},"end":{"line":49,"column":71}},"75":{"start":{"line":51,"column":24},"end":{"line":51,"column":44}},"76":{"start":{"line":52,"column":24},"end":{"line":52,"column":46}},"77":{"start":{"line":58,"column":8},"end":{"line":63,"column":11}},"78":{"start":{"line":59,"column":12},"end":{"line":62,"column":15}},"79":{"start":{"line":60,"column":16},"end":{"line":60,"column":55}},"80":{"start":{"line":61,"column":16},"end":{"line":61,"column":38}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"(anonymous_13)","decl":{"start":{"line":41,"column":15},"end":{"line":41,"column":16}},"loc":{"start":{"line":41,"column":30},"end":{"line":56,"column":5}},"line":41},"14":{"name":"(anonymous_14)","decl":{"start":{"line":42,"column":47},"end":{"line":42,"column":48}},"loc":{"start":{"line":42,"column":59},"end":{"line":55,"column":9}},"line":42},"15":{"name":"(anonymous_15)","decl":{"start":{"line":44,"column":37},"end":{"line":44,"column":38}},"loc":{"start":{"line":44,"column":51},"end":{"line":54,"column":13}},"line":44},"16":{"name":"(anonymous_16)","decl":{"start":{"line":57,"column":13},"end":{"line":57,"column":14}},"loc":{"start":{"line":57,"column":28},"end":{"line":64,"column":5}},"line":57},"17":{"name":"(anonymous_17)","decl":{"start":{"line":58,"column":47},"end":{"line":58,"column":48}},"loc":{"start":{"line":58,"column":59},"end":{"line":63,"column":9}},"line":58},"18":{"name":"(anonymous_18)","decl":{"start":{"line":59,"column":37},"end":{"line":59,"column":38}},"loc":{"start":{"line":59,"column":51},"end":{"line":62,"column":13}},"line":59}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":45,"column":16},"end":{"line":53,"column":17}},"type":"switch","locations":[{"start":{"line":46,"column":20},"end":{"line":49,"column":71}},{"start":{"line":50,"column":20},"end":{"line":52,"column":46}}],"line":45}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/controllers/cities.ts","sources":["/app/app/controllers/cities.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAgD;AAChD,kBAAe;IACP,SAAS,YAAC,GAAG;;;;;;wBACV,IAAI,GAAI,GAAG,CAAC,MAAM,KAAd,CAAe;wBAC1B,KAAA,GAAG,CAAA;wBAAQ,qBAAM,kBAAS,CAAC,IAAI,CAAC,EAAA;;wBAAhC,GAAI,IAAI,GAAG,SAAqB,CAAC;;;;;KAClC;IACK,OAAO,YAAC,GAAG;;;gBACf,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;;;;KACvC;CACF,CAAC","sourcesContent":["import { getByName } from '../db/queries/cities'\nexport default {\n  async getByName(ctx) {\n    const {name} = ctx.params;\n    ctx.body = await getByName(name);\n  },\n  async showEnv(ctx){\n    ctx.body = JSON.stringify(process.env)\n  },\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"652e76864b40d511c4cf46f0c7a4f59cc051114a","contentHash":"61a420667933c4445577ea99574252644cf3d0c9ccd26a59811bd467c65b03d0"},"/app/app/db/queries/cities.ts":{"path":"/app/app/db/queries/cities.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":13},"end":{"line":39,"column":39}},"68":{"start":{"line":40,"column":15},"end":{"line":40,"column":32}},"69":{"start":{"line":42,"column":4},"end":{"line":57,"column":7}},"70":{"start":{"line":44,"column":8},"end":{"line":56,"column":11}},"71":{"start":{"line":45,"column":12},"end":{"line":55,"column":13}},"72":{"start":{"line":47,"column":20},"end":{"line":47,"column":64}},"73":{"start":{"line":48,"column":20},"end":{"line":51,"column":28}},"74":{"start":{"line":53,"column":20},"end":{"line":53,"column":39}},"75":{"start":{"line":54,"column":20},"end":{"line":54,"column":55}},"76":{"start":{"line":59,"column":0},"end":{"line":59,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"getByName","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":18}},"loc":{"start":{"line":41,"column":25},"end":{"line":58,"column":1}},"line":41},"14":{"name":"(anonymous_14)","decl":{"start":{"line":42,"column":43},"end":{"line":42,"column":44}},"loc":{"start":{"line":42,"column":55},"end":{"line":57,"column":5}},"line":42},"15":{"name":"(anonymous_15)","decl":{"start":{"line":44,"column":33},"end":{"line":44,"column":34}},"loc":{"start":{"line":44,"column":47},"end":{"line":56,"column":9}},"line":44}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":45,"column":12},"end":{"line":55,"column":13}},"type":"switch","locations":[{"start":{"line":46,"column":16},"end":{"line":51,"column":28}},{"start":{"line":52,"column":16},"end":{"line":54,"column":55}}],"line":45}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/db/queries/cities.ts","sources":["/app/app/db/queries/cities.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wCAAkC;AAClC,iCAA0B;AAG1B,SAAe,SAAS,CAAC,IAAY;;;;;;oBAC3B,aAAa,GAAW,UAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;oBAE7C,qBAAM,cAAI,CAAC,GAAG,CACV,y9CA8BH,EACG;4BACI,QAAQ,EAAK,aAAa,MAAG;4BAC7B,IAAI,EAAE,aAAa;yBACtB,CAAC,EAAA;;oBApCJ,MAAM,GACR,SAmCM;oBACV,sBAAO,MAAM,CAAC,IAAI,EAAC;;;;CACtB;AAGG,8BAAS","sourcesContent":["import knex from '../../libs/knex'\nimport { _ } from 'lodash'\nimport {ICity} from './interfaces/Icities';\n\nasync function getByName(name: string): Promise<ICity[]> {\n    const uppercaseCity: string = _.upperFirst(name);\n    const cities =\n        await knex.raw(\n            `\n            SELECT * FROM (SELECT DISTINCT on (id) * FROM (SELECT city.title_ru  as name,\n                   city.city_id as id,\n                   city.region_ru as region,\n                   c.title_ru     as country,\n                   case\n                     when city.title_ru = :city and city.region_ru IS NULL then 2\n                     when city.title_ru = :city then 1\n                     when city.region_ru IS NULL then 1\n                     else 0\n                   end  as priority\n            FROM (select * from _cities c where c.country_id < 20) as city\n                   JOIN _countries as c on c.country_id = city.country_id\n            WHERE\n                  city.title_ru LIKE :cityLike\n            UNION DISTINCT\n            SELECT city.title_ua  as name,\n                   city.city_id as id,\n                   city.region_ua as region,\n                   c.title_ua     as country,\n                   case\n                     when city.title_ua = :city and city.title_ua IS NULL then 2\n                     when city.title_ua = :city then 1\n                     when city.title_ua IS NULL then 1\n                     else 0\n                   end  as priority\n            FROM (select * from _cities c where c.country_id < 20) as city\n                   JOIN _countries as c on c.country_id = city.country_id\n            WHERE city.title_ua LIKE :cityLike) as cc) as dd\n            ORDER BY dd.priority DESC, dd.name ASC;\n        `,\n            {\n                cityLike: `${uppercaseCity}%`,\n                city: uppercaseCity\n            });\n    return cities.rows;\n}\n\nexport {\n    getByName,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8a9182710650ff232bbc065fb53b97fd4a73e0b3","contentHash":"785606e0abcd7ced1e41a5c3a27464178af6ba5f6c01e6c9de15b6edb78dd9c0"},"/app/app/routes/game.ts":{"path":"/app/app/routes/game.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":13},"end":{"line":4,"column":43}},"3":{"start":{"line":5,"column":13},"end":{"line":5,"column":44}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":44}},"5":{"start":{"line":7,"column":25},"end":{"line":7,"column":100}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":57}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":62}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":39}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":52}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":72}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":67}},"12":{"start":{"line":14,"column":0},"end":{"line":14,"column":24}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/routes/game.ts","sources":["/app/app/routes/game.ts"],"names":[],"mappings":";;AAAA,mCAAoC;AACpC,4CAAsC;AACtC,IAAM,MAAM,GAAG,IAAI,MAAM,CAAC,EAAC,MAAM,EAAE,OAAO,EAAC,CAAC,CAAC;AAC7C,6CAAuC;AACvC,IAAM,kBAAkB,GAAG,kBAAQ,CAAC,YAAY,CAAC,CAAC,KAAK,EAAE,aAAa,CAAC,EAAE,EAAC,OAAO,EAAE,KAAK,EAAC,CAAC,CAAA;AAE1F,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,kBAAkB,EAAE,cAAI,CAAC,GAAG,CAAC,CAAC;AAC/C,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,kBAAkB,EAAE,cAAI,CAAC,IAAI,CAAC,CAAC;AACpD,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,cAAI,CAAC,GAAG,CAAC,CAAC;AAC7B,MAAM,CAAC,GAAG,CAAC,WAAW,EAAE,cAAI,CAAC,WAAW,CAAC,CAAC;AAE1C,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,kBAAkB,EAAE,cAAI,CAAC,cAAc,CAAC,CAAC;AAC9D,MAAM,CAAC,GAAG,CAAC,uBAAuB,EAAE,cAAI,CAAC,cAAc,CAAC,CAAC;AAEzD,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC","sourcesContent":["import * as Router from 'koa-router'\nimport game from '../controllers/game'\nconst router = new Router({prefix: '/game'});\nimport passport from '../libs/passport'\nconst passportMiddleware = passport.authenticate(['jwt', 'jwt-refresh'], {session: false})\n\nrouter.post('/', passportMiddleware, game.add);\nrouter.post('/join', passportMiddleware, game.join);\nrouter.get('/:id', game.get);\nrouter.get('/city/:id', game.listForCity);\n\nrouter.post('/chat', passportMiddleware, game.addChatMessage);\nrouter.get('/chat/history/:gameId', game.getChatHistory);\n\nmodule.exports = router;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6a29aad854113175c779d754a5026f85a4aa5c43","contentHash":"92e38f64b2e40e9be383927597e97e030f479862f972f1daaa883122c6b1869d"},"/app/app/controllers/game.ts":{"path":"/app/app/controllers/game.ts","statementMap":{"0":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":10,"column":6}},"2":{"start":{"line":4,"column":8},"end":{"line":8,"column":9}},"3":{"start":{"line":4,"column":24},"end":{"line":4,"column":25}},"4":{"start":{"line":4,"column":31},"end":{"line":4,"column":47}},"5":{"start":{"line":5,"column":12},"end":{"line":5,"column":29}},"6":{"start":{"line":6,"column":12},"end":{"line":7,"column":28}},"7":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"8":{"start":{"line":7,"column":16},"end":{"line":7,"column":28}},"9":{"start":{"line":9,"column":8},"end":{"line":9,"column":17}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":43}},"11":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"12":{"start":{"line":14,"column":28},"end":{"line":14,"column":110}},"13":{"start":{"line":14,"column":91},"end":{"line":14,"column":106}},"14":{"start":{"line":15,"column":4},"end":{"line":20,"column":7}},"15":{"start":{"line":16,"column":36},"end":{"line":16,"column":97}},"16":{"start":{"line":16,"column":42},"end":{"line":16,"column":70}},"17":{"start":{"line":16,"column":85},"end":{"line":16,"column":95}},"18":{"start":{"line":17,"column":35},"end":{"line":17,"column":100}},"19":{"start":{"line":17,"column":41},"end":{"line":17,"column":73}},"20":{"start":{"line":17,"column":88},"end":{"line":17,"column":98}},"21":{"start":{"line":18,"column":32},"end":{"line":18,"column":116}},"22":{"start":{"line":19,"column":8},"end":{"line":19,"column":78}},"23":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"24":{"start":{"line":23,"column":12},"end":{"line":23,"column":104}},"25":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"26":{"start":{"line":23,"column":57},"end":{"line":23,"column":68}},"27":{"start":{"line":23,"column":69},"end":{"line":23,"column":81}},"28":{"start":{"line":24,"column":4},"end":{"line":24,"column":157}},"29":{"start":{"line":24,"column":138},"end":{"line":24,"column":150}},"30":{"start":{"line":25,"column":23},"end":{"line":25,"column":68}},"31":{"start":{"line":25,"column":45},"end":{"line":25,"column":65}},"32":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"33":{"start":{"line":27,"column":15},"end":{"line":27,"column":70}},"34":{"start":{"line":28,"column":8},"end":{"line":45,"column":66}},"35":{"start":{"line":28,"column":18},"end":{"line":45,"column":66}},"36":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"37":{"start":{"line":29,"column":160},"end":{"line":29,"column":169}},"38":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"39":{"start":{"line":30,"column":26},"end":{"line":30,"column":52}},"40":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"41":{"start":{"line":32,"column":32},"end":{"line":32,"column":39}},"42":{"start":{"line":32,"column":40},"end":{"line":32,"column":46}},"43":{"start":{"line":33,"column":24},"end":{"line":33,"column":34}},"44":{"start":{"line":33,"column":35},"end":{"line":33,"column":72}},"45":{"start":{"line":34,"column":24},"end":{"line":34,"column":34}},"46":{"start":{"line":34,"column":35},"end":{"line":34,"column":45}},"47":{"start":{"line":34,"column":46},"end":{"line":34,"column":55}},"48":{"start":{"line":34,"column":56},"end":{"line":34,"column":65}},"49":{"start":{"line":35,"column":24},"end":{"line":35,"column":41}},"50":{"start":{"line":35,"column":42},"end":{"line":35,"column":55}},"51":{"start":{"line":35,"column":56},"end":{"line":35,"column":65}},"52":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"53":{"start":{"line":37,"column":110},"end":{"line":37,"column":116}},"54":{"start":{"line":37,"column":117},"end":{"line":37,"column":126}},"55":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"56":{"start":{"line":38,"column":81},"end":{"line":38,"column":97}},"57":{"start":{"line":38,"column":98},"end":{"line":38,"column":104}},"58":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"59":{"start":{"line":39,"column":57},"end":{"line":39,"column":72}},"60":{"start":{"line":39,"column":73},"end":{"line":39,"column":80}},"61":{"start":{"line":39,"column":81},"end":{"line":39,"column":87}},"62":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"63":{"start":{"line":40,"column":47},"end":{"line":40,"column":62}},"64":{"start":{"line":40,"column":63},"end":{"line":40,"column":78}},"65":{"start":{"line":40,"column":79},"end":{"line":40,"column":85}},"66":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"67":{"start":{"line":41,"column":30},"end":{"line":41,"column":42}},"68":{"start":{"line":42,"column":20},"end":{"line":42,"column":33}},"69":{"start":{"line":42,"column":34},"end":{"line":42,"column":43}},"70":{"start":{"line":44,"column":12},"end":{"line":44,"column":39}},"71":{"start":{"line":45,"column":22},"end":{"line":45,"column":34}},"72":{"start":{"line":45,"column":35},"end":{"line":45,"column":41}},"73":{"start":{"line":45,"column":54},"end":{"line":45,"column":64}},"74":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"75":{"start":{"line":46,"column":23},"end":{"line":46,"column":35}},"76":{"start":{"line":46,"column":36},"end":{"line":46,"column":89}},"77":{"start":{"line":49,"column":0},"end":{"line":49,"column":62}},"78":{"start":{"line":50,"column":14},"end":{"line":50,"column":44}},"79":{"start":{"line":51,"column":15},"end":{"line":51,"column":32}},"80":{"start":{"line":52,"column":17},"end":{"line":52,"column":50}},"81":{"start":{"line":53,"column":15},"end":{"line":53,"column":35}},"82":{"start":{"line":54,"column":15},"end":{"line":54,"column":45}},"83":{"start":{"line":55,"column":0},"end":{"line":192,"column":2}},"84":{"start":{"line":57,"column":8},"end":{"line":85,"column":11}},"85":{"start":{"line":59,"column":16},"end":{"line":70,"column":20}},"86":{"start":{"line":69,"column":20},"end":{"line":69,"column":43}},"87":{"start":{"line":73,"column":12},"end":{"line":84,"column":15}},"88":{"start":{"line":74,"column":16},"end":{"line":83,"column":17}},"89":{"start":{"line":76,"column":24},"end":{"line":76,"column":57}},"90":{"start":{"line":77,"column":24},"end":{"line":77,"column":118}},"91":{"start":{"line":79,"column":24},"end":{"line":79,"column":39}},"92":{"start":{"line":80,"column":24},"end":{"line":80,"column":61}},"93":{"start":{"line":81,"column":24},"end":{"line":81,"column":41}},"94":{"start":{"line":82,"column":24},"end":{"line":82,"column":46}},"95":{"start":{"line":88,"column":8},"end":{"line":105,"column":11}},"96":{"start":{"line":90,"column":12},"end":{"line":104,"column":15}},"97":{"start":{"line":91,"column":16},"end":{"line":103,"column":17}},"98":{"start":{"line":93,"column":24},"end":{"line":93,"column":43}},"99":{"start":{"line":94,"column":24},"end":{"line":94,"column":33}},"100":{"start":{"line":95,"column":24},"end":{"line":95,"column":70}},"101":{"start":{"line":97,"column":24},"end":{"line":97,"column":44}},"102":{"start":{"line":98,"column":24},"end":{"line":98,"column":38}},"103":{"start":{"line":99,"column":24},"end":{"line":99,"column":79}},"104":{"start":{"line":101,"column":24},"end":{"line":101,"column":58}},"105":{"start":{"line":102,"column":24},"end":{"line":102,"column":46}},"106":{"start":{"line":108,"column":8},"end":{"line":121,"column":11}},"107":{"start":{"line":110,"column":12},"end":{"line":120,"column":15}},"108":{"start":{"line":111,"column":16},"end":{"line":119,"column":17}},"109":{"start":{"line":113,"column":24},"end":{"line":113,"column":43}},"110":{"start":{"line":114,"column":24},"end":{"line":114,"column":79}},"111":{"start":{"line":116,"column":24},"end":{"line":116,"column":48}},"112":{"start":{"line":117,"column":24},"end":{"line":117,"column":40}},"113":{"start":{"line":118,"column":24},"end":{"line":118,"column":46}},"114":{"start":{"line":124,"column":8},"end":{"line":142,"column":11}},"115":{"start":{"line":126,"column":12},"end":{"line":141,"column":15}},"116":{"start":{"line":127,"column":16},"end":{"line":140,"column":17}},"117":{"start":{"line":129,"column":24},"end":{"line":129,"column":45}},"118":{"start":{"line":130,"column":24},"end":{"line":130,"column":98}},"119":{"start":{"line":131,"column":24},"end":{"line":133,"column":25}},"120":{"start":{"line":132,"column":28},"end":{"line":132,"column":55}},"121":{"start":{"line":134,"column":24},"end":{"line":134,"column":93}},"122":{"start":{"line":136,"column":24},"end":{"line":136,"column":50}},"123":{"start":{"line":137,"column":24},"end":{"line":137,"column":62}},"124":{"start":{"line":138,"column":24},"end":{"line":138,"column":41}},"125":{"start":{"line":139,"column":24},"end":{"line":139,"column":46}},"126":{"start":{"line":145,"column":8},"end":{"line":170,"column":11}},"127":{"start":{"line":147,"column":12},"end":{"line":169,"column":15}},"128":{"start":{"line":148,"column":16},"end":{"line":168,"column":17}},"129":{"start":{"line":150,"column":24},"end":{"line":150,"column":88}},"130":{"start":{"line":151,"column":24},"end":{"line":153,"column":25}},"131":{"start":{"line":152,"column":28},"end":{"line":152,"column":63}},"132":{"start":{"line":154,"column":24},"end":{"line":154,"column":70}},"133":{"start":{"line":155,"column":24},"end":{"line":155,"column":90}},"134":{"start":{"line":157,"column":24},"end":{"line":157,"column":49}},"135":{"start":{"line":158,"column":24},"end":{"line":165,"column":27}},"136":{"start":{"line":166,"column":24},"end":{"line":166,"column":41}},"137":{"start":{"line":167,"column":24},"end":{"line":167,"column":46}},"138":{"start":{"line":173,"column":8},"end":{"line":190,"column":11}},"139":{"start":{"line":175,"column":12},"end":{"line":189,"column":15}},"140":{"start":{"line":176,"column":16},"end":{"line":188,"column":17}},"141":{"start":{"line":178,"column":24},"end":{"line":178,"column":51}},"142":{"start":{"line":179,"column":24},"end":{"line":179,"column":66}},"143":{"start":{"line":180,"column":24},"end":{"line":181,"column":87}},"144":{"start":{"line":182,"column":24},"end":{"line":182,"column":59}},"145":{"start":{"line":183,"column":24},"end":{"line":183,"column":55}},"146":{"start":{"line":185,"column":24},"end":{"line":185,"column":61}},"147":{"start":{"line":186,"column":24},"end":{"line":186,"column":41}},"148":{"start":{"line":187,"column":24},"end":{"line":187,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":42},"end":{"line":2,"column":43}},"loc":{"start":{"line":2,"column":54},"end":{"line":12,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":3,"column":32},"end":{"line":3,"column":33}},"loc":{"start":{"line":3,"column":44},"end":{"line":10,"column":5}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":44},"end":{"line":13,"column":45}},"loc":{"start":{"line":13,"column":89},"end":{"line":21,"column":1}},"line":13},"3":{"name":"adopt","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":18}},"loc":{"start":{"line":14,"column":26},"end":{"line":14,"column":112}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":70},"end":{"line":14,"column":71}},"loc":{"start":{"line":14,"column":89},"end":{"line":14,"column":108}},"line":14},"5":{"name":"(anonymous_5)","decl":{"start":{"line":15,"column":36},"end":{"line":15,"column":37}},"loc":{"start":{"line":15,"column":63},"end":{"line":20,"column":5}},"line":15},"6":{"name":"fulfilled","decl":{"start":{"line":16,"column":17},"end":{"line":16,"column":26}},"loc":{"start":{"line":16,"column":34},"end":{"line":16,"column":99}},"line":16},"7":{"name":"rejected","decl":{"start":{"line":17,"column":17},"end":{"line":17,"column":25}},"loc":{"start":{"line":17,"column":33},"end":{"line":17,"column":102}},"line":17},"8":{"name":"step","decl":{"start":{"line":18,"column":17},"end":{"line":18,"column":21}},"loc":{"start":{"line":18,"column":30},"end":{"line":18,"column":118}},"line":18},"9":{"name":"(anonymous_9)","decl":{"start":{"line":22,"column":48},"end":{"line":22,"column":49}},"loc":{"start":{"line":22,"column":73},"end":{"line":48,"column":1}},"line":22},"10":{"name":"(anonymous_10)","decl":{"start":{"line":23,"column":30},"end":{"line":23,"column":31}},"loc":{"start":{"line":23,"column":41},"end":{"line":23,"column":83}},"line":23},"11":{"name":"(anonymous_11)","decl":{"start":{"line":24,"column":125},"end":{"line":24,"column":126}},"loc":{"start":{"line":24,"column":136},"end":{"line":24,"column":152}},"line":24},"12":{"name":"verb","decl":{"start":{"line":25,"column":13},"end":{"line":25,"column":17}},"loc":{"start":{"line":25,"column":21},"end":{"line":25,"column":70}},"line":25},"13":{"name":"(anonymous_13)","decl":{"start":{"line":25,"column":30},"end":{"line":25,"column":31}},"loc":{"start":{"line":25,"column":43},"end":{"line":25,"column":67}},"line":25},"14":{"name":"step","decl":{"start":{"line":26,"column":13},"end":{"line":26,"column":17}},"loc":{"start":{"line":26,"column":22},"end":{"line":47,"column":5}},"line":26},"15":{"name":"(anonymous_15)","decl":{"start":{"line":56,"column":9},"end":{"line":56,"column":10}},"loc":{"start":{"line":56,"column":24},"end":{"line":86,"column":5}},"line":56},"16":{"name":"(anonymous_16)","decl":{"start":{"line":57,"column":47},"end":{"line":57,"column":48}},"loc":{"start":{"line":57,"column":59},"end":{"line":85,"column":9}},"line":57},"17":{"name":"prepare","decl":{"start":{"line":58,"column":21},"end":{"line":58,"column":28}},"loc":{"start":{"line":58,"column":35},"end":{"line":71,"column":13}},"line":58},"18":{"name":"(anonymous_18)","decl":{"start":{"line":68,"column":25},"end":{"line":68,"column":26}},"loc":{"start":{"line":68,"column":39},"end":{"line":70,"column":17}},"line":68},"19":{"name":"(anonymous_19)","decl":{"start":{"line":73,"column":37},"end":{"line":73,"column":38}},"loc":{"start":{"line":73,"column":51},"end":{"line":84,"column":13}},"line":73},"20":{"name":"(anonymous_20)","decl":{"start":{"line":87,"column":9},"end":{"line":87,"column":10}},"loc":{"start":{"line":87,"column":24},"end":{"line":106,"column":5}},"line":87},"21":{"name":"(anonymous_21)","decl":{"start":{"line":88,"column":47},"end":{"line":88,"column":48}},"loc":{"start":{"line":88,"column":59},"end":{"line":105,"column":9}},"line":88},"22":{"name":"(anonymous_22)","decl":{"start":{"line":90,"column":37},"end":{"line":90,"column":38}},"loc":{"start":{"line":90,"column":51},"end":{"line":104,"column":13}},"line":90},"23":{"name":"(anonymous_23)","decl":{"start":{"line":107,"column":17},"end":{"line":107,"column":18}},"loc":{"start":{"line":107,"column":32},"end":{"line":122,"column":5}},"line":107},"24":{"name":"(anonymous_24)","decl":{"start":{"line":108,"column":47},"end":{"line":108,"column":48}},"loc":{"start":{"line":108,"column":59},"end":{"line":121,"column":9}},"line":108},"25":{"name":"(anonymous_25)","decl":{"start":{"line":110,"column":37},"end":{"line":110,"column":38}},"loc":{"start":{"line":110,"column":51},"end":{"line":120,"column":13}},"line":110},"26":{"name":"(anonymous_26)","decl":{"start":{"line":123,"column":10},"end":{"line":123,"column":11}},"loc":{"start":{"line":123,"column":25},"end":{"line":143,"column":5}},"line":123},"27":{"name":"(anonymous_27)","decl":{"start":{"line":124,"column":47},"end":{"line":124,"column":48}},"loc":{"start":{"line":124,"column":59},"end":{"line":142,"column":9}},"line":124},"28":{"name":"(anonymous_28)","decl":{"start":{"line":126,"column":37},"end":{"line":126,"column":38}},"loc":{"start":{"line":126,"column":51},"end":{"line":141,"column":13}},"line":126},"29":{"name":"(anonymous_29)","decl":{"start":{"line":144,"column":20},"end":{"line":144,"column":21}},"loc":{"start":{"line":144,"column":35},"end":{"line":171,"column":5}},"line":144},"30":{"name":"(anonymous_30)","decl":{"start":{"line":145,"column":47},"end":{"line":145,"column":48}},"loc":{"start":{"line":145,"column":59},"end":{"line":170,"column":9}},"line":145},"31":{"name":"(anonymous_31)","decl":{"start":{"line":147,"column":37},"end":{"line":147,"column":38}},"loc":{"start":{"line":147,"column":51},"end":{"line":169,"column":13}},"line":147},"32":{"name":"(anonymous_32)","decl":{"start":{"line":172,"column":20},"end":{"line":172,"column":21}},"loc":{"start":{"line":172,"column":35},"end":{"line":191,"column":5}},"line":172},"33":{"name":"(anonymous_33)","decl":{"start":{"line":173,"column":47},"end":{"line":173,"column":48}},"loc":{"start":{"line":173,"column":59},"end":{"line":190,"column":9}},"line":173},"34":{"name":"(anonymous_34)","decl":{"start":{"line":175,"column":37},"end":{"line":175,"column":38}},"loc":{"start":{"line":175,"column":51},"end":{"line":189,"column":13}},"line":175}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":15},"end":{"line":12,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":16},"end":{"line":2,"column":20}},{"start":{"line":2,"column":24},"end":{"line":2,"column":37}},{"start":{"line":2,"column":42},"end":{"line":12,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":15},"end":{"line":10,"column":5}},"type":"binary-expr","locations":[{"start":{"line":3,"column":15},"end":{"line":3,"column":28}},{"start":{"line":3,"column":32},"end":{"line":10,"column":5}}],"line":3},"2":{"loc":{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},"type":"if","locations":[{"start":{"line":6,"column":29},"end":{"line":7,"column":28}},{"start":{"line":6,"column":29},"end":{"line":7,"column":28}}],"line":6},"3":{"loc":{"start":{"line":13,"column":16},"end":{"line":21,"column":1}},"type":"binary-expr","locations":[{"start":{"line":13,"column":17},"end":{"line":13,"column":21}},{"start":{"line":13,"column":25},"end":{"line":13,"column":39}},{"start":{"line":13,"column":44},"end":{"line":21,"column":1}}],"line":13},"4":{"loc":{"start":{"line":14,"column":35},"end":{"line":14,"column":109}},"type":"cond-expr","locations":[{"start":{"line":14,"column":56},"end":{"line":14,"column":61}},{"start":{"line":14,"column":64},"end":{"line":14,"column":109}}],"line":14},"5":{"loc":{"start":{"line":15,"column":16},"end":{"line":15,"column":34}},"type":"binary-expr","locations":[{"start":{"line":15,"column":16},"end":{"line":15,"column":17}},{"start":{"line":15,"column":22},"end":{"line":15,"column":33}}],"line":15},"6":{"loc":{"start":{"line":18,"column":32},"end":{"line":18,"column":115}},"type":"cond-expr","locations":[{"start":{"line":18,"column":46},"end":{"line":18,"column":67}},{"start":{"line":18,"column":70},"end":{"line":18,"column":115}}],"line":18},"7":{"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":67}},"type":"binary-expr","locations":[{"start":{"line":19,"column":51},"end":{"line":19,"column":61}},{"start":{"line":19,"column":65},"end":{"line":19,"column":67}}],"line":19},"8":{"loc":{"start":{"line":22,"column":18},"end":{"line":48,"column":1}},"type":"binary-expr","locations":[{"start":{"line":22,"column":19},"end":{"line":22,"column":23}},{"start":{"line":22,"column":27},"end":{"line":22,"column":43}},{"start":{"line":22,"column":48},"end":{"line":48,"column":1}}],"line":22},"9":{"loc":{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},"type":"if","locations":[{"start":{"line":23,"column":43},"end":{"line":23,"column":68}},{"start":{"line":23,"column":43},"end":{"line":23,"column":68}}],"line":23},"10":{"loc":{"start":{"line":24,"column":71},"end":{"line":24,"column":153}},"type":"binary-expr","locations":[{"start":{"line":24,"column":71},"end":{"line":24,"column":99}},{"start":{"line":24,"column":104},"end":{"line":24,"column":152}}],"line":24},"11":{"loc":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},{"start":{"line":27,"column":8},"end":{"line":27,"column":70}}],"line":27},"12":{"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":169}},{"start":{"line":29,"column":12},"end":{"line":29,"column":169}}],"line":29},"13":{"loc":{"start":{"line":29,"column":23},"end":{"line":29,"column":158}},"type":"binary-expr","locations":[{"start":{"line":29,"column":23},"end":{"line":29,"column":24}},{"start":{"line":29,"column":29},"end":{"line":29,"column":125}},{"start":{"line":29,"column":130},"end":{"line":29,"column":158}}],"line":29},"14":{"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":45},"end":{"line":29,"column":56}},{"start":{"line":29,"column":59},"end":{"line":29,"column":125}}],"line":29},"15":{"loc":{"start":{"line":29,"column":59},"end":{"line":29,"column":125}},"type":"cond-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},{"start":{"line":29,"column":119},"end":{"line":29,"column":125}}],"line":29},"16":{"loc":{"start":{"line":29,"column":67},"end":{"line":29,"column":116}},"type":"binary-expr","locations":[{"start":{"line":29,"column":67},"end":{"line":29,"column":77}},{"start":{"line":29,"column":82},"end":{"line":29,"column":115}}],"line":29},"17":{"loc":{"start":{"line":29,"column":82},"end":{"line":29,"column":112}},"type":"binary-expr","locations":[{"start":{"line":29,"column":83},"end":{"line":29,"column":98}},{"start":{"line":29,"column":103},"end":{"line":29,"column":112}}],"line":29},"18":{"loc":{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},"type":"if","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":52}},{"start":{"line":30,"column":12},"end":{"line":30,"column":52}}],"line":30},"19":{"loc":{"start":{"line":31,"column":12},"end":{"line":43,"column":13}},"type":"switch","locations":[{"start":{"line":32,"column":16},"end":{"line":32,"column":23}},{"start":{"line":32,"column":24},"end":{"line":32,"column":46}},{"start":{"line":33,"column":16},"end":{"line":33,"column":72}},{"start":{"line":34,"column":16},"end":{"line":34,"column":65}},{"start":{"line":35,"column":16},"end":{"line":35,"column":65}},{"start":{"line":36,"column":16},"end":{"line":42,"column":43}}],"line":31},"20":{"loc":{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},"type":"if","locations":[{"start":{"line":37,"column":20},"end":{"line":37,"column":128}},{"start":{"line":37,"column":20},"end":{"line":37,"column":128}}],"line":37},"21":{"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":106}},"type":"binary-expr","locations":[{"start":{"line":37,"column":24},"end":{"line":37,"column":74}},{"start":{"line":37,"column":79},"end":{"line":37,"column":90}},{"start":{"line":37,"column":94},"end":{"line":37,"column":105}}],"line":37},"22":{"loc":{"start":{"line":37,"column":42},"end":{"line":37,"column":73}},"type":"binary-expr","locations":[{"start":{"line":37,"column":42},"end":{"line":37,"column":54}},{"start":{"line":37,"column":58},"end":{"line":37,"column":73}}],"line":37},"23":{"loc":{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},"type":"if","locations":[{"start":{"line":38,"column":20},"end":{"line":38,"column":106}},{"start":{"line":38,"column":20},"end":{"line":38,"column":106}}],"line":38},"24":{"loc":{"start":{"line":38,"column":24},"end":{"line":38,"column":77}},"type":"binary-expr","locations":[{"start":{"line":38,"column":24},"end":{"line":38,"column":35}},{"start":{"line":38,"column":40},"end":{"line":38,"column":42}},{"start":{"line":38,"column":47},"end":{"line":38,"column":59}},{"start":{"line":38,"column":63},"end":{"line":38,"column":75}}],"line":38},"25":{"loc":{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},"type":"if","locations":[{"start":{"line":39,"column":20},"end":{"line":39,"column":89}},{"start":{"line":39,"column":20},"end":{"line":39,"column":89}}],"line":39},"26":{"loc":{"start":{"line":39,"column":24},"end":{"line":39,"column":53}},"type":"binary-expr","locations":[{"start":{"line":39,"column":24},"end":{"line":39,"column":35}},{"start":{"line":39,"column":39},"end":{"line":39,"column":53}}],"line":39},"27":{"loc":{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},"type":"if","locations":[{"start":{"line":40,"column":20},"end":{"line":40,"column":87}},{"start":{"line":40,"column":20},"end":{"line":40,"column":87}}],"line":40},"28":{"loc":{"start":{"line":40,"column":24},"end":{"line":40,"column":43}},"type":"binary-expr","locations":[{"start":{"line":40,"column":24},"end":{"line":40,"column":25}},{"start":{"line":40,"column":29},"end":{"line":40,"column":43}}],"line":40},"29":{"loc":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},"type":"if","locations":[{"start":{"line":41,"column":20},"end":{"line":41,"column":42}},{"start":{"line":41,"column":20},"end":{"line":41,"column":42}}],"line":41},"30":{"loc":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},{"start":{"line":46,"column":8},"end":{"line":46,"column":35}}],"line":46},"31":{"loc":{"start":{"line":46,"column":52},"end":{"line":46,"column":74}},"type":"cond-expr","locations":[{"start":{"line":46,"column":60},"end":{"line":46,"column":65}},{"start":{"line":46,"column":68},"end":{"line":46,"column":74}}],"line":46},"32":{"loc":{"start":{"line":74,"column":16},"end":{"line":83,"column":17}},"type":"switch","locations":[{"start":{"line":75,"column":20},"end":{"line":77,"column":118}},{"start":{"line":78,"column":20},"end":{"line":82,"column":46}}],"line":74},"33":{"loc":{"start":{"line":91,"column":16},"end":{"line":103,"column":17}},"type":"switch","locations":[{"start":{"line":92,"column":20},"end":{"line":95,"column":70}},{"start":{"line":96,"column":20},"end":{"line":99,"column":79}},{"start":{"line":100,"column":20},"end":{"line":102,"column":46}}],"line":91},"34":{"loc":{"start":{"line":111,"column":16},"end":{"line":119,"column":17}},"type":"switch","locations":[{"start":{"line":112,"column":20},"end":{"line":114,"column":79}},{"start":{"line":115,"column":20},"end":{"line":118,"column":46}}],"line":111},"35":{"loc":{"start":{"line":127,"column":16},"end":{"line":140,"column":17}},"type":"switch","locations":[{"start":{"line":128,"column":20},"end":{"line":134,"column":93}},{"start":{"line":135,"column":20},"end":{"line":139,"column":46}}],"line":127},"36":{"loc":{"start":{"line":131,"column":24},"end":{"line":133,"column":25}},"type":"if","locations":[{"start":{"line":131,"column":24},"end":{"line":133,"column":25}},{"start":{"line":131,"column":24},"end":{"line":133,"column":25}}],"line":131},"37":{"loc":{"start":{"line":131,"column":28},"end":{"line":131,"column":52}},"type":"binary-expr","locations":[{"start":{"line":131,"column":28},"end":{"line":131,"column":35}},{"start":{"line":131,"column":39},"end":{"line":131,"column":52}}],"line":131},"38":{"loc":{"start":{"line":148,"column":16},"end":{"line":168,"column":17}},"type":"switch","locations":[{"start":{"line":149,"column":20},"end":{"line":155,"column":90}},{"start":{"line":156,"column":20},"end":{"line":167,"column":46}}],"line":148},"39":{"loc":{"start":{"line":151,"column":24},"end":{"line":153,"column":25}},"type":"if","locations":[{"start":{"line":151,"column":24},"end":{"line":153,"column":25}},{"start":{"line":151,"column":24},"end":{"line":153,"column":25}}],"line":151},"40":{"loc":{"start":{"line":176,"column":16},"end":{"line":188,"column":17}},"type":"switch","locations":[{"start":{"line":177,"column":20},"end":{"line":183,"column":55}},{"start":{"line":184,"column":20},"end":{"line":187,"column":46}}],"line":176}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":1,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[1,1,1],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[1,1,1],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0,0,0],"20":[0,0],"21":[0,0,0],"22":[0,0],"23":[0,0],"24":[0,0,0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/controllers/game.ts","sources":["/app/app/controllers/game.ts"],"names":[],"mappings":"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","sourcesContent":["import {IMessage} from '../db/queries/interfaces/Imessage'\nimport games from '../db/queries/games'\nimport {_} from 'lodash'\nimport {saveMessage, getMessages} from '../db/queries/messages'\nimport config from '../config'\nimport {BAD_REQUEST, CANT_PROCESS_ENTITY} from '../templates/errors';\n\nexport default {\n    async add(ctx)\n    {\n        const data = prepare(ctx.request.body);\n        const id = await games.addGame({\n            author_id: ctx.req.user.id,\n            ...data,\n        });\n        ctx.ioGeneral.emit('GAME_ADDED', id);\n        ctx.status = 201;\n\n        function prepare(body: any) {\n            return _.pick(\n                body,\n                [\n                    'players',\n                    'additional',\n                    'lat',\n                    'long',\n                    'address',\n                    'city_id',\n                    'district',\n                    'date',\n                ].filter((it) => {\n                    return body[it] !== ''\n                })\n            );\n        }\n    },\n\n  async get(ctx)\n  {\n    const {id} = ctx.params;\n    ctx.body = await games.get(id);\n    ctx.body.fieldNumbersInGame = await games.playerInGame(id);\n  },\n\n  async listForCity(ctx)\n  {\n    const {id} = ctx.params;\n    const {rows} = await games.gamesForCity(id);\n    ctx.body = rows;\n  },\n\n  async join(ctx)\n  {\n    const {id} = ctx.req.user;\n    const {gameId, playerNumber} = ctx.request.body;\n    if(!gameId || !playerNumber) {throw BAD_REQUEST;}\n    const playersInGame = await games.join(id, gameId, playerNumber);\n    ctx.ioGeneral.joinGame(playersInGame);\n    ctx.status = 200;\n  },\n\n  async addChatMessage(ctx)\n  {\n    const {message, gameId} = ctx.request.body;\n    if (!message) {\n        throw CANT_PROCESS_ENTITY\n    }\n    const {name, id} = ctx.req.user;\n    const savedMessage: IMessage = await saveMessage(message, id, gameId);\n    ctx.ioGame\n        .to(config.GAME_CHAT_ROOM_PREFIX+gameId)\n        .emit('GAME_CHAT_MESSAGE_ADDED', {\n          id: savedMessage.id,\n          username: name,\n          text: savedMessage.text,\n          date: savedMessage.date,\n        });\n    ctx.status = 201\n  },\n  async getChatHistory(ctx)\n  {\n    const {gameId} = ctx.params;\n    const messages = getMessages(gameId);\n    ctx.ioGame\n        .to(config.GAME_CHAT_ROOM_PREFIX+gameId)\n        .emit('GAME_CHAT_MESSAGE_HISTORY', await messages);\n    ctx.status = 200;\n  },\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f333c09f534dc6e6bc677677337176fab09b16f","contentHash":"73583e7f46da66a447860f093102b11e41095b1a88d43c6712206be115e89333"},"/app/app/db/queries/games.ts":{"path":"/app/app/db/queries/games.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":13},"end":{"line":39,"column":39}},"68":{"start":{"line":41,"column":16},"end":{"line":41,"column":20}},"69":{"start":{"line":42,"column":4},"end":{"line":63,"column":11}},"70":{"start":{"line":42,"column":55},"end":{"line":63,"column":7}},"71":{"start":{"line":44,"column":8},"end":{"line":62,"column":11}},"72":{"start":{"line":45,"column":12},"end":{"line":61,"column":13}},"73":{"start":{"line":46,"column":24},"end":{"line":49,"column":66}},"74":{"start":{"line":49,"column":47},"end":{"line":49,"column":61}},"75":{"start":{"line":51,"column":20},"end":{"line":51,"column":35}},"76":{"start":{"line":52,"column":20},"end":{"line":57,"column":56}},"77":{"start":{"line":59,"column":20},"end":{"line":59,"column":30}},"78":{"start":{"line":60,"column":20},"end":{"line":60,"column":46}},"79":{"start":{"line":66,"column":4},"end":{"line":66,"column":642}},"80":{"start":{"line":69,"column":4},"end":{"line":69,"column":578}},"81":{"start":{"line":69,"column":555},"end":{"line":69,"column":574}},"82":{"start":{"line":72,"column":4},"end":{"line":73,"column":64}},"83":{"start":{"line":73,"column":31},"end":{"line":73,"column":60}},"84":{"start":{"line":76,"column":4},"end":{"line":119,"column":7}},"85":{"start":{"line":78,"column":8},"end":{"line":118,"column":11}},"86":{"start":{"line":79,"column":12},"end":{"line":117,"column":13}},"87":{"start":{"line":80,"column":24},"end":{"line":80,"column":107}},"88":{"start":{"line":82,"column":20},"end":{"line":84,"column":21}},"89":{"start":{"line":83,"column":24},"end":{"line":83,"column":46}},"90":{"start":{"line":85,"column":20},"end":{"line":89,"column":22}},"91":{"start":{"line":90,"column":20},"end":{"line":90,"column":98}},"92":{"start":{"line":92,"column":20},"end":{"line":92,"column":60}},"93":{"start":{"line":92,"column":36},"end":{"line":92,"column":60}},"94":{"start":{"line":93,"column":20},"end":{"line":93,"column":89}},"95":{"start":{"line":95,"column":20},"end":{"line":95,"column":30}},"96":{"start":{"line":96,"column":20},"end":{"line":96,"column":42}},"97":{"start":{"line":97,"column":20},"end":{"line":97,"column":44}},"98":{"start":{"line":98,"column":24},"end":{"line":98,"column":82}},"99":{"start":{"line":100,"column":20},"end":{"line":100,"column":30}},"100":{"start":{"line":101,"column":20},"end":{"line":101,"column":88}},"101":{"start":{"line":103,"column":20},"end":{"line":103,"column":30}},"102":{"start":{"line":104,"column":20},"end":{"line":104,"column":42}},"103":{"start":{"line":105,"column":20},"end":{"line":105,"column":33}},"104":{"start":{"line":107,"column":20},"end":{"line":107,"column":30}},"105":{"start":{"line":108,"column":20},"end":{"line":109,"column":85}},"106":{"start":{"line":109,"column":51},"end":{"line":109,"column":80}},"107":{"start":{"line":111,"column":20},"end":{"line":112,"column":34}},"108":{"start":{"line":113,"column":20},"end":{"line":113,"column":69}},"109":{"start":{"line":115,"column":20},"end":{"line":115,"column":46}},"110":{"start":{"line":116,"column":20},"end":{"line":116,"column":90}},"111":{"start":{"line":122,"column":4},"end":{"line":125,"column":84}},"112":{"start":{"line":125,"column":66},"end":{"line":125,"column":80}},"113":{"start":{"line":128,"column":4},"end":{"line":132,"column":47}},"114":{"start":{"line":132,"column":29},"end":{"line":132,"column":43}},"115":{"start":{"line":135,"column":4},"end":{"line":139,"column":13}},"116":{"start":{"line":142,"column":4},"end":{"line":146,"column":7}},"117":{"start":{"line":149,"column":4},"end":{"line":152,"column":13}},"118":{"start":{"line":155,"column":4},"end":{"line":158,"column":48}},"119":{"start":{"line":158,"column":30},"end":{"line":158,"column":44}},"120":{"start":{"line":160,"column":0},"end":{"line":166,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"addGame","decl":{"start":{"line":40,"column":9},"end":{"line":40,"column":16}},"loc":{"start":{"line":40,"column":23},"end":{"line":64,"column":1}},"line":40},"14":{"name":"(anonymous_14)","decl":{"start":{"line":42,"column":38},"end":{"line":42,"column":39}},"loc":{"start":{"line":42,"column":53},"end":{"line":63,"column":9}},"line":42},"15":{"name":"(anonymous_15)","decl":{"start":{"line":42,"column":95},"end":{"line":42,"column":96}},"loc":{"start":{"line":42,"column":107},"end":{"line":63,"column":5}},"line":42},"16":{"name":"(anonymous_16)","decl":{"start":{"line":44,"column":33},"end":{"line":44,"column":34}},"loc":{"start":{"line":44,"column":47},"end":{"line":62,"column":9}},"line":44},"17":{"name":"(anonymous_17)","decl":{"start":{"line":49,"column":30},"end":{"line":49,"column":31}},"loc":{"start":{"line":49,"column":45},"end":{"line":49,"column":63}},"line":49},"18":{"name":"gamesForCity","decl":{"start":{"line":65,"column":9},"end":{"line":65,"column":21}},"loc":{"start":{"line":65,"column":30},"end":{"line":67,"column":1}},"line":65},"19":{"name":"get","decl":{"start":{"line":68,"column":9},"end":{"line":68,"column":12}},"loc":{"start":{"line":68,"column":17},"end":{"line":70,"column":1}},"line":68},"20":{"name":"(anonymous_20)","decl":{"start":{"line":69,"column":538},"end":{"line":69,"column":539}},"loc":{"start":{"line":69,"column":553},"end":{"line":69,"column":576}},"line":69},"21":{"name":"playerInGame","decl":{"start":{"line":71,"column":9},"end":{"line":71,"column":21}},"loc":{"start":{"line":71,"column":30},"end":{"line":74,"column":1}},"line":71},"22":{"name":"(anonymous_22)","decl":{"start":{"line":73,"column":14},"end":{"line":73,"column":15}},"loc":{"start":{"line":73,"column":29},"end":{"line":73,"column":62}},"line":73},"23":{"name":"join","decl":{"start":{"line":75,"column":9},"end":{"line":75,"column":13}},"loc":{"start":{"line":75,"column":51},"end":{"line":120,"column":1}},"line":75},"24":{"name":"(anonymous_24)","decl":{"start":{"line":76,"column":43},"end":{"line":76,"column":44}},"loc":{"start":{"line":76,"column":55},"end":{"line":119,"column":5}},"line":76},"25":{"name":"(anonymous_25)","decl":{"start":{"line":78,"column":33},"end":{"line":78,"column":34}},"loc":{"start":{"line":78,"column":47},"end":{"line":118,"column":9}},"line":78},"26":{"name":"(anonymous_26)","decl":{"start":{"line":109,"column":34},"end":{"line":109,"column":35}},"loc":{"start":{"line":109,"column":49},"end":{"line":109,"column":82}},"line":109},"27":{"name":"checkIfPositionOccupied","decl":{"start":{"line":121,"column":9},"end":{"line":121,"column":32}},"loc":{"start":{"line":121,"column":70},"end":{"line":126,"column":1}},"line":121},"28":{"name":"(anonymous_28)","decl":{"start":{"line":125,"column":49},"end":{"line":125,"column":50}},"loc":{"start":{"line":125,"column":64},"end":{"line":125,"column":82}},"line":125},"29":{"name":"checkIfAlreadyJoin","decl":{"start":{"line":127,"column":9},"end":{"line":127,"column":27}},"loc":{"start":{"line":127,"column":65},"end":{"line":133,"column":1}},"line":127},"30":{"name":"(anonymous_30)","decl":{"start":{"line":132,"column":12},"end":{"line":132,"column":13}},"loc":{"start":{"line":132,"column":27},"end":{"line":132,"column":45}},"line":132},"31":{"name":"leaveGame","decl":{"start":{"line":134,"column":9},"end":{"line":134,"column":18}},"loc":{"start":{"line":134,"column":56},"end":{"line":140,"column":1}},"line":134},"32":{"name":"joinGame","decl":{"start":{"line":141,"column":9},"end":{"line":141,"column":17}},"loc":{"start":{"line":141,"column":55},"end":{"line":147,"column":1}},"line":141},"33":{"name":"cleanPrevPosition","decl":{"start":{"line":148,"column":9},"end":{"line":148,"column":26}},"loc":{"start":{"line":148,"column":45},"end":{"line":153,"column":1}},"line":148},"34":{"name":"countPlayersInGame","decl":{"start":{"line":154,"column":9},"end":{"line":154,"column":27}},"loc":{"start":{"line":154,"column":36},"end":{"line":159,"column":1}},"line":154},"35":{"name":"(anonymous_35)","decl":{"start":{"line":158,"column":13},"end":{"line":158,"column":14}},"loc":{"start":{"line":158,"column":28},"end":{"line":158,"column":46}},"line":158}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":45,"column":12},"end":{"line":61,"column":13}},"type":"switch","locations":[{"start":{"line":46,"column":16},"end":{"line":49,"column":66}},{"start":{"line":50,"column":16},"end":{"line":57,"column":56}},{"start":{"line":58,"column":16},"end":{"line":60,"column":46}}],"line":45},"30":{"loc":{"start":{"line":79,"column":12},"end":{"line":117,"column":13}},"type":"switch","locations":[{"start":{"line":80,"column":16},"end":{"line":80,"column":107}},{"start":{"line":81,"column":16},"end":{"line":90,"column":98}},{"start":{"line":91,"column":16},"end":{"line":93,"column":89}},{"start":{"line":94,"column":16},"end":{"line":97,"column":44}},{"start":{"line":98,"column":16},"end":{"line":98,"column":82}},{"start":{"line":99,"column":16},"end":{"line":101,"column":88}},{"start":{"line":102,"column":16},"end":{"line":105,"column":33}},{"start":{"line":106,"column":16},"end":{"line":109,"column":85}},{"start":{"line":110,"column":16},"end":{"line":113,"column":69}},{"start":{"line":114,"column":16},"end":{"line":116,"column":90}}],"line":79},"31":{"loc":{"start":{"line":82,"column":20},"end":{"line":84,"column":21}},"type":"if","locations":[{"start":{"line":82,"column":20},"end":{"line":84,"column":21}},{"start":{"line":82,"column":20},"end":{"line":84,"column":21}}],"line":82},"32":{"loc":{"start":{"line":92,"column":20},"end":{"line":92,"column":60}},"type":"if","locations":[{"start":{"line":92,"column":20},"end":{"line":92,"column":60}},{"start":{"line":92,"column":20},"end":{"line":92,"column":60}}],"line":92}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0,0],"30":[0,0,0,0,0,0,0,0,0,0],"31":[0,0],"32":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/db/queries/games.ts","sources":["/app/app/db/queries/games.ts"],"names":[],"mappings":"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","sourcesContent":["import knex from '../../libs/knex'\nimport {IGame} from './interfaces/Igames'\n\nfunction addGame(game: IGame.IGame): Promise<number> {\n  return knex.transaction(async (trx) => {\n    const id: number = await trx.insert(game)\n        .into('games')\n        .returning('id')\n        .then((res) => res[0]);\n    await trx.insert(\n        {\n          player_id: game.author_id,\n          player_field_number: 1,\n          game_id: id\n        })\n        .into('games_composition');\n    return id;\n  });\n}\n\nfunction gamesForCity(cityId: number): Promise<{rows: any}> {\n  return knex.raw(\n      `\n    select g.id,\n           c.title_ru as city,\n           g.address,\n           g.players,\n           g.district,\n           g.additional,\n           g.date,\n           gp.active_players as \"activePlayers\"\n    from games as g\n    join _cities c on g.city_id = c.city_id\n    left join\n      (\n        select\n          coalesce(count(game_id), 0) as active_players,\n          game_id\n        from games_composition group by game_id\n      )\n    gp on gp.game_id = g.id\n    where c.city_id = ?\n    and g.status = 'forming'\n    and g.date > CURRENT_TIMESTAMP + interval '2h'\n  `,\n      [cityId]\n  );\n}\n\nfunction get(id: number) {\n  return knex.raw(\n      `select *,\n            c.title_ru as city,\n            case when gp.active_players\n              is null then 0 else gp.active_players end as active_players\n            from games g\n              join _cities c on g.city_id = c.city_id\n              left join (\n                select count(*)::int as active_players, game_id\n                from games_composition where game_id = :id\n                group by game_id) gp on gp.game_id = g.id where g.id = :id\n                  `, {id}\n  ).then((res) => res.rows[0]);\n}\n\nfunction playerInGame(gameId: number) {\n  return knex.raw(`\n        select array_agg(player_field_number)\n        from games_composition where game_id = :gameId`, {gameId})\n      .then((res)=> res.rows[0].array_agg);\n}\n\nasync function join(\n    playerId: number,\n    gameId: number,\n    playerFieldNumber: number) {\n  if (await checkIfPositionOccupied(playerFieldNumber, gameId, playerId)) {\n    return;\n  }\n\n  const info:IGame.IInfo = {\n    playerFieldNumber,\n    gameId,\n    playerId\n  };\n  if (await checkIfAlreadyJoin(playerFieldNumber, gameId, playerId)) {\n    await leaveGame(playerFieldNumber, gameId, playerId);\n    info.event = 'leaved';\n  } else {\n    await cleanPrevPosition(gameId, playerId);\n    await joinGame(playerFieldNumber, gameId, playerId);\n    info.event = 'joined';\n  }\n  info.fieldNumbersInGame =\n    await knex.raw(`\n    select array_agg(player_field_number)\n    from games_composition where game_id = ?`, gameId)\n        .then((res)=> res.rows[0].array_agg);\n  const {count} = await countPlayersInGame(gameId);\n  return {gameId, players: count, info};\n}\n\nfunction checkIfPositionOccupied(\n    playerFieldNumber: number,\n    gameId: number,\n    playerId: number) {\n  return knex('games_composition').where({\n    player_field_number: playerFieldNumber,\n    game_id: gameId,\n  }).andWhereNot({player_id: playerId}).then((res)=>res[0]);\n}\n\nfunction checkIfAlreadyJoin(\n    playerFieldNumber: number,\n    gameId: number,\n    playerId: number) {\n  return knex('games_composition').where(\n      {\n        game_id: gameId,\n        player_id: playerId,\n        player_field_number: playerFieldNumber,\n      }).then((res) => res[0]);\n}\n\nfunction leaveGame(\n    playerFieldNumber: number,\n    gameId: number,\n    playerId: number) {\n  return knex('games_composition').where({\n    game_id: gameId,\n    player_id: playerId,\n    player_field_number: playerFieldNumber,\n  }).del();\n}\n\nfunction joinGame(\n    playerFieldNumber: number,\n    gameId: number,\n    playerId: number) {\n  return knex('games_composition').insert({\n    game_id: gameId,\n    player_id: playerId,\n    player_field_number: playerFieldNumber,\n  });\n}\n\nfunction cleanPrevPosition(gameId: number, playerId: number) {\n  return knex('games_composition').where({\n    game_id: gameId,\n    player_id: playerId,\n  }).del();\n}\nfunction countPlayersInGame(gameId: number) {\n  return knex('games_composition').\n      where({game_id: gameId}).\n      count().\n      then((res) => res[0]);\n}\nexport default {\n  addGame,\n  get,\n  join,\n  gamesForCity,\n  playerInGame,\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2f5e2d91a9a056525d27a0aa5f5bc5340ee03990","contentHash":"ea30298b217a34e281270edd1912c80ec0abe06cae6911c54aa935ebea1300b4"},"/app/app/db/queries/messages.ts":{"path":"/app/app/db/queries/messages.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":13},"end":{"line":39,"column":39}},"68":{"start":{"line":41,"column":4},"end":{"line":52,"column":7}},"69":{"start":{"line":42,"column":8},"end":{"line":51,"column":11}},"70":{"start":{"line":43,"column":12},"end":{"line":50,"column":62}},"71":{"start":{"line":50,"column":43},"end":{"line":50,"column":57}},"72":{"start":{"line":54,"column":0},"end":{"line":54,"column":34}},"73":{"start":{"line":56,"column":4},"end":{"line":65,"column":7}},"74":{"start":{"line":57,"column":8},"end":{"line":64,"column":11}},"75":{"start":{"line":58,"column":12},"end":{"line":63,"column":47}},"76":{"start":{"line":67,"column":0},"end":{"line":67,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"saveMessage","decl":{"start":{"line":40,"column":9},"end":{"line":40,"column":20}},"loc":{"start":{"line":40,"column":43},"end":{"line":53,"column":1}},"line":40},"14":{"name":"(anonymous_14)","decl":{"start":{"line":41,"column":43},"end":{"line":41,"column":44}},"loc":{"start":{"line":41,"column":55},"end":{"line":52,"column":5}},"line":41},"15":{"name":"(anonymous_15)","decl":{"start":{"line":42,"column":33},"end":{"line":42,"column":34}},"loc":{"start":{"line":42,"column":47},"end":{"line":51,"column":9}},"line":42},"16":{"name":"(anonymous_16)","decl":{"start":{"line":50,"column":26},"end":{"line":50,"column":27}},"loc":{"start":{"line":50,"column":41},"end":{"line":50,"column":59}},"line":50},"17":{"name":"getMessages","decl":{"start":{"line":55,"column":9},"end":{"line":55,"column":20}},"loc":{"start":{"line":55,"column":29},"end":{"line":66,"column":1}},"line":55},"18":{"name":"(anonymous_18)","decl":{"start":{"line":56,"column":43},"end":{"line":56,"column":44}},"loc":{"start":{"line":56,"column":55},"end":{"line":65,"column":5}},"line":56},"19":{"name":"(anonymous_19)","decl":{"start":{"line":57,"column":33},"end":{"line":57,"column":34}},"loc":{"start":{"line":57,"column":47},"end":{"line":64,"column":9}},"line":57}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/db/queries/messages.ts","sources":["/app/app/db/queries/messages.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,wCAAkC;AAGlC,SAAe,WAAW,CAAC,IAAY,EAAE,MAAc,EAAE,MAAc;;;YAC/D,sBAAO,cAAI,CAAC,UAAU,CAAC;qBAClB,MAAM,CAAC;oBACA,IAAI,MAAA;oBACJ,OAAO,EAAE,MAAM;oBACf,OAAO,EAAE,MAAM;iBAClB,CAAC;qBACT,SAAS,CAAC,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;qBACjC,IAAI,CAAC,UAAC,GAAG,IAAI,OAAA,GAAG,CAAC,CAAC,CAAC,EAAN,CAAM,CAAC,EAAC;;;CAC7B;AAiBG,kCAAW;AAhBf,SAAe,WAAW,CAAC,MAAM;;;YAC7B,sBAAO,cAAI;qBACN,MAAM,CAAC,mBAAmB,EACnB,cAAI,CAAC,GAAG,CAAC,qNAII,CAAC,EACd,uBAAuB,EACvB,uBAAuB,CAAC;qBAC/B,IAAI,CAAC,UAAU,CAAC;qBAChB,QAAQ,CAAC,OAAO,EAAE,kBAAkB,EAAE,UAAU,CAAC;qBACjD,OAAO,CAAC,MAAM,EAAC,MAAM,CAAC;qBACtB,KAAK,CAAC,SAAS,EAAE,MAAM,CAAC,EAAA;;;CAChC;AAGG,kCAAW","sourcesContent":["import knex from '../../libs/knex'\nimport {IMessage} from './interfaces/Imessage'\n\nasync function saveMessage(text: string, userId: number, gameId: number): Promise<IMessage> {\n        return knex('messages')\n            .insert({\n                    text,\n                    user_id: userId,\n                    game_id: gameId\n                })\n        .returning(['id', 'text', 'date'])\n        .then((res)=> res[0]);\n}\nasync function getMessages(gameId) {\n    return knex\n        .select('messages.id as id',\n                knex.raw(`\n                (CASE WHEN\n                (users.local->>'name' IS NULL OR users.local->>'name' = '')\n                 THEN users.google->>'name' ELSE users.local->>'name' END)\n                 as username`),\n                'messages.date as date',\n                'messages.text as text')\n        .from('messages')\n        .leftJoin('users', 'messages.user_id', 'users.id')\n        .orderBy('date','desc')\n        .where('game_id', gameId)\n}\nexport {\n    saveMessage,\n    getMessages\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f237c4bbc0673cda7b6701652285e610ee1e2e8f","contentHash":"d583ba0243c389796954f6834cc03de77bbc67a4a59e96a759d0054a7d0f3d14"},"/app/app/test/integrations/mock.user.ts":{"path":"/app/app/test/integrations/mock.user.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":7,"column":2}},"2":{"start":{"line":8,"column":0},"end":{"line":11,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/test/integrations/mock.user.ts","sources":["/app/app/test/integrations/mock.user.ts"],"names":[],"mappings":";;AAAa,QAAA,UAAU,GAAG;IACtB,IAAI,EAAE,SAAS;IACf,KAAK,EAAE,kBAAkB;IACzB,QAAQ,EAAE,QAAQ;CACrB,CAAA;AACY,QAAA,oBAAoB,GAAG;IAChC,KAAK,EAAE,kBAAkB;IACzB,QAAQ,EAAE,QAAQ;CACrB,CAAA","sourcesContent":["export const MockedUser = {\n    name: 'michael',\n    email: 'michael@test.com',\n    password: 'herman',\n}\nexport const MockedUserCredetials = {\n    email: 'michael@test.com',\n    password: 'herman',\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"59d8d5331023de3ce844f4d224a3c28634a99813","contentHash":"6a262c04c7313024209c7c362319077bacecece093f1a23bfe7af9c800d3e382"},"/app/app/test/integrations/games.spec.ts":{"path":"/app/app/test/integrations/games.spec.ts","statementMap":{"0":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":110}},"2":{"start":{"line":3,"column":91},"end":{"line":3,"column":106}},"3":{"start":{"line":4,"column":4},"end":{"line":9,"column":7}},"4":{"start":{"line":5,"column":36},"end":{"line":5,"column":97}},"5":{"start":{"line":5,"column":42},"end":{"line":5,"column":70}},"6":{"start":{"line":5,"column":85},"end":{"line":5,"column":95}},"7":{"start":{"line":6,"column":35},"end":{"line":6,"column":100}},"8":{"start":{"line":6,"column":41},"end":{"line":6,"column":73}},"9":{"start":{"line":6,"column":88},"end":{"line":6,"column":98}},"10":{"start":{"line":7,"column":32},"end":{"line":7,"column":116}},"11":{"start":{"line":8,"column":8},"end":{"line":8,"column":78}},"12":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"13":{"start":{"line":12,"column":12},"end":{"line":12,"column":104}},"14":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"15":{"start":{"line":12,"column":57},"end":{"line":12,"column":68}},"16":{"start":{"line":12,"column":69},"end":{"line":12,"column":81}},"17":{"start":{"line":13,"column":4},"end":{"line":13,"column":157}},"18":{"start":{"line":13,"column":138},"end":{"line":13,"column":150}},"19":{"start":{"line":14,"column":23},"end":{"line":14,"column":68}},"20":{"start":{"line":14,"column":45},"end":{"line":14,"column":65}},"21":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"22":{"start":{"line":16,"column":15},"end":{"line":16,"column":70}},"23":{"start":{"line":17,"column":8},"end":{"line":34,"column":66}},"24":{"start":{"line":17,"column":18},"end":{"line":34,"column":66}},"25":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"26":{"start":{"line":18,"column":160},"end":{"line":18,"column":169}},"27":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"28":{"start":{"line":19,"column":26},"end":{"line":19,"column":52}},"29":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"30":{"start":{"line":21,"column":32},"end":{"line":21,"column":39}},"31":{"start":{"line":21,"column":40},"end":{"line":21,"column":46}},"32":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"33":{"start":{"line":22,"column":35},"end":{"line":22,"column":72}},"34":{"start":{"line":23,"column":24},"end":{"line":23,"column":34}},"35":{"start":{"line":23,"column":35},"end":{"line":23,"column":45}},"36":{"start":{"line":23,"column":46},"end":{"line":23,"column":55}},"37":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"38":{"start":{"line":24,"column":24},"end":{"line":24,"column":41}},"39":{"start":{"line":24,"column":42},"end":{"line":24,"column":55}},"40":{"start":{"line":24,"column":56},"end":{"line":24,"column":65}},"41":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"42":{"start":{"line":26,"column":110},"end":{"line":26,"column":116}},"43":{"start":{"line":26,"column":117},"end":{"line":26,"column":126}},"44":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"45":{"start":{"line":27,"column":81},"end":{"line":27,"column":97}},"46":{"start":{"line":27,"column":98},"end":{"line":27,"column":104}},"47":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"48":{"start":{"line":28,"column":57},"end":{"line":28,"column":72}},"49":{"start":{"line":28,"column":73},"end":{"line":28,"column":80}},"50":{"start":{"line":28,"column":81},"end":{"line":28,"column":87}},"51":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"52":{"start":{"line":29,"column":47},"end":{"line":29,"column":62}},"53":{"start":{"line":29,"column":63},"end":{"line":29,"column":78}},"54":{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},"55":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"56":{"start":{"line":30,"column":30},"end":{"line":30,"column":42}},"57":{"start":{"line":31,"column":20},"end":{"line":31,"column":33}},"58":{"start":{"line":31,"column":34},"end":{"line":31,"column":43}},"59":{"start":{"line":33,"column":12},"end":{"line":33,"column":39}},"60":{"start":{"line":34,"column":22},"end":{"line":34,"column":34}},"61":{"start":{"line":34,"column":35},"end":{"line":34,"column":41}},"62":{"start":{"line":34,"column":54},"end":{"line":34,"column":64}},"63":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"64":{"start":{"line":35,"column":23},"end":{"line":35,"column":35}},"65":{"start":{"line":35,"column":36},"end":{"line":35,"column":89}},"66":{"start":{"line":38,"column":0},"end":{"line":38,"column":62}},"67":{"start":{"line":39,"column":15},"end":{"line":39,"column":47}},"68":{"start":{"line":40,"column":13},"end":{"line":40,"column":30}},"69":{"start":{"line":41,"column":13},"end":{"line":41,"column":39}},"70":{"start":{"line":42,"column":10},"end":{"line":42,"column":30}},"71":{"start":{"line":43,"column":18},"end":{"line":43,"column":40}},"72":{"start":{"line":44,"column":11},"end":{"line":44,"column":41}},"73":{"start":{"line":45,"column":11},"end":{"line":45,"column":26}},"74":{"start":{"line":46,"column":15},"end":{"line":46,"column":35}},"75":{"start":{"line":47,"column":0},"end":{"line":47,"column":19}},"76":{"start":{"line":48,"column":12},"end":{"line":48,"column":28}},"77":{"start":{"line":49,"column":18},"end":{"line":49,"column":40}},"78":{"start":{"line":51,"column":4},"end":{"line":69,"column":7}},"79":{"start":{"line":52,"column":8},"end":{"line":68,"column":11}},"80":{"start":{"line":53,"column":12},"end":{"line":67,"column":13}},"81":{"start":{"line":54,"column":24},"end":{"line":65,"column":24}},"82":{"start":{"line":66,"column":24},"end":{"line":66,"column":57}},"83":{"start":{"line":71,"column":0},"end":{"line":71,"column":32}},"84":{"start":{"line":72,"column":0},"end":{"line":316,"column":3}},"85":{"start":{"line":73,"column":4},"end":{"line":82,"column":7}},"86":{"start":{"line":74,"column":8},"end":{"line":81,"column":11}},"87":{"start":{"line":77,"column":12},"end":{"line":77,"column":51}},"88":{"start":{"line":80,"column":12},"end":{"line":80,"column":45}},"89":{"start":{"line":83,"column":4},"end":{"line":86,"column":7}},"90":{"start":{"line":84,"column":8},"end":{"line":84,"column":24}},"91":{"start":{"line":85,"column":8},"end":{"line":85,"column":49}},"92":{"start":{"line":87,"column":4},"end":{"line":108,"column":11}},"93":{"start":{"line":87,"column":58},"end":{"line":108,"column":7}},"94":{"start":{"line":89,"column":8},"end":{"line":107,"column":11}},"95":{"start":{"line":90,"column":12},"end":{"line":106,"column":13}},"96":{"start":{"line":91,"column":24},"end":{"line":101,"column":24}},"97":{"start":{"line":103,"column":20},"end":{"line":103,"column":36}},"98":{"start":{"line":104,"column":20},"end":{"line":104,"column":56}},"99":{"start":{"line":105,"column":20},"end":{"line":105,"column":42}},"100":{"start":{"line":109,"column":4},"end":{"line":156,"column":11}},"101":{"start":{"line":109,"column":50},"end":{"line":156,"column":7}},"102":{"start":{"line":111,"column":8},"end":{"line":155,"column":11}},"103":{"start":{"line":112,"column":12},"end":{"line":154,"column":13}},"104":{"start":{"line":114,"column":20},"end":{"line":116,"column":23}},"105":{"start":{"line":115,"column":24},"end":{"line":115,"column":36}},"106":{"start":{"line":117,"column":20},"end":{"line":120,"column":59}},"107":{"start":{"line":122,"column":20},"end":{"line":122,"column":30}},"108":{"start":{"line":123,"column":20},"end":{"line":126,"column":70}},"109":{"start":{"line":128,"column":20},"end":{"line":128,"column":30}},"110":{"start":{"line":129,"column":20},"end":{"line":133,"column":69}},"111":{"start":{"line":135,"column":20},"end":{"line":135,"column":36}},"112":{"start":{"line":136,"column":20},"end":{"line":136,"column":83}},"113":{"start":{"line":137,"column":20},"end":{"line":137,"column":93}},"114":{"start":{"line":138,"column":20},"end":{"line":149,"column":28}},"115":{"start":{"line":151,"column":20},"end":{"line":151,"column":43}},"116":{"start":{"line":152,"column":20},"end":{"line":152,"column":63}},"117":{"start":{"line":153,"column":20},"end":{"line":153,"column":42}},"118":{"start":{"line":157,"column":4},"end":{"line":179,"column":11}},"119":{"start":{"line":157,"column":41},"end":{"line":179,"column":7}},"120":{"start":{"line":159,"column":8},"end":{"line":178,"column":11}},"121":{"start":{"line":160,"column":12},"end":{"line":177,"column":13}},"122":{"start":{"line":161,"column":24},"end":{"line":161,"column":73}},"123":{"start":{"line":163,"column":20},"end":{"line":163,"column":30}},"124":{"start":{"line":164,"column":20},"end":{"line":164,"column":66}},"125":{"start":{"line":166,"column":20},"end":{"line":166,"column":85}},"126":{"start":{"line":167,"column":20},"end":{"line":167,"column":74}},"127":{"start":{"line":169,"column":20},"end":{"line":169,"column":30}},"128":{"start":{"line":170,"column":20},"end":{"line":172,"column":45}},"129":{"start":{"line":174,"column":20},"end":{"line":174,"column":39}},"130":{"start":{"line":175,"column":20},"end":{"line":175,"column":70}},"131":{"start":{"line":176,"column":20},"end":{"line":176,"column":42}},"132":{"start":{"line":180,"column":4},"end":{"line":193,"column":11}},"133":{"start":{"line":180,"column":42},"end":{"line":193,"column":7}},"134":{"start":{"line":182,"column":8},"end":{"line":192,"column":11}},"135":{"start":{"line":183,"column":12},"end":{"line":191,"column":13}},"136":{"start":{"line":184,"column":24},"end":{"line":186,"column":66}},"137":{"start":{"line":188,"column":20},"end":{"line":188,"column":41}},"138":{"start":{"line":189,"column":20},"end":{"line":189,"column":61}},"139":{"start":{"line":190,"column":20},"end":{"line":190,"column":42}},"140":{"start":{"line":194,"column":4},"end":{"line":216,"column":11}},"141":{"start":{"line":194,"column":50},"end":{"line":216,"column":7}},"142":{"start":{"line":196,"column":8},"end":{"line":215,"column":11}},"143":{"start":{"line":197,"column":12},"end":{"line":214,"column":13}},"144":{"start":{"line":198,"column":24},"end":{"line":198,"column":73}},"145":{"start":{"line":200,"column":20},"end":{"line":200,"column":30}},"146":{"start":{"line":201,"column":20},"end":{"line":201,"column":66}},"147":{"start":{"line":203,"column":20},"end":{"line":203,"column":85}},"148":{"start":{"line":204,"column":20},"end":{"line":204,"column":74}},"149":{"start":{"line":206,"column":20},"end":{"line":206,"column":30}},"150":{"start":{"line":207,"column":20},"end":{"line":209,"column":50}},"151":{"start":{"line":211,"column":20},"end":{"line":211,"column":44}},"152":{"start":{"line":212,"column":20},"end":{"line":212,"column":55}},"153":{"start":{"line":213,"column":20},"end":{"line":213,"column":42}},"154":{"start":{"line":217,"column":4},"end":{"line":240,"column":11}},"155":{"start":{"line":217,"column":45},"end":{"line":240,"column":7}},"156":{"start":{"line":219,"column":8},"end":{"line":239,"column":11}},"157":{"start":{"line":220,"column":12},"end":{"line":238,"column":13}},"158":{"start":{"line":221,"column":24},"end":{"line":221,"column":73}},"159":{"start":{"line":223,"column":20},"end":{"line":223,"column":30}},"160":{"start":{"line":224,"column":20},"end":{"line":224,"column":66}},"161":{"start":{"line":226,"column":20},"end":{"line":226,"column":85}},"162":{"start":{"line":227,"column":20},"end":{"line":227,"column":74}},"163":{"start":{"line":229,"column":20},"end":{"line":229,"column":30}},"164":{"start":{"line":230,"column":20},"end":{"line":233,"column":72}},"165":{"start":{"line":235,"column":20},"end":{"line":235,"column":36}},"166":{"start":{"line":236,"column":20},"end":{"line":236,"column":60}},"167":{"start":{"line":237,"column":20},"end":{"line":237,"column":42}},"168":{"start":{"line":241,"column":4},"end":{"line":265,"column":11}},"169":{"start":{"line":241,"column":41},"end":{"line":265,"column":7}},"170":{"start":{"line":243,"column":8},"end":{"line":264,"column":11}},"171":{"start":{"line":244,"column":12},"end":{"line":263,"column":13}},"172":{"start":{"line":245,"column":24},"end":{"line":245,"column":73}},"173":{"start":{"line":247,"column":20},"end":{"line":247,"column":30}},"174":{"start":{"line":248,"column":20},"end":{"line":248,"column":66}},"175":{"start":{"line":250,"column":20},"end":{"line":250,"column":85}},"176":{"start":{"line":251,"column":20},"end":{"line":251,"column":74}},"177":{"start":{"line":253,"column":20},"end":{"line":253,"column":30}},"178":{"start":{"line":254,"column":20},"end":{"line":258,"column":67}},"179":{"start":{"line":260,"column":20},"end":{"line":260,"column":36}},"180":{"start":{"line":261,"column":20},"end":{"line":261,"column":53}},"181":{"start":{"line":262,"column":20},"end":{"line":262,"column":42}},"182":{"start":{"line":266,"column":4},"end":{"line":290,"column":11}},"183":{"start":{"line":266,"column":47},"end":{"line":290,"column":7}},"184":{"start":{"line":268,"column":8},"end":{"line":289,"column":11}},"185":{"start":{"line":269,"column":12},"end":{"line":288,"column":13}},"186":{"start":{"line":270,"column":24},"end":{"line":270,"column":73}},"187":{"start":{"line":272,"column":20},"end":{"line":272,"column":30}},"188":{"start":{"line":273,"column":20},"end":{"line":273,"column":66}},"189":{"start":{"line":275,"column":20},"end":{"line":275,"column":85}},"190":{"start":{"line":276,"column":20},"end":{"line":276,"column":74}},"191":{"start":{"line":278,"column":20},"end":{"line":278,"column":30}},"192":{"start":{"line":279,"column":20},"end":{"line":283,"column":50}},"193":{"start":{"line":285,"column":20},"end":{"line":285,"column":36}},"194":{"start":{"line":286,"column":20},"end":{"line":286,"column":60}},"195":{"start":{"line":287,"column":20},"end":{"line":287,"column":42}},"196":{"start":{"line":291,"column":4},"end":{"line":315,"column":11}},"197":{"start":{"line":291,"column":43},"end":{"line":315,"column":7}},"198":{"start":{"line":293,"column":8},"end":{"line":314,"column":11}},"199":{"start":{"line":294,"column":12},"end":{"line":313,"column":13}},"200":{"start":{"line":295,"column":24},"end":{"line":295,"column":73}},"201":{"start":{"line":297,"column":20},"end":{"line":297,"column":30}},"202":{"start":{"line":298,"column":20},"end":{"line":298,"column":66}},"203":{"start":{"line":300,"column":20},"end":{"line":300,"column":85}},"204":{"start":{"line":301,"column":20},"end":{"line":301,"column":74}},"205":{"start":{"line":303,"column":20},"end":{"line":303,"column":30}},"206":{"start":{"line":304,"column":20},"end":{"line":308,"column":76}},"207":{"start":{"line":310,"column":20},"end":{"line":310,"column":36}},"208":{"start":{"line":311,"column":20},"end":{"line":311,"column":60}},"209":{"start":{"line":312,"column":20},"end":{"line":312,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":44},"end":{"line":2,"column":45}},"loc":{"start":{"line":2,"column":89},"end":{"line":10,"column":1}},"line":2},"1":{"name":"adopt","decl":{"start":{"line":3,"column":13},"end":{"line":3,"column":18}},"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":112}},"line":3},"2":{"name":"(anonymous_2)","decl":{"start":{"line":3,"column":70},"end":{"line":3,"column":71}},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":108}},"line":3},"3":{"name":"(anonymous_3)","decl":{"start":{"line":4,"column":36},"end":{"line":4,"column":37}},"loc":{"start":{"line":4,"column":63},"end":{"line":9,"column":5}},"line":4},"4":{"name":"fulfilled","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":34},"end":{"line":5,"column":99}},"line":5},"5":{"name":"rejected","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":25}},"loc":{"start":{"line":6,"column":33},"end":{"line":6,"column":102}},"line":6},"6":{"name":"step","decl":{"start":{"line":7,"column":17},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":30},"end":{"line":7,"column":118}},"line":7},"7":{"name":"(anonymous_7)","decl":{"start":{"line":11,"column":48},"end":{"line":11,"column":49}},"loc":{"start":{"line":11,"column":73},"end":{"line":37,"column":1}},"line":11},"8":{"name":"(anonymous_8)","decl":{"start":{"line":12,"column":30},"end":{"line":12,"column":31}},"loc":{"start":{"line":12,"column":41},"end":{"line":12,"column":83}},"line":12},"9":{"name":"(anonymous_9)","decl":{"start":{"line":13,"column":125},"end":{"line":13,"column":126}},"loc":{"start":{"line":13,"column":136},"end":{"line":13,"column":152}},"line":13},"10":{"name":"verb","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":21},"end":{"line":14,"column":70}},"line":14},"11":{"name":"(anonymous_11)","decl":{"start":{"line":14,"column":30},"end":{"line":14,"column":31}},"loc":{"start":{"line":14,"column":43},"end":{"line":14,"column":67}},"line":14},"12":{"name":"step","decl":{"start":{"line":15,"column":13},"end":{"line":15,"column":17}},"loc":{"start":{"line":15,"column":22},"end":{"line":36,"column":5}},"line":15},"13":{"name":"createGame","decl":{"start":{"line":50,"column":9},"end":{"line":50,"column":19}},"loc":{"start":{"line":50,"column":41},"end":{"line":70,"column":1}},"line":50},"14":{"name":"(anonymous_14)","decl":{"start":{"line":51,"column":43},"end":{"line":51,"column":44}},"loc":{"start":{"line":51,"column":55},"end":{"line":69,"column":5}},"line":51},"15":{"name":"(anonymous_15)","decl":{"start":{"line":52,"column":33},"end":{"line":52,"column":34}},"loc":{"start":{"line":52,"column":47},"end":{"line":68,"column":9}},"line":52},"16":{"name":"(anonymous_16)","decl":{"start":{"line":72,"column":27},"end":{"line":72,"column":28}},"loc":{"start":{"line":72,"column":39},"end":{"line":316,"column":1}},"line":72},"17":{"name":"(anonymous_17)","decl":{"start":{"line":73,"column":15},"end":{"line":73,"column":16}},"loc":{"start":{"line":73,"column":27},"end":{"line":82,"column":5}},"line":73},"18":{"name":"(anonymous_18)","decl":{"start":{"line":76,"column":18},"end":{"line":76,"column":19}},"loc":{"start":{"line":76,"column":30},"end":{"line":78,"column":9}},"line":76},"19":{"name":"(anonymous_19)","decl":{"start":{"line":79,"column":18},"end":{"line":79,"column":19}},"loc":{"start":{"line":79,"column":30},"end":{"line":81,"column":9}},"line":79},"20":{"name":"(anonymous_20)","decl":{"start":{"line":83,"column":14},"end":{"line":83,"column":15}},"loc":{"start":{"line":83,"column":26},"end":{"line":86,"column":5}},"line":83},"21":{"name":"(anonymous_21)","decl":{"start":{"line":87,"column":44},"end":{"line":87,"column":45}},"loc":{"start":{"line":87,"column":56},"end":{"line":108,"column":9}},"line":87},"22":{"name":"(anonymous_22)","decl":{"start":{"line":87,"column":99},"end":{"line":87,"column":100}},"loc":{"start":{"line":87,"column":111},"end":{"line":108,"column":5}},"line":87},"23":{"name":"(anonymous_23)","decl":{"start":{"line":89,"column":33},"end":{"line":89,"column":34}},"loc":{"start":{"line":89,"column":47},"end":{"line":107,"column":9}},"line":89},"24":{"name":"(anonymous_24)","decl":{"start":{"line":109,"column":36},"end":{"line":109,"column":37}},"loc":{"start":{"line":109,"column":48},"end":{"line":156,"column":9}},"line":109},"25":{"name":"(anonymous_25)","decl":{"start":{"line":109,"column":91},"end":{"line":109,"column":92}},"loc":{"start":{"line":109,"column":103},"end":{"line":156,"column":5}},"line":109},"26":{"name":"(anonymous_26)","decl":{"start":{"line":111,"column":33},"end":{"line":111,"column":34}},"loc":{"start":{"line":111,"column":47},"end":{"line":155,"column":9}},"line":111},"27":{"name":"fakeFn","decl":{"start":{"line":114,"column":81},"end":{"line":114,"column":87}},"loc":{"start":{"line":114,"column":90},"end":{"line":116,"column":21}},"line":114},"28":{"name":"(anonymous_28)","decl":{"start":{"line":157,"column":27},"end":{"line":157,"column":28}},"loc":{"start":{"line":157,"column":39},"end":{"line":179,"column":9}},"line":157},"29":{"name":"(anonymous_29)","decl":{"start":{"line":157,"column":82},"end":{"line":157,"column":83}},"loc":{"start":{"line":157,"column":94},"end":{"line":179,"column":5}},"line":157},"30":{"name":"(anonymous_30)","decl":{"start":{"line":159,"column":33},"end":{"line":159,"column":34}},"loc":{"start":{"line":159,"column":47},"end":{"line":178,"column":9}},"line":159},"31":{"name":"(anonymous_31)","decl":{"start":{"line":180,"column":28},"end":{"line":180,"column":29}},"loc":{"start":{"line":180,"column":40},"end":{"line":193,"column":9}},"line":180},"32":{"name":"(anonymous_32)","decl":{"start":{"line":180,"column":83},"end":{"line":180,"column":84}},"loc":{"start":{"line":180,"column":95},"end":{"line":193,"column":5}},"line":180},"33":{"name":"(anonymous_33)","decl":{"start":{"line":182,"column":33},"end":{"line":182,"column":34}},"loc":{"start":{"line":182,"column":47},"end":{"line":192,"column":9}},"line":182},"34":{"name":"(anonymous_34)","decl":{"start":{"line":194,"column":36},"end":{"line":194,"column":37}},"loc":{"start":{"line":194,"column":48},"end":{"line":216,"column":9}},"line":194},"35":{"name":"(anonymous_35)","decl":{"start":{"line":194,"column":91},"end":{"line":194,"column":92}},"loc":{"start":{"line":194,"column":103},"end":{"line":216,"column":5}},"line":194},"36":{"name":"(anonymous_36)","decl":{"start":{"line":196,"column":33},"end":{"line":196,"column":34}},"loc":{"start":{"line":196,"column":47},"end":{"line":215,"column":9}},"line":196},"37":{"name":"(anonymous_37)","decl":{"start":{"line":217,"column":31},"end":{"line":217,"column":32}},"loc":{"start":{"line":217,"column":43},"end":{"line":240,"column":9}},"line":217},"38":{"name":"(anonymous_38)","decl":{"start":{"line":217,"column":86},"end":{"line":217,"column":87}},"loc":{"start":{"line":217,"column":98},"end":{"line":240,"column":5}},"line":217},"39":{"name":"(anonymous_39)","decl":{"start":{"line":219,"column":33},"end":{"line":219,"column":34}},"loc":{"start":{"line":219,"column":47},"end":{"line":239,"column":9}},"line":219},"40":{"name":"(anonymous_40)","decl":{"start":{"line":241,"column":27},"end":{"line":241,"column":28}},"loc":{"start":{"line":241,"column":39},"end":{"line":265,"column":9}},"line":241},"41":{"name":"(anonymous_41)","decl":{"start":{"line":241,"column":82},"end":{"line":241,"column":83}},"loc":{"start":{"line":241,"column":94},"end":{"line":265,"column":5}},"line":241},"42":{"name":"(anonymous_42)","decl":{"start":{"line":243,"column":33},"end":{"line":243,"column":34}},"loc":{"start":{"line":243,"column":47},"end":{"line":264,"column":9}},"line":243},"43":{"name":"(anonymous_43)","decl":{"start":{"line":266,"column":33},"end":{"line":266,"column":34}},"loc":{"start":{"line":266,"column":45},"end":{"line":290,"column":9}},"line":266},"44":{"name":"(anonymous_44)","decl":{"start":{"line":266,"column":88},"end":{"line":266,"column":89}},"loc":{"start":{"line":266,"column":100},"end":{"line":290,"column":5}},"line":266},"45":{"name":"(anonymous_45)","decl":{"start":{"line":268,"column":33},"end":{"line":268,"column":34}},"loc":{"start":{"line":268,"column":47},"end":{"line":289,"column":9}},"line":268},"46":{"name":"(anonymous_46)","decl":{"start":{"line":291,"column":29},"end":{"line":291,"column":30}},"loc":{"start":{"line":291,"column":41},"end":{"line":315,"column":9}},"line":291},"47":{"name":"(anonymous_47)","decl":{"start":{"line":291,"column":84},"end":{"line":291,"column":85}},"loc":{"start":{"line":291,"column":96},"end":{"line":315,"column":5}},"line":291},"48":{"name":"(anonymous_48)","decl":{"start":{"line":293,"column":33},"end":{"line":293,"column":34}},"loc":{"start":{"line":293,"column":47},"end":{"line":314,"column":9}},"line":293}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":16},"end":{"line":10,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":17},"end":{"line":2,"column":21}},{"start":{"line":2,"column":25},"end":{"line":2,"column":39}},{"start":{"line":2,"column":44},"end":{"line":10,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":109}},"type":"cond-expr","locations":[{"start":{"line":3,"column":56},"end":{"line":3,"column":61}},{"start":{"line":3,"column":64},"end":{"line":3,"column":109}}],"line":3},"2":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"type":"binary-expr","locations":[{"start":{"line":4,"column":16},"end":{"line":4,"column":17}},{"start":{"line":4,"column":22},"end":{"line":4,"column":33}}],"line":4},"3":{"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":115}},"type":"cond-expr","locations":[{"start":{"line":7,"column":46},"end":{"line":7,"column":67}},{"start":{"line":7,"column":70},"end":{"line":7,"column":115}}],"line":7},"4":{"loc":{"start":{"line":8,"column":51},"end":{"line":8,"column":67}},"type":"binary-expr","locations":[{"start":{"line":8,"column":51},"end":{"line":8,"column":61}},{"start":{"line":8,"column":65},"end":{"line":8,"column":67}}],"line":8},"5":{"loc":{"start":{"line":11,"column":18},"end":{"line":37,"column":1}},"type":"binary-expr","locations":[{"start":{"line":11,"column":19},"end":{"line":11,"column":23}},{"start":{"line":11,"column":27},"end":{"line":11,"column":43}},{"start":{"line":11,"column":48},"end":{"line":37,"column":1}}],"line":11},"6":{"loc":{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},"type":"if","locations":[{"start":{"line":12,"column":43},"end":{"line":12,"column":68}},{"start":{"line":12,"column":43},"end":{"line":12,"column":68}}],"line":12},"7":{"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":153}},"type":"binary-expr","locations":[{"start":{"line":13,"column":71},"end":{"line":13,"column":99}},{"start":{"line":13,"column":104},"end":{"line":13,"column":152}}],"line":13},"8":{"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},"type":"if","locations":[{"start":{"line":16,"column":8},"end":{"line":16,"column":70}},{"start":{"line":16,"column":8},"end":{"line":16,"column":70}}],"line":16},"9":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":169}},{"start":{"line":18,"column":12},"end":{"line":18,"column":169}}],"line":18},"10":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":158}},"type":"binary-expr","locations":[{"start":{"line":18,"column":23},"end":{"line":18,"column":24}},{"start":{"line":18,"column":29},"end":{"line":18,"column":125}},{"start":{"line":18,"column":130},"end":{"line":18,"column":158}}],"line":18},"11":{"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":45},"end":{"line":18,"column":56}},{"start":{"line":18,"column":59},"end":{"line":18,"column":125}}],"line":18},"12":{"loc":{"start":{"line":18,"column":59},"end":{"line":18,"column":125}},"type":"cond-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},{"start":{"line":18,"column":119},"end":{"line":18,"column":125}}],"line":18},"13":{"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":116}},"type":"binary-expr","locations":[{"start":{"line":18,"column":67},"end":{"line":18,"column":77}},{"start":{"line":18,"column":82},"end":{"line":18,"column":115}}],"line":18},"14":{"loc":{"start":{"line":18,"column":82},"end":{"line":18,"column":112}},"type":"binary-expr","locations":[{"start":{"line":18,"column":83},"end":{"line":18,"column":98}},{"start":{"line":18,"column":103},"end":{"line":18,"column":112}}],"line":18},"15":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":52}},{"start":{"line":19,"column":12},"end":{"line":19,"column":52}}],"line":19},"16":{"loc":{"start":{"line":20,"column":12},"end":{"line":32,"column":13}},"type":"switch","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":24},"end":{"line":21,"column":46}},{"start":{"line":22,"column":16},"end":{"line":22,"column":72}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":24,"column":65}},{"start":{"line":25,"column":16},"end":{"line":31,"column":43}}],"line":20},"17":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":128}},{"start":{"line":26,"column":20},"end":{"line":26,"column":128}}],"line":26},"18":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":106}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":74}},{"start":{"line":26,"column":79},"end":{"line":26,"column":90}},{"start":{"line":26,"column":94},"end":{"line":26,"column":105}}],"line":26},"19":{"loc":{"start":{"line":26,"column":42},"end":{"line":26,"column":73}},"type":"binary-expr","locations":[{"start":{"line":26,"column":42},"end":{"line":26,"column":54}},{"start":{"line":26,"column":58},"end":{"line":26,"column":73}}],"line":26},"20":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":106}},{"start":{"line":27,"column":20},"end":{"line":27,"column":106}}],"line":27},"21":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":77}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":40},"end":{"line":27,"column":42}},{"start":{"line":27,"column":47},"end":{"line":27,"column":59}},{"start":{"line":27,"column":63},"end":{"line":27,"column":75}}],"line":27},"22":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":89}},{"start":{"line":28,"column":20},"end":{"line":28,"column":89}}],"line":28},"23":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":53}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":35}},{"start":{"line":28,"column":39},"end":{"line":28,"column":53}}],"line":28},"24":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":87}},{"start":{"line":29,"column":20},"end":{"line":29,"column":87}}],"line":29},"25":{"loc":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"type":"binary-expr","locations":[{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":43}}],"line":29},"26":{"loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},"type":"if","locations":[{"start":{"line":30,"column":20},"end":{"line":30,"column":42}},{"start":{"line":30,"column":20},"end":{"line":30,"column":42}}],"line":30},"27":{"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":35,"column":35}},{"start":{"line":35,"column":8},"end":{"line":35,"column":35}}],"line":35},"28":{"loc":{"start":{"line":35,"column":52},"end":{"line":35,"column":74}},"type":"cond-expr","locations":[{"start":{"line":35,"column":60},"end":{"line":35,"column":65}},{"start":{"line":35,"column":68},"end":{"line":35,"column":74}}],"line":35},"29":{"loc":{"start":{"line":53,"column":12},"end":{"line":67,"column":13}},"type":"switch","locations":[{"start":{"line":54,"column":16},"end":{"line":65,"column":24}},{"start":{"line":66,"column":16},"end":{"line":66,"column":57}}],"line":53},"30":{"loc":{"start":{"line":90,"column":12},"end":{"line":106,"column":13}},"type":"switch","locations":[{"start":{"line":91,"column":16},"end":{"line":101,"column":24}},{"start":{"line":102,"column":16},"end":{"line":105,"column":42}}],"line":90},"31":{"loc":{"start":{"line":112,"column":12},"end":{"line":154,"column":13}},"type":"switch","locations":[{"start":{"line":113,"column":16},"end":{"line":120,"column":59}},{"start":{"line":121,"column":16},"end":{"line":126,"column":70}},{"start":{"line":127,"column":16},"end":{"line":133,"column":69}},{"start":{"line":134,"column":16},"end":{"line":149,"column":28}},{"start":{"line":150,"column":16},"end":{"line":153,"column":42}}],"line":112},"32":{"loc":{"start":{"line":160,"column":12},"end":{"line":177,"column":13}},"type":"switch","locations":[{"start":{"line":161,"column":16},"end":{"line":161,"column":73}},{"start":{"line":162,"column":16},"end":{"line":164,"column":66}},{"start":{"line":165,"column":16},"end":{"line":167,"column":74}},{"start":{"line":168,"column":16},"end":{"line":172,"column":45}},{"start":{"line":173,"column":16},"end":{"line":176,"column":42}}],"line":160},"33":{"loc":{"start":{"line":183,"column":12},"end":{"line":191,"column":13}},"type":"switch","locations":[{"start":{"line":184,"column":16},"end":{"line":186,"column":66}},{"start":{"line":187,"column":16},"end":{"line":190,"column":42}}],"line":183},"34":{"loc":{"start":{"line":197,"column":12},"end":{"line":214,"column":13}},"type":"switch","locations":[{"start":{"line":198,"column":16},"end":{"line":198,"column":73}},{"start":{"line":199,"column":16},"end":{"line":201,"column":66}},{"start":{"line":202,"column":16},"end":{"line":204,"column":74}},{"start":{"line":205,"column":16},"end":{"line":209,"column":50}},{"start":{"line":210,"column":16},"end":{"line":213,"column":42}}],"line":197},"35":{"loc":{"start":{"line":220,"column":12},"end":{"line":238,"column":13}},"type":"switch","locations":[{"start":{"line":221,"column":16},"end":{"line":221,"column":73}},{"start":{"line":222,"column":16},"end":{"line":224,"column":66}},{"start":{"line":225,"column":16},"end":{"line":227,"column":74}},{"start":{"line":228,"column":16},"end":{"line":233,"column":72}},{"start":{"line":234,"column":16},"end":{"line":237,"column":42}}],"line":220},"36":{"loc":{"start":{"line":244,"column":12},"end":{"line":263,"column":13}},"type":"switch","locations":[{"start":{"line":245,"column":16},"end":{"line":245,"column":73}},{"start":{"line":246,"column":16},"end":{"line":248,"column":66}},{"start":{"line":249,"column":16},"end":{"line":251,"column":74}},{"start":{"line":252,"column":16},"end":{"line":258,"column":67}},{"start":{"line":259,"column":16},"end":{"line":262,"column":42}}],"line":244},"37":{"loc":{"start":{"line":269,"column":12},"end":{"line":288,"column":13}},"type":"switch","locations":[{"start":{"line":270,"column":16},"end":{"line":270,"column":73}},{"start":{"line":271,"column":16},"end":{"line":273,"column":66}},{"start":{"line":274,"column":16},"end":{"line":276,"column":74}},{"start":{"line":277,"column":16},"end":{"line":283,"column":50}},{"start":{"line":284,"column":16},"end":{"line":287,"column":42}}],"line":269},"38":{"loc":{"start":{"line":294,"column":12},"end":{"line":313,"column":13}},"type":"switch","locations":[{"start":{"line":295,"column":16},"end":{"line":295,"column":73}},{"start":{"line":296,"column":16},"end":{"line":298,"column":66}},{"start":{"line":299,"column":16},"end":{"line":301,"column":74}},{"start":{"line":302,"column":16},"end":{"line":308,"column":76}},{"start":{"line":309,"column":16},"end":{"line":312,"column":42}}],"line":294}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":0,"79":0,"80":0,"81":0,"82":0,"83":1,"84":1,"85":1,"86":0,"87":0,"88":0,"89":1,"90":0,"91":0,"92":1,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":1,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":1,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":1,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":1,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":1,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":1,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},"b":{"0":[1,1,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[1,1,1],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0,0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0,0,0,0],"32":[0,0,0,0,0],"33":[0,0],"34":[0,0,0,0,0],"35":[0,0,0,0,0],"36":[0,0,0,0,0],"37":[0,0,0,0,0],"38":[0,0,0,0,0]},"inputSourceMap":{"version":3,"file":"/app/app/test/integrations/games.spec.ts","sources":["/app/app/test/integrations/games.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import {encrypt} from '../../services/crypto'\n\nconst assert = require('assert')\nimport knex from '../../libs/knex'\nimport app from '../../../'\nimport {MockedUser, MockedUserCredetials} from './mock.user'\nimport * as auth from '../../services/auth'\n\nconst chai = require('chai')\nconst chaiHttp = require('chai-http')\nchai.use(chaiHttp)\nconst sinon = require('sinon')\nimport {filterRefreshToken, filterAuthToken, registerUser, testLogin} from './auth.spec';\n\nexport async function createGame(token, refreshToken) {\n    return await chai\n        .request(app)\n        .post('/game')\n        .set('Cookie', token + ';' + refreshToken)\n        .send({\n            additional: '',\n            address: 'dummy address',\n            city: 'Kiev',\n            city_id: 1,\n            date: '2029-02-09T22:22',\n            players: 5,\n        })\n}\n\ndescribe('routes : games', () => {\n    beforeEach(() => {\n        return knex.migrate\n            .rollback()\n            .then(() => {\n                return knex.migrate.latest();\n            })\n            .then(() => {\n                return knex.seed.run();\n            })\n    })\n\n    afterEach(() => {\n        sinon.restore()\n        return knex.migrate.rollback();\n    })\n\n    it('should not add game if not logged', async () => {\n        const res = await chai\n            .request(app)\n            .post('/game')\n            .send({\n                additional: '',\n                address: 'dummy address',\n                city: 'Kiev',\n                city_id: 1,\n                date: '2019-02-09T22:22',\n                players: 5,\n            })\n        assert.strictEqual(res.status, 401)\n    })\n    it('should add game if logged', async () => {\n\n        sinon.stub(auth, 'sendConfirmationEmail').callsFake(function fakeFn() {\n            return true\n        })\n\n        await chai\n            .request(app)\n            .post('/auth/registration')\n            .send(MockedUser)\n\n        await chai\n            .request(app)\n            .get(`/auth/confirm-email/${encrypt(MockedUser.email)}`)\n            .set('content-type', 'application/json')\n\n        const res = await chai\n            .request(app)\n            .post(`/auth/login`)\n            .set('content-type', 'application/json')\n            .send(MockedUserCredetials)\n\n        const token = filterAuthToken(res.headers['set-cookie'])\n        const refreshToken = filterRefreshToken(res.headers['set-cookie'])\n\n        const addGameRes = await chai\n            .request(app)\n            .post('/game')\n            .set('Cookie', token + ';' + refreshToken)\n            .send({\n                additional: '',\n                address: 'dummy address',\n                city: 'Kiev',\n                city_id: 1,\n                date: '2019-02-09T22:22',\n                players: 5,\n            })\n        assert.strictEqual(addGameRes.status, 201)\n    })\n\n    it('should load game', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n\n        const resGet = await chai\n            .request(app)\n            .get('/game/1')\n\n        assert.strictEqual(resGet.body.status, 'forming');\n    });\n\n    it('should list games', async () => {\n        const response = await chai.request(app)\n            .get('/cities/getByName/kie')\n            .set('content-type', 'application/json')\n        assert.strictEqual(response.status, 200);\n    });\n\n    it('should list created games', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n        const {body} = await chai\n            .request(app)\n            .get(`/game/city/1`)\n        assert.strictEqual(body.length, 1);\n    })\n    it('should not join game', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n        const res = await chai\n            .request(app)\n            .post(`/game/join`)\n            .set('Cookie', token + ';' + refreshToken)\n        assert.strictEqual(res.statusCode, 400);\n    })\n    it('should join game', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n        const res = await chai\n            .request(app)\n            .post(`/game/join`)\n            .set('Cookie', token + ';' + refreshToken)\n            .send({gameId: 1, playerNumber: 2})\n        assert.strictEqual(res.ok, true);\n    })\n    it('should not add message', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n        const res = await chai\n            .request(app)\n            .post(`/game/chat`)\n            .set('Cookie', token + ';' + refreshToken)\n            .send({gameId: 1})\n        assert.strictEqual(res.statusCode, 422);\n    })\n    it('should add message', async () => {\n        await registerUser()\n        const {token, refreshToken} = await testLogin();\n        await createGame(token, refreshToken)\n        const res = await chai\n            .request(app)\n            .post(`/game/chat`)\n            .set('Cookie', token + ';' + refreshToken)\n            .send({gameId: 1, message: 'dummy message'})\n        assert.strictEqual(res.statusCode, 201);\n    })\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d54fc5e4d978b39f4c24a98515aaf3a8c21e0188","contentHash":"96f695a088b008ec82976f3cbaabfb9d2d16d41781cb93d870901c3a04b737df"},"/app/app/test/unit/crypto.spec.ts":{"path":"/app/app/test/unit/crypto.spec.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":13},"end":{"line":3,"column":35}},"2":{"start":{"line":4,"column":15},"end":{"line":4,"column":47}},"3":{"start":{"line":5,"column":0},"end":{"line":10,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":9,"column":7}},"5":{"start":{"line":7,"column":20},"end":{"line":7,"column":34}},"6":{"start":{"line":8,"column":8},"end":{"line":8,"column":74}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":27},"end":{"line":5,"column":28}},"loc":{"start":{"line":5,"column":39},"end":{"line":10,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":30},"end":{"line":6,"column":31}},"loc":{"start":{"line":6,"column":42},"end":{"line":9,"column":5}},"line":6}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0},"f":{"0":1,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/test/unit/crypto.spec.ts","sources":["/app/app/test/unit/crypto.spec.ts"],"names":[],"mappings":";;AAAA,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;AACtC,gDAAuD;AAEvD,QAAQ,CAAC,gBAAgB,EAAE;IACzB,EAAE,CAAC,qBAAqB,EAAE;QACxB,IAAM,KAAK,GAAG,cAAc,CAAC;QAC7B,MAAM,CAAC,gBAAO,CAAC,gBAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAClD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["const expect = require('chai').expect;\nimport {encrypt, decrypt} from '../../services/crypto';\n\ndescribe('routes : games', () => {\n  it('crypto successfully', () => {\n    const email = 'test@test.ua';\n    expect(decrypt(encrypt(email))).to.equal(email);\n  });\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9f94f04a88dceb7eb3dbf04200458832db9febbe","contentHash":"f1e6d169b50aae2113a5654abea4e4bbcb2e0954a6f45a2397bb89697316eee9"},"/app/app/test/unit/footbal-field.spec.ts":{"path":"/app/app/test/unit/footbal-field.spec.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":59}},"2":{"start":{"line":4,"column":13},"end":{"line":4,"column":35}},"3":{"start":{"line":5,"column":0},"end":{"line":14,"column":3}},"4":{"start":{"line":6,"column":4},"end":{"line":13,"column":7}},"5":{"start":{"line":7,"column":27},"end":{"line":7,"column":57}},"6":{"start":{"line":8,"column":8},"end":{"line":8,"column":59}},"7":{"start":{"line":9,"column":8},"end":{"line":9,"column":54}},"8":{"start":{"line":10,"column":8},"end":{"line":10,"column":59}},"9":{"start":{"line":11,"column":8},"end":{"line":11,"column":54}},"10":{"start":{"line":12,"column":8},"end":{"line":12,"column":61}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":27},"end":{"line":5,"column":28}},"loc":{"start":{"line":5,"column":39},"end":{"line":14,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":37},"end":{"line":6,"column":38}},"loc":{"start":{"line":6,"column":49},"end":{"line":13,"column":5}},"line":6}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"f":{"0":1,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/test/unit/footbal-field.spec.ts","sources":["/app/app/test/unit/footbal-field.spec.ts"],"names":[],"mappings":";;AAAA,4DAAsD;AACtD,IAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;AACtC,QAAQ,CAAC,gBAAgB,EAAE;IACzB,EAAE,CAAC,4BAA4B,EAAE;QAC/B,IAAI,YAAY,GAAG,IAAI,sBAAY,CAAC,EAAE,CAAC,CAAC;QACxC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC,CAAC;QACnD,YAAY,GAAG,IAAI,sBAAY,CAAC,EAAE,CAAC,CAAC;QACpC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC,CAAC;QACnD,YAAY,GAAG,IAAI,sBAAY,CAAC,EAAE,CAAC,CAAC;QACpC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC,CAAC;IACvD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import FootballTeem from '../../services/footbal-teem'\nconst expect = require('chai').expect;\ndescribe('routes : games', () => {\n  it('split players on two teems', () => {\n    let footballTeem = new FootballTeem(11);\n    expect([6, 5]).to.eql(footballTeem.splitOnTeems());\n    footballTeem = new FootballTeem(10);\n    expect([5, 5]).to.eql(footballTeem.splitOnTeems());\n    footballTeem = new FootballTeem(21);\n    expect([11, 10]).to.eql(footballTeem.splitOnTeems());\n  });\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5c158f831bfd5623646aae7258f1b4abfe170146","contentHash":"6f601ed692ad8236aa7615eb36822c097e7dd535383438b1b819540d6ad89a9a"},"/app/app/services/footbal-teem.ts":{"path":"/app/app/services/footbal-teem.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":34},"end":{"line":24,"column":3}},"2":{"start":{"line":5,"column":8},"end":{"line":7,"column":9}},"3":{"start":{"line":6,"column":12},"end":{"line":6,"column":71}},"4":{"start":{"line":8,"column":8},"end":{"line":8,"column":31}},"5":{"start":{"line":13,"column":4},"end":{"line":22,"column":6}},"6":{"start":{"line":14,"column":8},"end":{"line":21,"column":9}},"7":{"start":{"line":15,"column":29},"end":{"line":15,"column":51}},"8":{"start":{"line":16,"column":12},"end":{"line":16,"column":48}},"9":{"start":{"line":19,"column":30},"end":{"line":19,"column":46}},"10":{"start":{"line":20,"column":12},"end":{"line":20,"column":46}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":24}},"12":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":34},"end":{"line":3,"column":35}},"loc":{"start":{"line":3,"column":46},"end":{"line":24,"column":1}},"line":3},"1":{"name":"FootballTeem","decl":{"start":{"line":4,"column":13},"end":{"line":4,"column":25}},"loc":{"start":{"line":4,"column":35},"end":{"line":9,"column":5}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":42},"end":{"line":13,"column":43}},"loc":{"start":{"line":13,"column":54},"end":{"line":22,"column":5}},"line":13}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":8},"end":{"line":7,"column":9}},"type":"if","locations":[{"start":{"line":5,"column":8},"end":{"line":7,"column":9}},{"start":{"line":5,"column":8},"end":{"line":7,"column":9}}],"line":5},"1":{"loc":{"start":{"line":5,"column":12},"end":{"line":5,"column":41}},"type":"binary-expr","locations":[{"start":{"line":5,"column":12},"end":{"line":5,"column":26}},{"start":{"line":5,"column":30},"end":{"line":5,"column":41}}],"line":5},"2":{"loc":{"start":{"line":14,"column":8},"end":{"line":21,"column":9}},"type":"if","locations":[{"start":{"line":14,"column":8},"end":{"line":21,"column":9}},{"start":{"line":14,"column":8},"end":{"line":21,"column":9}}],"line":14}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":1},"f":{"0":1,"1":0,"2":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"file":"/app/app/services/footbal-teem.ts","sources":["/app/app/services/footbal-teem.ts"],"names":[],"mappings":";;AAAA;IAIE,sBAAY,OAAe;QACzB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,OAAO,GAAG,CAAC,EAAE;YACjC,MAAM,KAAK,CAAC,6CAA6C,CAAC,CAAC;SAC5D;QACD,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACzB,CAAC;IAED;;OAEG;IACH,mCAAY,GAAZ;QACE,IAAI,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE;YACpB,IAAM,UAAU,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;YAC1C,OAAO,CAAC,UAAU,GAAG,CAAC,EAAE,UAAU,CAAC,CAAC;SACrC;aAAM;YACL,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,GAAC,CAAC,CAAC;YACnC,OAAO,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;SACnC;IACH,CAAC;IACH,mBAAC;AAAD,CAAC,AAvBD,IAuBC;AACD,kBAAe,YAAY,CAAA","sourcesContent":["class FootballTeem {\n  players: number;\n\n\n  constructor(players: number) {\n    if (isNaN(players) || players < 0) {\n      throw Error('Invalid parameter, should be number and > 0');\n    }\n    this.players = players;\n  }\n\n  /**\n   * Calculate number of player for each teem\n   */\n  splitOnTeems(): number[] {\n    if (this.players % 2) {\n      const oddPlayers = (this.players - 1) / 2;\n      return [oddPlayers + 1, oddPlayers];\n    } else {\n      const evenPlayers = this.players/2;\n      return [evenPlayers, evenPlayers];\n    }\n  }\n}\nexport default FootballTeem\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6cf67e79201f921309c15530532406c2a932bd9a","contentHash":"7824383adafae61cb1618eac2c0b6ba0239e4e3729d67588c4be0bcbec48be1e"},"/app/app/db/migrations/20180203133838_cities.ts":{"path":"/app/app/db/migrations/20180203133838_cities.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":3337}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":143}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20180203133838_cities.ts","sources":["/app/app/db/migrations/20180203133838_cities.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,mvGA2Gf,CAAC,CAAC;AACL,CAAC,CAAC;AACF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,yHAIf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["exports.up = function(knex, Promise) {\n  return knex.raw(`\n    CREATE TABLE IF NOT EXISTS _countries(\n    country_id integer NOT NULL,\n    title_ru character varying(60),\n    title_ua character varying(60),\n    title_be character varying(60),\n    title_en character varying(60),\n    title_es character varying(60),\n    title_pt character varying(60),\n    title_de character varying(60),\n    title_fr character varying(60),\n    title_it character varying(60),\n    title_pl character varying(60),\n    title_ja character varying(60),\n    title_lt character varying(60),\n    title_lv character varying(60),\n    title_cz character varying(60),\n    CONSTRAINT pk_country_cid PRIMARY KEY (country_id)\n  \n  );\n  \n  CREATE TABLE IF NOT EXISTS _regions(\n    region_id integer NOT NULL,\n    country_id integer NOT NULL,\n    title_ru character varying(150),\n    title_ua character varying(150),\n    title_be character varying(150),\n    title_en character varying(150),\n    title_es character varying(150),\n    title_pt character varying(150),\n    title_de character varying(150),\n    title_fr character varying(150),\n    title_it character varying(150),\n    title_pl character varying(150),\n    title_ja character varying(150),\n    title_lt character varying(150),\n    title_lv character varying(150),\n    title_cz character varying(150),\n    CONSTRAINT pk_region_rid PRIMARY KEY (region_id)\n  \n  );\n  \n  CREATE TABLE IF NOT EXISTS _cities\n  (\n    city_id    integer NOT NULL,\n    country_id integer NOT NULL,\n    important  boolean NOT NULL,\n    region_id  integer,\n\n    title_ru   character varying(150),\n    area_ru    character varying(150),\n    region_ru  character varying(150),\n\n    title_ua   character varying(150),\n    area_ua    character varying(150),\n    region_ua  character varying(150),\n\n    title_be   character varying(150),\n    area_be    character varying(150),\n    region_be  character varying(150),\n\n    title_en   character varying(150),\n    area_en    character varying(150),\n    region_en  character varying(150),\n\n    title_es   character varying(150),\n    area_es    character varying(150),\n    region_es  character varying(150),\n\n    title_pt   character varying(150),\n    area_pt    character varying(150),\n    region_pt  character varying(150),\n\n    title_de   character varying(150),\n    area_de    character varying(150),\n    region_de  character varying(150),\n\n    title_fr   character varying(150),\n    area_fr    character varying(150),\n    region_fr  character varying(150),\n\n    title_it   character varying(150),\n    area_it    character varying(150),\n    region_it  character varying(150),\n\n    title_pl   character varying(150),\n    area_pl    character varying(150),\n    region_pl  character varying(150),\n\n    title_ja   character varying(150),\n    area_ja    character varying(150),\n    region_ja  character varying(150),\n\n    title_lt   character varying(150),\n    area_lt    character varying(150),\n    region_lt  character varying(150),\n\n    title_lv   character varying(150),\n    area_lv    character varying(150),\n    region_lv  character varying(150),\n\n    title_cz   character varying(150),\n    area_cz    character varying(150),\n    region_cz  character varying(150),\n\n    CONSTRAINT pk_city_cid PRIMARY KEY (city_id)\n  );\n  `);\n};\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n      drop table if exists _countries;\n      drop table if exists _regions;\n      drop table if exists _cities;\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b3e49d9d7164639516bba1d2c1b9f93815952734","contentHash":"3f7870973f9fa891a3604afa73e8d6192df4c139275938835e815a06d190659f"},"/app/app/db/migrations/20190201203611_user.ts":{"path":"/app/app/db/migrations/20190201203611_user.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":231}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":61}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190201203611_user.ts","sources":["/app/app/db/migrations/20190201203611_user.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,iNASf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,uCAEf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["exports.up = function(knex, Promise) {\n  return knex.raw(`\n    create table users\n    (\n      id serial primary key,\n      name     varchar(40),\n      email    varchar(40) unique,\n      verified boolean not null default false,\n      password text\n    );\n  `);\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n    drop table if exists users;\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"563dd7603369b2de09c71b8ab419bf21bd208b9e","contentHash":"b17a12668202e7923985b0c99048cf7bb6beaddfbd6044aa7b8887a6eea067a5"},"/app/app/db/migrations/20190203093416_game.ts":{"path":"/app/app/db/migrations/20190203093416_game.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":516}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":100}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190203093416_game.ts","sources":["/app/app/db/migrations/20190203093416_game.ts"],"names":[],"mappings":"AACA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,8eAkBf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,8EAGf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["\nexports.up = function(knex, Promise) {\n  return knex.raw(`\n    create type games_status as \n    enum('forming', 'active', 'finished', 'cancelled');\n    \n    create table games\n    (\n      id serial primary key,\n      city_id     integer references _cities(city_id),\n      author_id integer references users(id),\n      additional text,\n      address text,\n      lat float,\n      long float,\n      players integer,\n      date timestamp,\n      date_created timestamp default now(),\n      status games_status default 'forming'\n    );\n  `);\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n    drop table if exists games;\n    drop type if exists games_status;\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2ae733301bfe568c0938add7c6abf643d99cfe38","contentHash":"fe65accf500d82fb1f232918639518750317c99b2d6e8f644ad58644c8b208e9"},"/app/app/db/migrations/20190216132153_game_players.ts":{"path":"/app/app/db/migrations/20190216132153_game_players.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":208}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":70}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190216132153_game_players.ts","sources":["/app/app/db/migrations/20190216132153_game_players.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,0LAOf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,gDAEf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["exports.up = function(knex, Promise) {\n  return knex.raw(`\n    create table games_players\n    (\n      game_id  integer references games(id),\n      player_id integer references users(id),\n      primary key (game_id, player_id)\n    );\n  `);\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n     drop table if exists games_players;\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"826194449e63b4b2f932f754f9dfb28368357982","contentHash":"320025730031110daf452739e94aed58d932e9a9b46ac53a443272b060e05937"},"/app/app/db/migrations/20190319181145_add.ts":{"path":"/app/app/db/migrations/20190319181145_add.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":66}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":72}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190319181145_add.ts","sources":["/app/app/db/migrations/20190319181145_add.ts"],"names":[],"mappings":"AACA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,4CAA4C,CAAC,CAAC;AAChE,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,kDAAkD,CAAC,CAAC;AACtE,CAAC,CAAC","sourcesContent":["\nexports.up = function(knex, Promise) {\n  return knex.raw('alter table games add column district text');\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw('alter table games drop column if exists district');\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"07f58c53590f889a7951677e6597a68fe0508457","contentHash":"66e32113172c4efeaefbf6d640994a97a14be907548be3bb06f94884b90fb215"},"/app/app/db/migrations/20190329201031_gameComposition.ts":{"path":"/app/app/db/migrations/20190329201031_gameComposition.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":269}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":62}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190329201031_gameComposition.ts","sources":["/app/app/db/migrations/20190329201031_gameComposition.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,uPAQf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,wCAEf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["exports.up = function(knex, Promise) {\n  return knex.raw(`\n    create table games_composition\n    (\n      game_id  integer references games(id),\n      player_id integer references users(id),\n      player_field_number integer,\n      primary key (game_id, player_id, player_field_number)\n    );\n  `);\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n    drop table games_composition\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"63a47fe41d80a2749f8510899c3aa6222916d36e","contentHash":"ccd452df72e2cdcdfefe03faaab9820c50871d0b3e13b7189a985bfa1777943d"},"/app/app/db/migrations/20190329201031_messages.ts":{"path":"/app/app/db/migrations/20190329201031_messages.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":256}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":53}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":38},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20190329201031_messages.ts","sources":["/app/app/db/migrations/20190329201031_messages.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI,EAAE,OAAO;IACjC,OAAO,IAAI,CAAC,GAAG,CAAC,0OASf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,GAAG,CAAC,+BAEf,CAAC,CAAC;AACL,CAAC,CAAC","sourcesContent":["exports.up = function(knex, Promise) {\n  return knex.raw(`\n    create table messages\n    ( \n      id serial primary key,\n      game_id  integer references games(id),\n      user_id integer references users(id),\n      date timestamp  not null default now(),\n      text text\n    );\n  `);\n};\n\nexports.down = function(knex, Promise) {\n  return knex.raw(`\n    drop table messages\n  `);\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1fcd95cd06ee58af9da3b619a2aa8344557fb0b7","contentHash":"d5501e9c6d0a095e133e53b2e9c4bf5931c0b7ec73e69f78365ddf98b06dcebf"},"/app/app/db/migrations/20200226070522_refreshTockens.ts":{"path":"/app/app/db/migrations/20200226070522_refreshTockens.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":531}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":157}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":29},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":31},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20200226070522_refreshTockens.ts","sources":["/app/app/db/migrations/20200226070522_refreshTockens.ts"],"names":[],"mappings":"AACA,OAAO,CAAC,EAAE,GAAG,UAAS,IAAI;IACxB,OAAO,IAAI,CAAC,GAAG,CAAC,6fAoBf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI;IAC1B,OAAO,IAAI,CAAC,GAAG,CAAC,uIAIf,CAAC,CAAA;AACJ,CAAC,CAAC","sourcesContent":["\nexports.up = function(knex) {\n  return knex.raw(`\n    create table refresh_tokens\n    ( \n      id text,\n      user_id text,\n      timestamp timestamp NOT NULL DEFAULT NOW()\n    );\n    \n    CREATE FUNCTION ttl_refresh_tokens() RETURNS trigger\n    LANGUAGE plpgsql\n    AS $$\n      BEGIN\n        DELETE FROM refresh_tokens WHERE timestamp < NOW() - INTERVAL '7 days';\n        RETURN NEW;\n      END;\n    $$;\n    \n    CREATE TRIGGER ttl_refresh_tokens_trigger\n    AFTER INSERT ON refresh_tokens\n    EXECUTE PROCEDURE ttl_refresh_tokens();\n  `);\n};\n\nexports.down = function(knex) {\n  return knex.raw(`\n  DROP TRIGGER ttl_refresh_tokens_trigger on refresh_tokens;\n  DROP FUNCTION ttl_refresh_tokens;\n  DROP TABLE refresh_tokens;\n  `)\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"58651f5903fbd155ed05b4e0109fecbfa3d98f4f","contentHash":"c647c57dc107b86ffe98bbee2924379da95b06e0b2ca8f47f7994fe218821796"},"/app/app/db/migrations/20200226070523_usersGoogle.ts":{"path":"/app/app/db/migrations/20200226070523_usersGoogle.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":532}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":29},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":31},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20200226070523_usersGoogle.ts","sources":["/app/app/db/migrations/20200226070523_usersGoogle.ts"],"names":[],"mappings":"AACA,OAAO,CAAC,EAAE,GAAG,UAAC,IAAI;IAChB,OAAO,IAAI,CAAC,GAAG,CAAC,8fAcf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAC,IAAI;IAClB,OAAO,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAA;AACrB,CAAC,CAAC","sourcesContent":["\nexports.up = (knex) => {\n  return knex.raw(`\n  alter table users drop column email;\n  alter table users drop column password;\n  alter table users drop column verified;\n  DO $$\n    BEGIN\n        IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'registration_strategies') THEN\n            CREATE TYPE registration_strategies AS ENUM ('local', 'google');\n        END IF;\n    END\n  $$;\n  alter table users add column type registration_strategies;\n  alter table users add column local jsonb;\n  alter table users add column google jsonb;\n  `);\n};\n\nexports.down = (knex) => {\n  return knex.raw(``)\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3236c51b88c3b3f3d242a35f079893d67101e72b","contentHash":"15b9fed7cd47876edf584b4c0ec7b4ea21af7d4f3b5078ea5098f0b77c84220a"},"/app/app/db/migrations/20200226080523_rename_cities.ts":{"path":"/app/app/db/migrations/20200226080523_rename_cities.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":2,"column":3932}},"2":{"start":{"line":4,"column":0},"end":{"line":6,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":13},"end":{"line":1,"column":14}},"loc":{"start":{"line":1,"column":29},"end":{"line":3,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":31},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/migrations/20200226080523_rename_cities.ts","sources":["/app/app/db/migrations/20200226080523_rename_cities.ts"],"names":[],"mappings":"AACA,OAAO,CAAC,EAAE,GAAG,UAAC,IAAI;IAChB,OAAO,IAAI,CAAC,GAAG,CAAC,s0HAwBf,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,OAAO,CAAC,IAAI,GAAG,UAAC,IAAI;IAClB,OAAO,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,CAAA;AACrB,CAAC,CAAC","sourcesContent":["\nexports.up = (knex) => {\n  return knex.raw(`\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = ''  and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = ' ' WHERE title_ru = ' ' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '', title_ru= ''  WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  UPDATE _cities SET title_ua = '-' WHERE title_ru = '-' and country_id = 2;\n  UPDATE _cities SET title_ua = '' WHERE title_ru = '' and country_id = 2;\n  `);\n};\n\nexports.down = (knex) => {\n  return knex.raw(``)\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"69f757c31d63aa938e99ecdcef0c9dd1a8eb6b61","contentHash":"5faa82b239b48742592e9e8d16f205b6853d9115d84378aec0596dfe645c1112"},"/app/app/db/seed/_cities.ts":{"path":"/app/app/db/seed/_cities.ts","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":9,"column":1}},"1":{"start":{"line":2,"column":28},"end":{"line":2,"column":110}},"2":{"start":{"line":2,"column":91},"end":{"line":2,"column":106}},"3":{"start":{"line":3,"column":4},"end":{"line":8,"column":7}},"4":{"start":{"line":4,"column":36},"end":{"line":4,"column":97}},"5":{"start":{"line":4,"column":42},"end":{"line":4,"column":70}},"6":{"start":{"line":4,"column":85},"end":{"line":4,"column":95}},"7":{"start":{"line":5,"column":35},"end":{"line":5,"column":100}},"8":{"start":{"line":5,"column":41},"end":{"line":5,"column":73}},"9":{"start":{"line":5,"column":88},"end":{"line":5,"column":98}},"10":{"start":{"line":6,"column":32},"end":{"line":6,"column":116}},"11":{"start":{"line":7,"column":8},"end":{"line":7,"column":78}},"12":{"start":{"line":10,"column":18},"end":{"line":36,"column":1}},"13":{"start":{"line":11,"column":12},"end":{"line":11,"column":104}},"14":{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},"15":{"start":{"line":11,"column":57},"end":{"line":11,"column":68}},"16":{"start":{"line":11,"column":69},"end":{"line":11,"column":81}},"17":{"start":{"line":12,"column":4},"end":{"line":12,"column":157}},"18":{"start":{"line":12,"column":138},"end":{"line":12,"column":150}},"19":{"start":{"line":13,"column":23},"end":{"line":13,"column":68}},"20":{"start":{"line":13,"column":45},"end":{"line":13,"column":65}},"21":{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},"22":{"start":{"line":15,"column":15},"end":{"line":15,"column":70}},"23":{"start":{"line":16,"column":8},"end":{"line":33,"column":66}},"24":{"start":{"line":16,"column":18},"end":{"line":33,"column":66}},"25":{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},"26":{"start":{"line":17,"column":160},"end":{"line":17,"column":169}},"27":{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},"28":{"start":{"line":18,"column":26},"end":{"line":18,"column":52}},"29":{"start":{"line":19,"column":12},"end":{"line":31,"column":13}},"30":{"start":{"line":20,"column":32},"end":{"line":20,"column":39}},"31":{"start":{"line":20,"column":40},"end":{"line":20,"column":46}},"32":{"start":{"line":21,"column":24},"end":{"line":21,"column":34}},"33":{"start":{"line":21,"column":35},"end":{"line":21,"column":72}},"34":{"start":{"line":22,"column":24},"end":{"line":22,"column":34}},"35":{"start":{"line":22,"column":35},"end":{"line":22,"column":45}},"36":{"start":{"line":22,"column":46},"end":{"line":22,"column":55}},"37":{"start":{"line":22,"column":56},"end":{"line":22,"column":65}},"38":{"start":{"line":23,"column":24},"end":{"line":23,"column":41}},"39":{"start":{"line":23,"column":42},"end":{"line":23,"column":55}},"40":{"start":{"line":23,"column":56},"end":{"line":23,"column":65}},"41":{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},"42":{"start":{"line":25,"column":110},"end":{"line":25,"column":116}},"43":{"start":{"line":25,"column":117},"end":{"line":25,"column":126}},"44":{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},"45":{"start":{"line":26,"column":81},"end":{"line":26,"column":97}},"46":{"start":{"line":26,"column":98},"end":{"line":26,"column":104}},"47":{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},"48":{"start":{"line":27,"column":57},"end":{"line":27,"column":72}},"49":{"start":{"line":27,"column":73},"end":{"line":27,"column":80}},"50":{"start":{"line":27,"column":81},"end":{"line":27,"column":87}},"51":{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},"52":{"start":{"line":28,"column":47},"end":{"line":28,"column":62}},"53":{"start":{"line":28,"column":63},"end":{"line":28,"column":78}},"54":{"start":{"line":28,"column":79},"end":{"line":28,"column":85}},"55":{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},"56":{"start":{"line":29,"column":30},"end":{"line":29,"column":42}},"57":{"start":{"line":30,"column":20},"end":{"line":30,"column":33}},"58":{"start":{"line":30,"column":34},"end":{"line":30,"column":43}},"59":{"start":{"line":32,"column":12},"end":{"line":32,"column":39}},"60":{"start":{"line":33,"column":22},"end":{"line":33,"column":34}},"61":{"start":{"line":33,"column":35},"end":{"line":33,"column":41}},"62":{"start":{"line":33,"column":54},"end":{"line":33,"column":64}},"63":{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},"64":{"start":{"line":34,"column":23},"end":{"line":34,"column":35}},"65":{"start":{"line":34,"column":36},"end":{"line":34,"column":89}},"66":{"start":{"line":37,"column":0},"end":{"line":49,"column":2}},"67":{"start":{"line":38,"column":4},"end":{"line":48,"column":7}},"68":{"start":{"line":39,"column":8},"end":{"line":47,"column":11}},"69":{"start":{"line":40,"column":12},"end":{"line":46,"column":20}},"70":{"start":{"line":43,"column":20},"end":{"line":45,"column":23}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":44},"end":{"line":1,"column":45}},"loc":{"start":{"line":1,"column":89},"end":{"line":9,"column":1}},"line":1},"1":{"name":"adopt","decl":{"start":{"line":2,"column":13},"end":{"line":2,"column":18}},"loc":{"start":{"line":2,"column":26},"end":{"line":2,"column":112}},"line":2},"2":{"name":"(anonymous_2)","decl":{"start":{"line":2,"column":70},"end":{"line":2,"column":71}},"loc":{"start":{"line":2,"column":89},"end":{"line":2,"column":108}},"line":2},"3":{"name":"(anonymous_3)","decl":{"start":{"line":3,"column":36},"end":{"line":3,"column":37}},"loc":{"start":{"line":3,"column":63},"end":{"line":8,"column":5}},"line":3},"4":{"name":"fulfilled","decl":{"start":{"line":4,"column":17},"end":{"line":4,"column":26}},"loc":{"start":{"line":4,"column":34},"end":{"line":4,"column":99}},"line":4},"5":{"name":"rejected","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":25}},"loc":{"start":{"line":5,"column":33},"end":{"line":5,"column":102}},"line":5},"6":{"name":"step","decl":{"start":{"line":6,"column":17},"end":{"line":6,"column":21}},"loc":{"start":{"line":6,"column":30},"end":{"line":6,"column":118}},"line":6},"7":{"name":"(anonymous_7)","decl":{"start":{"line":10,"column":48},"end":{"line":10,"column":49}},"loc":{"start":{"line":10,"column":73},"end":{"line":36,"column":1}},"line":10},"8":{"name":"(anonymous_8)","decl":{"start":{"line":11,"column":30},"end":{"line":11,"column":31}},"loc":{"start":{"line":11,"column":41},"end":{"line":11,"column":83}},"line":11},"9":{"name":"(anonymous_9)","decl":{"start":{"line":12,"column":125},"end":{"line":12,"column":126}},"loc":{"start":{"line":12,"column":136},"end":{"line":12,"column":152}},"line":12},"10":{"name":"verb","decl":{"start":{"line":13,"column":13},"end":{"line":13,"column":17}},"loc":{"start":{"line":13,"column":21},"end":{"line":13,"column":70}},"line":13},"11":{"name":"(anonymous_11)","decl":{"start":{"line":13,"column":30},"end":{"line":13,"column":31}},"loc":{"start":{"line":13,"column":43},"end":{"line":13,"column":67}},"line":13},"12":{"name":"step","decl":{"start":{"line":14,"column":13},"end":{"line":14,"column":17}},"loc":{"start":{"line":14,"column":22},"end":{"line":35,"column":5}},"line":14},"13":{"name":"(anonymous_13)","decl":{"start":{"line":37,"column":15},"end":{"line":37,"column":16}},"loc":{"start":{"line":37,"column":40},"end":{"line":49,"column":1}},"line":37},"14":{"name":"(anonymous_14)","decl":{"start":{"line":38,"column":43},"end":{"line":38,"column":44}},"loc":{"start":{"line":38,"column":55},"end":{"line":48,"column":5}},"line":38},"15":{"name":"(anonymous_15)","decl":{"start":{"line":39,"column":33},"end":{"line":39,"column":34}},"loc":{"start":{"line":39,"column":47},"end":{"line":47,"column":9}},"line":39},"16":{"name":"(anonymous_16)","decl":{"start":{"line":41,"column":26},"end":{"line":41,"column":27}},"loc":{"start":{"line":41,"column":38},"end":{"line":46,"column":17}},"line":41}},"branchMap":{"0":{"loc":{"start":{"line":1,"column":16},"end":{"line":9,"column":1}},"type":"binary-expr","locations":[{"start":{"line":1,"column":17},"end":{"line":1,"column":21}},{"start":{"line":1,"column":25},"end":{"line":1,"column":39}},{"start":{"line":1,"column":44},"end":{"line":9,"column":1}}],"line":1},"1":{"loc":{"start":{"line":2,"column":35},"end":{"line":2,"column":109}},"type":"cond-expr","locations":[{"start":{"line":2,"column":56},"end":{"line":2,"column":61}},{"start":{"line":2,"column":64},"end":{"line":2,"column":109}}],"line":2},"2":{"loc":{"start":{"line":3,"column":16},"end":{"line":3,"column":34}},"type":"binary-expr","locations":[{"start":{"line":3,"column":16},"end":{"line":3,"column":17}},{"start":{"line":3,"column":22},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":6,"column":32},"end":{"line":6,"column":115}},"type":"cond-expr","locations":[{"start":{"line":6,"column":46},"end":{"line":6,"column":67}},{"start":{"line":6,"column":70},"end":{"line":6,"column":115}}],"line":6},"4":{"loc":{"start":{"line":7,"column":51},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":51},"end":{"line":7,"column":61}},{"start":{"line":7,"column":65},"end":{"line":7,"column":67}}],"line":7},"5":{"loc":{"start":{"line":10,"column":18},"end":{"line":36,"column":1}},"type":"binary-expr","locations":[{"start":{"line":10,"column":19},"end":{"line":10,"column":23}},{"start":{"line":10,"column":27},"end":{"line":10,"column":43}},{"start":{"line":10,"column":48},"end":{"line":36,"column":1}}],"line":10},"6":{"loc":{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},"type":"if","locations":[{"start":{"line":11,"column":43},"end":{"line":11,"column":68}},{"start":{"line":11,"column":43},"end":{"line":11,"column":68}}],"line":11},"7":{"loc":{"start":{"line":12,"column":71},"end":{"line":12,"column":153}},"type":"binary-expr","locations":[{"start":{"line":12,"column":71},"end":{"line":12,"column":99}},{"start":{"line":12,"column":104},"end":{"line":12,"column":152}}],"line":12},"8":{"loc":{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},"type":"if","locations":[{"start":{"line":15,"column":8},"end":{"line":15,"column":70}},{"start":{"line":15,"column":8},"end":{"line":15,"column":70}}],"line":15},"9":{"loc":{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":17,"column":169}},{"start":{"line":17,"column":12},"end":{"line":17,"column":169}}],"line":17},"10":{"loc":{"start":{"line":17,"column":23},"end":{"line":17,"column":158}},"type":"binary-expr","locations":[{"start":{"line":17,"column":23},"end":{"line":17,"column":24}},{"start":{"line":17,"column":29},"end":{"line":17,"column":125}},{"start":{"line":17,"column":130},"end":{"line":17,"column":158}}],"line":17},"11":{"loc":{"start":{"line":17,"column":33},"end":{"line":17,"column":125}},"type":"cond-expr","locations":[{"start":{"line":17,"column":45},"end":{"line":17,"column":56}},{"start":{"line":17,"column":59},"end":{"line":17,"column":125}}],"line":17},"12":{"loc":{"start":{"line":17,"column":59},"end":{"line":17,"column":125}},"type":"cond-expr","locations":[{"start":{"line":17,"column":67},"end":{"line":17,"column":116}},{"start":{"line":17,"column":119},"end":{"line":17,"column":125}}],"line":17},"13":{"loc":{"start":{"line":17,"column":67},"end":{"line":17,"column":116}},"type":"binary-expr","locations":[{"start":{"line":17,"column":67},"end":{"line":17,"column":77}},{"start":{"line":17,"column":82},"end":{"line":17,"column":115}}],"line":17},"14":{"loc":{"start":{"line":17,"column":82},"end":{"line":17,"column":112}},"type":"binary-expr","locations":[{"start":{"line":17,"column":83},"end":{"line":17,"column":98}},{"start":{"line":17,"column":103},"end":{"line":17,"column":112}}],"line":17},"15":{"loc":{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":18,"column":52}},{"start":{"line":18,"column":12},"end":{"line":18,"column":52}}],"line":18},"16":{"loc":{"start":{"line":19,"column":12},"end":{"line":31,"column":13}},"type":"switch","locations":[{"start":{"line":20,"column":16},"end":{"line":20,"column":23}},{"start":{"line":20,"column":24},"end":{"line":20,"column":46}},{"start":{"line":21,"column":16},"end":{"line":21,"column":72}},{"start":{"line":22,"column":16},"end":{"line":22,"column":65}},{"start":{"line":23,"column":16},"end":{"line":23,"column":65}},{"start":{"line":24,"column":16},"end":{"line":30,"column":43}}],"line":19},"17":{"loc":{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},"type":"if","locations":[{"start":{"line":25,"column":20},"end":{"line":25,"column":128}},{"start":{"line":25,"column":20},"end":{"line":25,"column":128}}],"line":25},"18":{"loc":{"start":{"line":25,"column":24},"end":{"line":25,"column":106}},"type":"binary-expr","locations":[{"start":{"line":25,"column":24},"end":{"line":25,"column":74}},{"start":{"line":25,"column":79},"end":{"line":25,"column":90}},{"start":{"line":25,"column":94},"end":{"line":25,"column":105}}],"line":25},"19":{"loc":{"start":{"line":25,"column":42},"end":{"line":25,"column":73}},"type":"binary-expr","locations":[{"start":{"line":25,"column":42},"end":{"line":25,"column":54}},{"start":{"line":25,"column":58},"end":{"line":25,"column":73}}],"line":25},"20":{"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},"type":"if","locations":[{"start":{"line":26,"column":20},"end":{"line":26,"column":106}},{"start":{"line":26,"column":20},"end":{"line":26,"column":106}}],"line":26},"21":{"loc":{"start":{"line":26,"column":24},"end":{"line":26,"column":77}},"type":"binary-expr","locations":[{"start":{"line":26,"column":24},"end":{"line":26,"column":35}},{"start":{"line":26,"column":40},"end":{"line":26,"column":42}},{"start":{"line":26,"column":47},"end":{"line":26,"column":59}},{"start":{"line":26,"column":63},"end":{"line":26,"column":75}}],"line":26},"22":{"loc":{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},"type":"if","locations":[{"start":{"line":27,"column":20},"end":{"line":27,"column":89}},{"start":{"line":27,"column":20},"end":{"line":27,"column":89}}],"line":27},"23":{"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":53}},"type":"binary-expr","locations":[{"start":{"line":27,"column":24},"end":{"line":27,"column":35}},{"start":{"line":27,"column":39},"end":{"line":27,"column":53}}],"line":27},"24":{"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},"type":"if","locations":[{"start":{"line":28,"column":20},"end":{"line":28,"column":87}},{"start":{"line":28,"column":20},"end":{"line":28,"column":87}}],"line":28},"25":{"loc":{"start":{"line":28,"column":24},"end":{"line":28,"column":43}},"type":"binary-expr","locations":[{"start":{"line":28,"column":24},"end":{"line":28,"column":25}},{"start":{"line":28,"column":29},"end":{"line":28,"column":43}}],"line":28},"26":{"loc":{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},"type":"if","locations":[{"start":{"line":29,"column":20},"end":{"line":29,"column":42}},{"start":{"line":29,"column":20},"end":{"line":29,"column":42}}],"line":29},"27":{"loc":{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":34,"column":35}},{"start":{"line":34,"column":8},"end":{"line":34,"column":35}}],"line":34},"28":{"loc":{"start":{"line":34,"column":52},"end":{"line":34,"column":74}},"type":"cond-expr","locations":[{"start":{"line":34,"column":60},"end":{"line":34,"column":65}},{"start":{"line":34,"column":68},"end":{"line":34,"column":74}}],"line":34}},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":1,"12":1,"13":1,"14":0,"15":0,"16":0,"17":1,"18":0,"19":3,"20":1,"21":1,"22":0,"23":1,"24":2,"25":2,"26":0,"27":2,"28":0,"29":2,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":1,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":2,"63":1,"64":0,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1},"f":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0,"6":1,"7":1,"8":0,"9":0,"10":3,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1},"b":{"0":[1,1,1],"1":[0,0],"2":[1,1],"3":[1,0],"4":[1,1],"5":[1,1,1],"6":[0,0],"7":[1,1],"8":[0,1],"9":[0,2],"10":[2,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,2],"16":[1,1,0,0,0,1],"17":[1,0],"18":[1,1,1],"19":[1,0],"20":[0,0],"21":[0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,1],"28":[1,0]},"inputSourceMap":{"version":3,"file":"/app/app/db/seed/_cities.ts","sources":["/app/app/db/seed/_cities.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,CAAC,IAAI,GAAG,UAAe,IAAI,EAAE,OAAO;;;YACzC,sBAAO,IAAI,CAAC,SAAS,CAAC;qBACjB,IAAI,CAAC;oBACJ,uBAAuB;oBACvB,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC;wBAC5B,EAAC,OAAO,EAAE,CAAC,EAAE,QAAQ,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,EAAE,SAAS,EAAE,KAAK,EAAC;qBAChE,CAAC,CAAA;gBACJ,CAAC,CAAC,EAAA;;;CACP,CAAA","sourcesContent":["exports.seed = async function(knex, Promise) {\n  return knex('_cities')\n      .then(function() {\n        // Inserts seed entries\n        return knex('_cities').insert([\n          {city_id: 1, title_ru: '', country_id: 2, important: false},\n        ])\n      })\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"35826d9339455bb6d9b9a2cee52adcddc328354a","contentHash":"e096b3bfa85dc5d5d08266a81fa07842d1dac978282067e725b8999075f1fcc6"},"/app/app/db/seed/_countries.ts":{"path":"/app/app/db/seed/_countries.ts","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":18,"column":2}},"1":{"start":{"line":2,"column":4},"end":{"line":17,"column":7}},"2":{"start":{"line":5,"column":8},"end":{"line":16,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":15},"end":{"line":1,"column":16}},"loc":{"start":{"line":1,"column":40},"end":{"line":18,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":3,"column":14},"end":{"line":3,"column":15}},"loc":{"start":{"line":3,"column":26},"end":{"line":17,"column":5}},"line":3}},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{"0":1,"1":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/seed/_countries.ts","sources":["/app/app/db/seed/_countries.ts"],"names":[],"mappings":"AAAA,OAAO,CAAC,IAAI,GAAG,UAAS,IAAI,EAAE,OAAO;IACnC,OAAO,IAAI,CAAC,YAAY,CAAC;SACpB,IAAI,CAAC;QACJ,uBAAuB;QACvB,OAAO,IAAI,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC;YAC/B;gBACE,UAAU,EAAE,CAAC;gBACb,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAE,OAAO;aAClB;YACD;gBACE,UAAU,EAAE,CAAC;gBACb,QAAQ,EAAE,SAAS;gBACnB,QAAQ,EAAE,SAAS;aACpB;SACF,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACT,CAAC,CAAC","sourcesContent":["exports.seed = function(knex, Promise) {\n  return knex('_countries')\n      .then(function() {\n        // Inserts seed entries\n        return knex('_countries').insert([\n          {\n            country_id: 1,\n            title_ru: '',\n            title_ua: '',\n          },\n          {\n            country_id: 2,\n            title_ru: '',\n            title_ua: '',\n          },\n        ]);\n      });\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a6519a36a6993310364753d48b13e9096d8f2510","contentHash":"8a7e81954ea8be2b037a1fabbacc2d17cd45c58b861ed3264ebdccee4c4f13e5"},"/app/app/db/seed/user.ts":{"path":"/app/app/db/seed/user.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":12},"end":{"line":3,"column":39}},"2":{"start":{"line":4,"column":0},"end":{"line":22,"column":2}},"3":{"start":{"line":5,"column":4},"end":{"line":21,"column":7}},"4":{"start":{"line":7,"column":8},"end":{"line":12,"column":11}},"5":{"start":{"line":15,"column":8},"end":{"line":20,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":16}},"loc":{"start":{"line":4,"column":40},"end":{"line":22,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":14},"end":{"line":6,"column":15}},"loc":{"start":{"line":6,"column":26},"end":{"line":13,"column":5}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":14},"end":{"line":14,"column":15}},"loc":{"start":{"line":14,"column":26},"end":{"line":21,"column":5}},"line":14}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1},"f":{"0":1,"1":1,"2":1},"b":{},"inputSourceMap":{"version":3,"file":"/app/app/db/seed/user.ts","sources":["/app/app/db/seed/user.ts"],"names":[],"mappings":";;AAAA,wCAAyC;AACzC,OAAO,CAAC,IAAI,GAAG,UAAC,IAAI,EAAE,OAAO;IAC3B,OAAO,IAAI,CAAC,OAAO,CAAC;SACf,IAAI,CAAC;QACJ,OAAO,KAAK,CAAC,YAAY,CAAC;YACxB,IAAI,EAAE,WAAW;YACjB,KAAK,EAAE,aAAa;YACpB,QAAQ,EAAE,gBAAgB;YAC1B,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;IACL,CAAC,CAAC;SACD,IAAI,CAAC;QACJ,OAAO,KAAK,CAAC,YAAY,CAAC;YACxB,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,gBAAgB;YACvB,QAAQ,EAAE,eAAe;YACzB,QAAQ,EAAE,IAAI;SACf,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACT,CAAC,CAAC","sourcesContent":["import * as users from '../queries/users'\nexports.seed = (knex, Promise) => {\n  return knex('users')\n      .then(() => {\n        return users.addLocalUser({\n          name: 'username0',\n          email: 'user-email0',\n          password: 'user-password0',\n          verified: true\n        });\n      })\n      .then(() => {\n        return users.addLocalUser({\n          name: 'username',\n          email: 'user@email.com',\n          password: 'user-password',\n          verified: true\n        });\n      });\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"65ff87004ef95a388537f6aa40f8701fee7cdccb","contentHash":"b184d1d0344f5ff0798fa568e950fed84debb9a4d2a702603217edc678e52e5b"}}